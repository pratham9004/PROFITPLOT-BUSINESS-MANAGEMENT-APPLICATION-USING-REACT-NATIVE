var wacBoot;!function(){var t,e,n={992:function(t){t.exports=function(){"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(t,n){return e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},e(t,n)}function n(t,i,o){return n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}()?Reflect.construct:function(t,n,i){var o=[null];o.push.apply(o,n);var s=new(Function.bind.apply(t,o));return i&&e(s,i.prototype),s},n.apply(null,arguments)}function i(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var s=Object.hasOwnProperty,r=Object.setPrototypeOf,a=Object.isFrozen,c=Object.getPrototypeOf,l=Object.getOwnPropertyDescriptor,u=Object.freeze,d=Object.seal,h=Object.create,f="undefined"!=typeof Reflect&&Reflect,m=f.apply,p=f.construct;m||(m=function(t,e,n){return t.apply(e,n)}),u||(u=function(t){return t}),d||(d=function(t){return t}),p||(p=function(t,e){return n(t,i(e))});var g,b=P(Array.prototype.forEach),w=P(Array.prototype.pop),v=P(Array.prototype.push),S=P(String.prototype.toLowerCase),C=P(String.prototype.toString),y=P(String.prototype.match),_=P(String.prototype.replace),k=P(String.prototype.indexOf),x=P(String.prototype.trim),R=P(RegExp.prototype.test),A=(g=TypeError,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return p(g,e)});function P(t){return function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return m(t,e,i)}}function I(t,e,n){var i;n=null!==(i=n)&&void 0!==i?i:S,r&&r(t,null);for(var o=e.length;o--;){var s=e[o];if("string"==typeof s){var c=n(s);c!==s&&(a(e)||(e[o]=c),s=c)}t[s]=!0}return t}function E(t){var e,n=h(null);for(e in t)!0===m(s,t,[e])&&(n[e]=t[e]);return n}function W(t,e){for(;null!==t;){var n=l(t,e);if(n){if(n.get)return P(n.get);if("function"==typeof n.value)return P(n.value)}t=c(t)}return function(t){return console.warn("fallback value for",t),null}}var L=u(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),O=u(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),D=u(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),T=u(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),F=u(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),M=u(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),N=u(["#text"]),B=u(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),$=u(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),V=u(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),U=u(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),H=d(/\{\{[\w\W]*|[\w\W]*\}\}/gm),j=d(/<%[\w\W]*|[\w\W]*%>/gm),z=d(/\${[\w\W]*}/gm),G=d(/^data-[\-\w.\u00B7-\uFFFF]/),q=d(/^aria-[\-\w]+$/),J=d(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),K=d(/^(?:\w+script|data):/i),X=d(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Q=d(/^html$/i),Y=d(/^[a-z][.\w]*(-[.\w]+)+$/i);return function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,o=function(t){return e(t)};if(o.version="2.5.7",o.removed=[],!n||!n.document||9!==n.document.nodeType)return o.isSupported=!1,o;var s=n.document,r=n.document,a=n.DocumentFragment,c=n.HTMLTemplateElement,l=n.Node,d=n.Element,h=n.NodeFilter,f=n.NamedNodeMap,m=void 0===f?n.NamedNodeMap||n.MozNamedAttrMap:f,p=n.HTMLFormElement,g=n.DOMParser,P=n.trustedTypes,Z=d.prototype,tt=W(Z,"cloneNode"),et=W(Z,"nextSibling"),nt=W(Z,"childNodes"),it=W(Z,"parentNode");if("function"==typeof c){var ot=r.createElement("template");ot.content&&ot.content.ownerDocument&&(r=ot.content.ownerDocument)}var st=function(e,n){if("object"!==t(e)||"function"!=typeof e.createPolicy)return null;var i=null,o="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(o)&&(i=n.currentScript.getAttribute(o));var s="dompurify"+(i?"#"+i:"");try{return e.createPolicy(s,{createHTML:function(t){return t},createScriptURL:function(t){return t}})}catch(t){return console.warn("TrustedTypes policy "+s+" could not be created."),null}}(P,s),rt=st?st.createHTML(""):"",at=r,ct=at.implementation,lt=at.createNodeIterator,ut=at.createDocumentFragment,dt=at.getElementsByTagName,ht=s.importNode,ft={};try{ft=E(r).documentMode?r.documentMode:{}}catch(t){}var mt={};o.isSupported="function"==typeof it&&ct&&void 0!==ct.createHTMLDocument&&9!==ft;var pt,gt,bt=H,wt=j,vt=z,St=G,Ct=q,yt=K,_t=X,kt=Y,xt=J,Rt=null,At=I({},[].concat(i(L),i(O),i(D),i(F),i(N))),Pt=null,It=I({},[].concat(i(B),i($),i(V),i(U))),Et=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Wt=null,Lt=null,Ot=!0,Dt=!0,Tt=!1,Ft=!0,Mt=!1,Nt=!0,Bt=!1,$t=!1,Vt=!1,Ut=!1,Ht=!1,jt=!1,zt=!0,Gt=!1,qt=!0,Jt=!1,Kt={},Xt=null,Qt=I({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Yt=null,Zt=I({},["audio","video","img","source","image","track"]),te=null,ee=I({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ne="http://www.w3.org/1998/Math/MathML",ie="http://www.w3.org/2000/svg",oe="http://www.w3.org/1999/xhtml",se=oe,re=!1,ae=null,ce=I({},[ne,ie,oe],C),le=["application/xhtml+xml","text/html"],ue=null,de=r.createElement("form"),he=function(t){return t instanceof RegExp||t instanceof Function},fe=function(e){ue&&ue===e||(e&&"object"===t(e)||(e={}),e=E(e),pt=pt=-1===le.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,gt="application/xhtml+xml"===pt?C:S,Rt="ALLOWED_TAGS"in e?I({},e.ALLOWED_TAGS,gt):At,Pt="ALLOWED_ATTR"in e?I({},e.ALLOWED_ATTR,gt):It,ae="ALLOWED_NAMESPACES"in e?I({},e.ALLOWED_NAMESPACES,C):ce,te="ADD_URI_SAFE_ATTR"in e?I(E(ee),e.ADD_URI_SAFE_ATTR,gt):ee,Yt="ADD_DATA_URI_TAGS"in e?I(E(Zt),e.ADD_DATA_URI_TAGS,gt):Zt,Xt="FORBID_CONTENTS"in e?I({},e.FORBID_CONTENTS,gt):Qt,Wt="FORBID_TAGS"in e?I({},e.FORBID_TAGS,gt):{},Lt="FORBID_ATTR"in e?I({},e.FORBID_ATTR,gt):{},Kt="USE_PROFILES"in e&&e.USE_PROFILES,Ot=!1!==e.ALLOW_ARIA_ATTR,Dt=!1!==e.ALLOW_DATA_ATTR,Tt=e.ALLOW_UNKNOWN_PROTOCOLS||!1,Ft=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,Mt=e.SAFE_FOR_TEMPLATES||!1,Nt=!1!==e.SAFE_FOR_XML,Bt=e.WHOLE_DOCUMENT||!1,Ut=e.RETURN_DOM||!1,Ht=e.RETURN_DOM_FRAGMENT||!1,jt=e.RETURN_TRUSTED_TYPE||!1,Vt=e.FORCE_BODY||!1,zt=!1!==e.SANITIZE_DOM,Gt=e.SANITIZE_NAMED_PROPS||!1,qt=!1!==e.KEEP_CONTENT,Jt=e.IN_PLACE||!1,xt=e.ALLOWED_URI_REGEXP||xt,se=e.NAMESPACE||oe,Et=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&he(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(Et.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&he(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(Et.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(Et.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Mt&&(Dt=!1),Ht&&(Ut=!0),Kt&&(Rt=I({},i(N)),Pt=[],!0===Kt.html&&(I(Rt,L),I(Pt,B)),!0===Kt.svg&&(I(Rt,O),I(Pt,$),I(Pt,U)),!0===Kt.svgFilters&&(I(Rt,D),I(Pt,$),I(Pt,U)),!0===Kt.mathMl&&(I(Rt,F),I(Pt,V),I(Pt,U))),e.ADD_TAGS&&(Rt===At&&(Rt=E(Rt)),I(Rt,e.ADD_TAGS,gt)),e.ADD_ATTR&&(Pt===It&&(Pt=E(Pt)),I(Pt,e.ADD_ATTR,gt)),e.ADD_URI_SAFE_ATTR&&I(te,e.ADD_URI_SAFE_ATTR,gt),e.FORBID_CONTENTS&&(Xt===Qt&&(Xt=E(Xt)),I(Xt,e.FORBID_CONTENTS,gt)),qt&&(Rt["#text"]=!0),Bt&&I(Rt,["html","head","body"]),Rt.table&&(I(Rt,["tbody"]),delete Wt.tbody),u&&u(e),ue=e)},me=I({},["mi","mo","mn","ms","mtext"]),pe=I({},["annotation-xml"]),ge=I({},["title","style","font","a","script"]),be=I({},O);I(be,D),I(be,T);var we=I({},F);I(we,M);var ve=function(t){v(o.removed,{element:t});try{t.parentNode.removeChild(t)}catch(e){try{t.outerHTML=rt}catch(e){t.remove()}}},Se=function(t,e){try{v(o.removed,{attribute:e.getAttributeNode(t),from:e})}catch(t){v(o.removed,{attribute:null,from:e})}if(e.removeAttribute(t),"is"===t&&!Pt[t])if(Ut||Ht)try{ve(e)}catch(t){}else try{e.setAttribute(t,"")}catch(t){}},Ce=function(t){var e,n;if(Vt)t="<remove></remove>"+t;else{var i=y(t,/^[\r\n\t ]+/);n=i&&i[0]}"application/xhtml+xml"===pt&&se===oe&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");var o=st?st.createHTML(t):t;if(se===oe)try{e=(new g).parseFromString(o,pt)}catch(t){}if(!e||!e.documentElement){e=ct.createDocument(se,"template",null);try{e.documentElement.innerHTML=re?rt:o}catch(t){}}var s=e.body||e.documentElement;return t&&n&&s.insertBefore(r.createTextNode(n),s.childNodes[0]||null),se===oe?dt.call(e,Bt?"html":"body")[0]:Bt?e.documentElement:s},ye=function(t){return lt.call(t.ownerDocument||t,t,h.SHOW_ELEMENT|h.SHOW_COMMENT|h.SHOW_TEXT|h.SHOW_PROCESSING_INSTRUCTION|h.SHOW_CDATA_SECTION,null,!1)},_e=function(t){return t instanceof p&&("string"!=typeof t.nodeName||"string"!=typeof t.textContent||"function"!=typeof t.removeChild||!(t.attributes instanceof m)||"function"!=typeof t.removeAttribute||"function"!=typeof t.setAttribute||"string"!=typeof t.namespaceURI||"function"!=typeof t.insertBefore||"function"!=typeof t.hasChildNodes)},ke=function(e){return"object"===t(l)?e instanceof l:e&&"object"===t(e)&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},xe=function(t,e,n){mt[t]&&b(mt[t],(function(t){t.call(o,e,n,ue)}))},Re=function(t){var e;if(xe("beforeSanitizeElements",t,null),_e(t))return ve(t),!0;if(R(/[\u0080-\uFFFF]/,t.nodeName))return ve(t),!0;var n=gt(t.nodeName);if(xe("uponSanitizeElement",t,{tagName:n,allowedTags:Rt}),t.hasChildNodes()&&!ke(t.firstElementChild)&&(!ke(t.content)||!ke(t.content.firstElementChild))&&R(/<[/\w]/g,t.innerHTML)&&R(/<[/\w]/g,t.textContent))return ve(t),!0;if("select"===n&&R(/<template/i,t.innerHTML))return ve(t),!0;if(7===t.nodeType)return ve(t),!0;if(Nt&&8===t.nodeType&&R(/<[/\w]/g,t.data))return ve(t),!0;if(!Rt[n]||Wt[n]){if(!Wt[n]&&Pe(n)){if(Et.tagNameCheck instanceof RegExp&&R(Et.tagNameCheck,n))return!1;if(Et.tagNameCheck instanceof Function&&Et.tagNameCheck(n))return!1}if(qt&&!Xt[n]){var i=it(t)||t.parentNode,s=nt(t)||t.childNodes;if(s&&i)for(var r=s.length-1;r>=0;--r){var a=tt(s[r],!0);a.__removalCount=(t.__removalCount||0)+1,i.insertBefore(a,et(t))}}return ve(t),!0}return t instanceof d&&!function(t){var e=it(t);e&&e.tagName||(e={namespaceURI:se,tagName:"template"});var n=S(t.tagName),i=S(e.tagName);return!!ae[t.namespaceURI]&&(t.namespaceURI===ie?e.namespaceURI===oe?"svg"===n:e.namespaceURI===ne?"svg"===n&&("annotation-xml"===i||me[i]):Boolean(be[n]):t.namespaceURI===ne?e.namespaceURI===oe?"math"===n:e.namespaceURI===ie?"math"===n&&pe[i]:Boolean(we[n]):t.namespaceURI===oe?!(e.namespaceURI===ie&&!pe[i])&&!(e.namespaceURI===ne&&!me[i])&&!we[n]&&(ge[n]||!be[n]):!("application/xhtml+xml"!==pt||!ae[t.namespaceURI]))}(t)?(ve(t),!0):"noscript"!==n&&"noembed"!==n&&"noframes"!==n||!R(/<\/no(script|embed|frames)/i,t.innerHTML)?(Mt&&3===t.nodeType&&(e=t.textContent,e=_(e,bt," "),e=_(e,wt," "),e=_(e,vt," "),t.textContent!==e&&(v(o.removed,{element:t.cloneNode()}),t.textContent=e)),xe("afterSanitizeElements",t,null),!1):(ve(t),!0)},Ae=function(t,e,n){if(zt&&("id"===e||"name"===e)&&(n in r||n in de))return!1;if(Dt&&!Lt[e]&&R(St,e));else if(Ot&&R(Ct,e));else if(!Pt[e]||Lt[e]){if(!(Pe(t)&&(Et.tagNameCheck instanceof RegExp&&R(Et.tagNameCheck,t)||Et.tagNameCheck instanceof Function&&Et.tagNameCheck(t))&&(Et.attributeNameCheck instanceof RegExp&&R(Et.attributeNameCheck,e)||Et.attributeNameCheck instanceof Function&&Et.attributeNameCheck(e))||"is"===e&&Et.allowCustomizedBuiltInElements&&(Et.tagNameCheck instanceof RegExp&&R(Et.tagNameCheck,n)||Et.tagNameCheck instanceof Function&&Et.tagNameCheck(n))))return!1}else if(te[e]);else if(R(xt,_(n,_t,"")));else if("src"!==e&&"xlink:href"!==e&&"href"!==e||"script"===t||0!==k(n,"data:")||!Yt[t])if(Tt&&!R(yt,_(n,_t,"")));else if(n)return!1;return!0},Pe=function(t){return"annotation-xml"!==t&&y(t,kt)},Ie=function(e){var n,i,s,r;xe("beforeSanitizeAttributes",e,null);var a=e.attributes;if(a){var c={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Pt};for(r=a.length;r--;){var l=n=a[r],u=l.name,d=l.namespaceURI;if(i="value"===u?n.value:x(n.value),s=gt(u),c.attrName=s,c.attrValue=i,c.keepAttr=!0,c.forceKeepAttr=void 0,xe("uponSanitizeAttribute",e,c),i=c.attrValue,!c.forceKeepAttr&&(Se(u,e),c.keepAttr))if(Ft||!R(/\/>/i,i)){Mt&&(i=_(i,bt," "),i=_(i,wt," "),i=_(i,vt," "));var h=gt(e.nodeName);if(Ae(h,s,i))if(!Gt||"id"!==s&&"name"!==s||(Se(u,e),i="user-content-"+i),Nt&&R(/((--!?|])>)|<\/(style|title)/i,i))Se(u,e);else{if(st&&"object"===t(P)&&"function"==typeof P.getAttributeType)if(d);else switch(P.getAttributeType(h,s)){case"TrustedHTML":i=st.createHTML(i);break;case"TrustedScriptURL":i=st.createScriptURL(i)}try{d?e.setAttributeNS(d,u,i):e.setAttribute(u,i),_e(e)?ve(e):w(o.removed)}catch(t){}}}else Se(u,e)}xe("afterSanitizeAttributes",e,null)}},Ee=function t(e){var n,i=ye(e);for(xe("beforeSanitizeShadowDOM",e,null);n=i.nextNode();)xe("uponSanitizeShadowNode",n,null),Re(n)||(n.content instanceof a&&t(n.content),Ie(n));xe("afterSanitizeShadowDOM",e,null)};return o.sanitize=function(e){var i,r,c,u,d,h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if((re=!e)&&(e="\x3c!--\x3e"),"string"!=typeof e&&!ke(e)){if("function"!=typeof e.toString)throw A("toString is not a function");if("string"!=typeof(e=e.toString()))throw A("dirty is not a string, aborting")}if(!o.isSupported){if("object"===t(n.toStaticHTML)||"function"==typeof n.toStaticHTML){if("string"==typeof e)return n.toStaticHTML(e);if(ke(e))return n.toStaticHTML(e.outerHTML)}return e}if($t||fe(h),o.removed=[],"string"==typeof e&&(Jt=!1),Jt){if(e.nodeName){var f=gt(e.nodeName);if(!Rt[f]||Wt[f])throw A("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof l)1===(r=(i=Ce("\x3c!----\x3e")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===r.nodeName||"HTML"===r.nodeName?i=r:i.appendChild(r);else{if(!Ut&&!Mt&&!Bt&&-1===e.indexOf("<"))return st&&jt?st.createHTML(e):e;if(!(i=Ce(e)))return Ut?null:jt?rt:""}i&&Vt&&ve(i.firstChild);for(var m=ye(Jt?e:i);c=m.nextNode();)3===c.nodeType&&c===u||Re(c)||(c.content instanceof a&&Ee(c.content),Ie(c),u=c);if(u=null,Jt)return e;if(Ut){if(Ht)for(d=ut.call(i.ownerDocument);i.firstChild;)d.appendChild(i.firstChild);else d=i;return(Pt.shadowroot||Pt.shadowrootmod)&&(d=ht.call(s,d,!0)),d}var p=Bt?i.outerHTML:i.innerHTML;return Bt&&Rt["!doctype"]&&i.ownerDocument&&i.ownerDocument.doctype&&i.ownerDocument.doctype.name&&R(Q,i.ownerDocument.doctype.name)&&(p="<!DOCTYPE "+i.ownerDocument.doctype.name+">\n"+p),Mt&&(p=_(p,bt," "),p=_(p,wt," "),p=_(p,vt," ")),st&&jt?st.createHTML(p):p},o.setConfig=function(t){fe(t),$t=!0},o.clearConfig=function(){ue=null,$t=!1},o.isValidAttribute=function(t,e,n){ue||fe({});var i=gt(t),o=gt(e);return Ae(i,o,n)},o.addHook=function(t,e){"function"==typeof e&&(mt[t]=mt[t]||[],v(mt[t],e))},o.removeHook=function(t){if(mt[t])return w(mt[t])},o.removeHooks=function(t){mt[t]&&(mt[t]=[])},o.removeAllHooks=function(){mt={}},o}()}()},997:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},952:function(t,e){"use strict";let n;Object.defineProperty(e,"__esModule",{value:!0}),e.isChangeGatesManagerSet=e.isChangeGateEnabled=e.setChangeGatesManager=void 0,e.setChangeGatesManager=t=>{n=t},e.isChangeGateEnabled=t=>!n||n.isChangeGateEnabled(t),e.isChangeGatesManagerSet=()=>!!n},400:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=n(533);i.__exportStar(n(952),e),i.__exportStar(n(997),e)},799:function(t,e,n){"use strict";var i;n.d(e,{n:function(){return i}}),function(t){t[t.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",t[t.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",t[t.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",t[t.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",t[t.msoulscat_MSOSP_AddInCommands=220]="msoulscat_MSOSP_AddInCommands",t[t.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",t[t.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",t[t.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",t[t.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",t[t.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",t[t.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",t[t.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",t[t.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",t[t.msoulscat_Wac_WacFeedback=356]="msoulscat_Wac_WacFeedback",t[t.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",t[t.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",t[t.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",t[t.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",t[t.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",t[t.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",t[t.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",t[t.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",t[t.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",t[t.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",t[t.msoulscat_Wac_PptGc2General=835]="msoulscat_Wac_PptGc2General",t[t.msoulscat_Wac_PptGc2GraphicHost=836]="msoulscat_Wac_PptGc2GraphicHost",t[t.msoulscat_Wac_PptGc2Operation=837]="msoulscat_Wac_PptGc2Operation",t[t.msoulscat_Wac_PptGc2EditCanvas=852]="msoulscat_Wac_PptGc2EditCanvas",t[t.msoulscat_Wac_PptDataSync=844]="msoulscat_Wac_PptDataSync",t[t.msoulscat_Wac_PptFluidRuntime=848]="msoulscat_Wac_PptFluidRuntime",t[t.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",t[t.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",t[t.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",t[t.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",t[t.msoulscat_Wac_PptVideos=846]="msoulscat_Wac_PptVideos",t[t.msoulscat_Uci_Insights=1303]="msoulscat_Uci_Insights",t[t.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",t[t.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",t[t.msoulscat_Wac_OAuth=3e3]="msoulscat_Wac_OAuth",t[t.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",t[t.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",t[t.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",t[t.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",t[t.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",t[t.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",t[t.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools",t[t.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency",t[t.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification",t[t.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime",t[t.msoulscat_Wac_AiMaker=3041]="msoulscat_Wac_AiMaker",t[t.msoulscat_Wac_AiRewrite=3043]="msoulscat_Wac_AiRewrite",t[t.msoulscat_Wac_AiInsert=3044]="msoulscat_Wac_AiInsert",t[t.msoulscat_Wac_AiSummarize=3047]="msoulscat_Wac_AiSummarize",t[t.msoulscat_Wac_CopilotCompose=3048]="msoulscat_Wac_CopilotCompose",t[t.msoulscat_Wac_Skittles=3049]="msoulscat_Wac_Skittles",t[t.msoulscat_Wac_CopilotChat=3050]="msoulscat_Wac_CopilotChat",t[t.msoulscat_Wac_Syntex=3051]="msoulscat_Wac_Syntex",t[t.msoulscat_Wac_WireGraph=3052]="msoulscat_Wac_WireGraph",t[t.msoulscat_Wac_CshCopilot=3053]="msoulscat_Wac_CshCopilot",t[t.msoulscat_Wac_CopilotProactiveSummary=3055]="msoulscat_Wac_CopilotProactiveSummary",t[t.msoulscat_Wac_CopilotProactiveShared=3056]="msoulscat_Wac_CopilotProactiveShared",t[t.msoulscat_Wac_CopilotCursor=3057]="msoulscat_Wac_CopilotCursor",t[t.msoulscat_Wac_WasmGeneral=3059]="msoulscat_Wac_WasmGeneral",t[t.msoulscat_Wac_WasmTextLayout=3060]="msoulscat_Wac_WasmTextLayout",t[t.msoulscat_Wac_WasmSmartArt=3061]="msoulscat_Wac_WasmSmartArt",t[t.msoulscat_Wac_WasmClient=3062]="msoulscat_Wac_WasmClient",t[t.msoulscat_Wac_WasmNative=3063]="msoulscat_Wac_WasmNative",t[t.msoulscat_AIHub_CreateModuleTelemetry=4e3]="msoulscat_AIHub_CreateModuleTelemetry",t[t.msoulscat_AIHub_CreateModuleAugloop=4001]="msoulscat_AIHub_CreateModuleAugloop",t[t.msoulscat_AIHub_CreateModuleDAS=4002]="msoulscat_AIHub_CreateModuleDAS",t[t.msoulscat_AIHub_CreateModuleConfig=4003]="msoulscat_AIHub_CreateModuleConfig",t[t.msoulscat_AIHub_CreateModuleContext=4004]="msoulscat_AIHub_CreateModuleContext",t[t.msoulscat_AIHub_CreateModuleGraph=4005]="msoulscat_AIHub_CreateModuleGraph",t[t.msoulscat_AIHub_CreateModuleExperiences=4006]="msoulscat_AIHub_CreateModuleExperiences",t[t.msoulscat_AIHub_CreateModuleHttp=4007]="msoulscat_AIHub_CreateModuleHttp",t[t.msoulscat_AIHub_CreateModuleRouting=4008]="msoulscat_AIHub_CreateModuleRouting",t[t.msoulscat_AIHub_CreateModuleStorage=4009]="msoulscat_AIHub_CreateModuleStorage",t[t.msoulscat_AIHub_CreateModuleStore=4010]="msoulscat_AIHub_CreateModuleStore",t[t.msoulscat_AIHub_CreateModuleUI=4011]="msoulscat_AIHub_CreateModuleUI",t[t.msoulscat_AIHub_CreateModuleSharePoint=4012]="msoulscat_AIHub_CreateModuleSharePoint",t[t.msoulscat_AIHub_CreateModuleUI_Artifacts=4100]="msoulscat_AIHub_CreateModuleUI_Artifacts",t[t.msoulscat_AIHub_CreateModuleUI_BrandKit=4101]="msoulscat_AIHub_CreateModuleUI_BrandKit",t[t.msoulscat_AIHub_CreateModuleUI_Forms=4102]="msoulscat_AIHub_CreateModuleUI_Forms",t[t.msoulscat_AIHub_CreateModuleUI_Homepage=4103]="msoulscat_AIHub_CreateModuleUI_Homepage",t[t.msoulscat_AIHub_CreateModuleUI_Text=4104]="msoulscat_AIHub_CreateModuleUI_Text",t[t.msoulscat_AIHub_CreateModuleUI_Video=4105]="msoulscat_AIHub_CreateModuleUI_Video"}(i||(i={}))},828:function(t,e,n){"use strict";var i;n.d(e,{k:function(){return i}}),function(t){t[t.Error=10]="Error",t[t.Warning=15]="Warning",t[t.Important=20]="Important",t[t.Info=50]="Info",t[t.Verbose=100]="Verbose",t[t.Spam=200]="Spam"}(i||(i={}))},14:function(t,e,n){"use strict";n.d(e,{Hv:function(){return o}});class i{sendTraceTag(){}shipAssertTag(){}debugAssertTag(){}setCorrelationId(){}}const o=new class{setCorrelationId(t){this.externalLogger.setCorrelationId(t)}setLogger(t){this.externalLogger=t}sendTraceTag(t,e,n,i){this.externalLogger.sendTraceTag(t,e,n,i)}debugAssertTag(t,e,n,i){this.externalLogger.debugAssertTag(t,e,n,i)}shipAssertTag(t,e,n,i){this.externalLogger.shipAssertTag(t,e,n,i)}constructor(){this.externalLogger=new i}}},166:function(t,e,n){"use strict";n.r(e),n.d(e,{RegionComposer:function(){return s},initializeWindowUtil:function(){return c},registerAfterRegionsRendered:function(){return u},shouldUseRegionComposer:function(){return a},unregisterAfterRegionsRendered:function(){return d}});class i{dispose(){this.positionCounts={Top:0,Left:0,Right:0,Bottom:0},this.regionElements={},this.containerElement&&this.dockPanel&&this.containerElement.removeChild(this.dockPanel),this.dockPanel=void 0,this.containerElement=void 0}addRegion(t){if(!this.dockPanel)return;const e=this.styleSheet.insertRule(`.${t.id}{display:block;}`,this.styleSheet.cssRules.length);let n,i=this.regionElements[t.id];this.containerElement&&(i=i||this.containerElement.querySelector(`.${t.id}`),i?n=i:(n=document.createElement("div"),n.classList.add(t.id)));let o=this.getGridArea(t.position,!1);return this.updateTemplate(t.position),void 0!==this.lastChildIndex&&this.lastChildOriginalGridArea&&(this.styleSheet.cssRules[this.lastChildIndex].style.gridArea=this.lastChildOriginalGridArea),this.lastChildOriginalGridArea=o,o=this.getGridArea(t.position,!0),this.styleSheet.cssRules[e].style.gridArea=o,n&&!i&&(this.appendRegion(t.position,n),this.regionElements[t.id]=n),this.lastChildIndex=e,this.positionCounts[t.position]=this.positionCounts[t.position]+1,n}updateTemplate(t){if(this.dockPanel)switch(t){case"Top":{const t=`repeat(${this.positionCounts.Top+1}, min-content) 1fr repeat(${Math.max(1,this.positionCounts.Bottom)}, min-content)`;return void(this.regionComposerRootStyle?this.regionComposerRootStyle.style.gridTemplateRows=t:this.styleSheet.insertRule(`.${this.regionComposerRootClassName}{grid-template-rows: ${t}`,this.styleSheet.cssRules.length))}case"Left":{const t=`repeat(${this.positionCounts.Left+1}, min-content) 1fr repeat(${Math.max(1,this.positionCounts.Right)}, min-content)`;return void(this.regionComposerRootStyle?this.regionComposerRootStyle.style.gridTemplateColumns=t:this.styleSheet.insertRule(`.${this.regionComposerRootClassName}{grid-template-columns: ${t}`,this.styleSheet.cssRules.length))}case"Right":{const t=`repeat(${Math.max(1,this.positionCounts.Left)}, min-content) 1fr repeat(${this.positionCounts.Right+1}, min-content)`;return void(this.regionComposerRootStyle?this.regionComposerRootStyle.style.gridTemplateColumns=t:this.styleSheet.insertRule(`.${this.regionComposerRootClassName}{grid-template-columns: ${t}`,this.styleSheet.cssRules.length))}case"Bottom":{const t=`repeat(${Math.max(1,this.positionCounts.Top)}, min-content) 1fr repeat(${this.positionCounts.Bottom+1}, min-content)`;return void(this.regionComposerRootStyle?this.regionComposerRootStyle.style.gridTemplateRows=t:this.styleSheet.insertRule(`.${this.regionComposerRootClassName}{grid-template-rows: ${t}`,this.styleSheet.cssRules.length))}}}addPositioningElements(t){Object.keys(this.positioningElements).forEach((e=>{const n=document.createElement("div");n.style.setProperty("display","none"),n.id=e,this.positioningElements[e]=n,t.appendChild(n)}))}getPositioningElements(t){Object.keys(this.positioningElements).forEach((e=>{const n=t.querySelector(`#${e}`);n&&(this.positioningElements[e]=n)}))}appendRegion(t,e){const n=this.positioningElements[t];if(!n)return;const i=n.parentNode;i&&!i.contains(e)&&(i.insertBefore(e,n.nextSibling),"Top"!==t&&"Left"!==t||(this.positioningElements[t]=e))}getGridArea(t,e){if(!this.dockPanel)return"";switch(t){case"Top":return` ${this.positionCounts.Top+1} / ${this.positionCounts.Left+1} / ${e?-1*(this.positionCounts.Bottom+1):this.positionCounts.Top+2} / ${-1*(this.positionCounts.Right+1)}`;case"Left":return` ${this.positionCounts.Top+1} / ${this.positionCounts.Left+1} / ${-1*(this.positionCounts.Bottom+1)} / ${e?-1*(this.positionCounts.Right+1):this.positionCounts.Left+2}`;case"Right":return`${this.positionCounts.Top+1} / ${-1*(this.positionCounts.Right+1)} / ${-1*(this.positionCounts.Bottom+1)} / ${e?this.positionCounts.Left+1:-1*(this.positionCounts.Right+2)}`;case"Bottom":return` ${-1*(this.positionCounts.Bottom+1)} / ${this.positionCounts.Left+1} / ${e?this.positionCounts.Top+1:-1*(this.positionCounts.Bottom+2)} / ${-1*(this.positionCounts.Right+1)}`}}get dockPanelRootElement(){return this.dockPanel}constructor(t){this.regionComposerRootClassName="regionComposerRoot",this.regionElements={},this.positioningElements={Top:void 0,Left:void 0,Right:void 0,Bottom:void 0},this.positionCounts={Top:0,Left:0,Right:0,Bottom:0};const{container:e,styleSheet:n}=t;this.containerElement=e,this.styleSheet=n,void 0===this.styleSheet.ownerRule&&0===this.styleSheet.cssRules.length&&this.styleSheet.parentStyleSheet&&!this.styleSheet.parentStyleSheet.parentStyleSheet&&1===this.styleSheet.parentStyleSheet.cssRules.length?((this.styleSheet.parentStyleSheet||this.styleSheet).insertRule(`.${this.regionComposerRootClassName}{display: grid; position: absolute; width: 100%; height: 100%; z-index: 1;}`,0),this.containerElement&&(this.dockPanel=document.createElement("div"),this.dockPanel.classList.add(this.regionComposerRootClassName),this.addPositioningElements(this.dockPanel),this.containerElement.appendChild(this.dockPanel))):this.containerElement&&(this.dockPanel=this.containerElement,this.getPositioningElements(this.dockPanel)),this.styleSheet.insertRule(`.${this.regionComposerRootClassName}{}`,0),this.regionComposerRootStyle=this.styleSheet.cssRules[0]}}var o=n(3);class s{render(t){t&&(this.keyboardSegment?(void 0!==this.setOffsetRafId&&cancelAnimationFrame(this.setOffsetRafId),this.setOffsetRafId=requestAnimationFrame((()=>{this.setOffsetForActiveAccountForKeyboardRegions(),h()}))):(void 0!==this.setOffsetRafId&&(cancelAnimationFrame(this.setOffsetRafId),this.setOffsetRafId=void 0),h()))}dispose(){Object.keys(this.layoutRegions).forEach((t=>{Object.keys(this.layoutRegions[t]).forEach((e=>{const n=this.layoutRegions[t][e];n&&n.dispose()}))})),Object.keys(this.regionContainers).forEach((t=>{const e=this.regionContainers[t];e&&document.removeChild(e),this.regionContainers[t]=void 0})),(0,o.unregisterBoundingWindowRectsChanged)("regionComposer"),(0,o.unregisterLayoutBreakpointChanged)("regionComposer"),this.regionContainers={}}getRegion(t){return this.regionContainers[t]}createRegions(){const{layoutCollection:t}=this.props;Object.keys(t).forEach((e=>{const n=t[e];n&&this.createRegion(n,e)}));let e="";if(Object.keys(this.regionContainers).forEach((t=>{e+=`.${t}, `})),e.length&&(e=e.substr(0,e.length-2),e+="{display: none; position: relative;}",this.styleSheet.insertRule(e,0)),this.styleElement){const t=this.styleSheet.cssRules;this.unsupportedRules=this.unsupportedRules.reverse();for(let n=0;n<t.length;n+=1){t[n].cssRules&&t[n].insertRule(e,0);let i=`${this.styleElement.innerHTML}${t[n].cssText}`;const o="";if(i.indexOf("@media not all")>=0&&this.unsupportedRules.length>0){i=i.replace("@media not all",this.unsupportedRules.pop());let t=i;t=i.replace(new RegExp("and (spanning: single-fold-.*)","g"),"{.multipleWindowRects"),t+="}"}this.styleElement.innerHTML=i,this.styleElement.innerHTML=`${this.styleElement.innerHTML}${o}`}this.styleSheet=this.styleElement.sheet}}createRegionContainer(t){if(this.regionContainers[t.id])return this.regionContainers[t.id];const e=document.createElement("div");return e.setAttribute("style",`width: ${"Header"===t.id?"100vw":"100%"}; height: 100%; display: flex; flex: auto;`),this.regionContainers[t.id]=e,e}createRegion(t,e){Object.keys(t).forEach((n=>{const o=t[n];this.addSelectorForLayoutDefinition(this.styleSheet,e,n);const s=this.rootDockPanel||(this.props.dockPanelProps?this.props.dockPanelProps.container:void 0),r=new i(Object.assign(this.props.dockPanelProps,{container:s,styleSheet:this.getLastChild(this.styleSheet)}));o.forEach((t=>{const i=this.createRegionContainer(t),o=r.addRegion(t);o&&i&&!o.contains(i)&&o.appendChild(i),t.accountForKeyboard&&o&&(this.accountForKeyboardRegions[e][n]||(this.accountForKeyboardRegions[e][n]=[]),this.accountForKeyboardRegions[e][n].push(o))})),!this.rootDockPanel&&r.dockPanelRootElement&&(this.rootDockPanel=r.dockPanelRootElement),this.layoutRegions[e][n]=r}))}getLastChild(t){let e=t.cssRules[t.cssRules.length-1];for(;e.cssRules&&e.cssRules.length>0;)e=e.cssRules[e.cssRules.length-1];return e.cssRules?e:e.parentStyleSheet}getAffectedAccountForKeyboardRegions(t,e="Landscape",n="Default"){if(!this.accountForKeyboardRegions)return;const i=this.accountForKeyboardRegions[e][n]||this.accountForKeyboardRegions[e].Default||void 0;return t&&i?i.filter((e=>(0,o.isRectWithin)(e.getBoundingClientRect(),t))):i}createStyleSheet(){return this.styleElement=document.createElement("style"),document.head.appendChild(this.styleElement),this.styleElement.sheet}addSelectorForLayoutDefinition(t,e,n){const i="Small"===n?"max-width":"Large"===n?"min-width":void 0;let s,r;if("Portrait"===e||"Landscape"===e)s=`@media only screen and (orientation: ${e.toLowerCase()}) ${i&&"Default"!==n?`and (${i}: ${o.LayoutBreakpointSizes[n][e]}px ){`:"{"}}`;else{let t,a;"DP"===e?(t="landscape",a="single-fold-vertical"):(t="portrait",a="single-fold-horizontal"),r=`@media only screen and (orientation: ${t}) and (spanning: ${a})`,this.unsupportedRules.push(r),s=`${r} ${i&&"Default"!==n?`and (${i}: ${o.LayoutBreakpointSizes[n][e]}px ){`:"{"}}`}t.insertRule(s,t.cssRules.length)}constructor(t){this.layoutRegions={Portrait:{Default:void 0,Small:void 0,Large:void 0},Landscape:{Default:void 0,Small:void 0,Large:void 0},DP:{Default:void 0,Small:void 0,Large:void 0},DL:{Default:void 0,Small:void 0,Large:void 0}},this.accountForKeyboardRegions={Portrait:{Default:void 0,Small:void 0,Large:void 0},Landscape:{Default:void 0,Small:void 0,Large:void 0},DP:{Default:void 0,Small:void 0,Large:void 0},DL:{Default:void 0,Small:void 0,Large:void 0}},this.regionContainers={},this.unsupportedRules=[],this.setOffsetForActiveAccountForKeyboardRegions=t=>{const e=t?void 0:this.getWindowRectForKeyboardSegment(),n="Undefined"===this.windowMode?"Landscape":this.windowMode,i=this.getAffectedAccountForKeyboardRegions(e,n,this.layoutBreakpoint);if(!i)return;const o=e?e.top+e.height:0;i.forEach((e=>{if(t)e.style.marginBottom="0px";else{const t=e.getBoundingClientRect(),n=Math.max(0,this.keyboardSegment.height-(o-t.bottom));e.style.marginBottom=`${n}px`}}))},this.boundingWindowRectsChanged=(t,e)=>{const n=t.find((t=>!!t.isOccluded)),i=this.windowMode!==e||this.keyboardSegment!==n;this.setOffsetForActiveAccountForKeyboardRegions(!0),this.windowMode=e,this.keyboardSegment=n,this.render(i)},this.layoutBreakpointChanged=t=>{this.layoutBreakpoint=t,this.render(!0)},this.getWindowRectForKeyboardSegment=()=>{if(this.keyboardSegment)return(0,o.getBoundingRect)(this.keyboardSegment)},this.props=t,this.windowMode=(0,o.getWindowMode)(),this.layoutBreakpoint=(0,o.getLayoutBreakpoint)(),this.keyboardSegment=(0,o.getKeyboardSegment)(),this.styleSheet=this.createStyleSheet(),this.createRegions(),(0,o.registerBoundingWindowRectsChanged)("regionComposer",this.boundingWindowRectsChanged),(0,o.registerLayoutBreakpointChanged)("regionComposer",this.layoutBreakpointChanged),this.render()}}let r=!1;function a(){return r}function c(t){var e;r=t&&!("undefined"!=typeof navigator&&(e=navigator.userAgent,/rv:11.0/i.test(e)||/Edge\//i.test(e)||/Safari/i.test(e)&&!/Chrome/i.test(e)&&!/Version\/[1-9][1-9]\.[0-9].*Safari/i.test(navigator.userAgent))),(0,o.initializeBaseWindowUtil)()}const l={};function u(t,e){l[t]=e}function d(t){void 0!==l[t]&&delete l[t]}function h(){for(const t in l)l[t]()}},949:function(t,e,n){"use strict";n.d(e,{_:function(){return i}});const i={Small:{Portrait:720,Landscape:960,DP:1440,DL:1920},Large:{Portrait:721,Landscape:961,DP:1441,DL:1921}}},3:function(t,e,n){"use strict";n.r(e),n.d(e,{LayoutBreakpointSizes:function(){return U._},WindowSegment:function(){return o},ensureWindowsAPIs:function(){return s},getBoundingRect:function(){return _},getBoundingWindow:function(){return v},getBoundingWindowWithPadding:function(){return S},getBoundingWindowWithPaddingFabric:function(){return C},getKeyboardSegment:function(){return M},getLayoutBreakpoint:function(){return F},getRectSpanningOffset:function(){return A},getWindowMode:function(){return T},getWindowRectForKeyboardSegment:function(){return V},getWindowRectsWithoutKeyboard:function(){return N},initializeBaseWindowUtil:function(){return B},isDLMode:function(){return w},isDPMode:function(){return b},isElementSpanning:function(){return x},isRectSpanning:function(){return R},isRectWithin:function(){return k},isReducedAnimations:function(){return g},onWindowRectsChange:function(){return D},registerBoundingWindowRectsChanged:function(){return E},registerLayoutBreakpointChanged:function(){return L},registerSpanningChanged:function(){return P},unregisterBoundingWindowRectsChanged:function(){return W},unregisterLayoutBreakpointChanged:function(){return O},unregisterSpanningChanged:function(){return I}});const i=window.__foldables_env_vars__;class o{toJSON(){return JSON.stringify(this)}constructor(t,e,n,i,o=!1){this.left=t,this.right=t+n,this.top=e,this.bottom=e+i,this.x=t,this.y=e,this.width=n,this.height=i,this.pixelDepth=0,this.devicePixelRatio=0,this.isOccluded=o}}function s(){"object"!=typeof window.onBoundingWindowRectsChange&&(window.onBoundingWindowRectsChange=new CustomEvent("onBoundingWindowRectsChange",{bubbles:!1,cancelable:!1}),window.addEventListener("resize",r)),function(){if("function"==typeof window.getWindowSegments)return;window.getWindowSegments=()=>{const t=window.innerWidth,e=window.innerHeight;try{if(window.external&&window.external.getHostEnvironmentValue&&'{"os-sku":"189"}'===window.external.getHostEnvironmentValue("os-sku")){if(window.matchMedia&&window.matchMedia("(orientation: portrait)").matches&&e>=1300&&964===t)return i&&i.update({spanning:"single-fold-horizontal"}),[new o(0,0,t,e/2),new o(0,e/2,t,e/2)];if(window.matchMedia&&window.matchMedia("(orientation: landscape)").matches&&e>=820&&1440===t)return i&&i.update({spanning:"single-fold-vertical"}),[new o(0,0,t/2,e),new o(t/2,0,t/2,e)];i&&i.update({spanning:"none"})}}catch(t){}return[new o(0,0,t,e)]}}()}function r(){window.dispatchEvent(window.onBoundingWindowRectsChange)}const a={},c={},l={};let u,d=[],h=-1,f="Undefined",m="Default",p=!1;function g(){return window?.matchMedia?.("(prefers-reduced-motion: reduce)").matches}function b(){return"DP"===T()}function w(){return"DL"===T()}function v(t){return S(t,0)}function S(t,e){if(!t||!d||d.length<=0)return;if(1===d.length)return y(d[0],e);let n;if("string"==typeof t){const e=document.querySelector(t);if(!e)return;n=e.getBoundingClientRect()}else if(void 0!==t.preventDefault){const e=t;n=new o(e.clientX,e.clientY,1,1)}else if(t.getBoundingClientRect)n=t.getBoundingClientRect();else if(t.current)n=t.current.getBoundingClientRect();else{if(!t)return;{const e=t;n=new o(e.x,e.y,1,1)}}const i=_(n);return i&&y(i,e)}function C(t,e){return S(t,8)}function y(t,e){return t&&Object.assign({},t,{top:t.top+e,left:t.left+e,right:t.right-e,bottom:t.bottom-e,width:t.width-2*e,height:t.height-2*e})}function _(t){return R(t)?d[0]:d.find((e=>k(t,e)))}function k(t,e){return t.left>=e.left&&t.top>=e.top&&t.right<=e.left+e.width&&t.bottom<=e.top+e.height}function x(t){return void 0!==t&&("DL"===T()||"DP"===T())&&R(t.getBoundingClientRect())}function R(t){return!(d.length<=1)&&(t.right>d[0].left+d[0].width?t.left<d[1].left:t.bottom>d[0].top+d[0].height&&t.top<d[1].top)}function A(t,e){if(d.length<=1)return-1;if(e){if(t.left<d[1].left)return t.right-d[0].right;if(t.top<d[1].top)return t.bottom-d[0].bottom}else{if(t.right>d[0].left+d[0].width)return d[1].left-t.left;if(t.bottom>d[0].top+d[0].height)return d[1].top-t.top}return-1}function P(t,e){a[t]=e}function I(t){void 0!==a[t]&&delete a[t]}function E(t,e){c[t]=e}function W(t){void 0!==c[t]&&delete c[t]}function L(t,e){l[t]=e}function O(t){void 0!==l[t]&&delete l[t]}function D(){window.getWindowSegments||s();const t=window.getWindowSegments();let e=!1;if(t.length!==d.length&&(e=!0),d=t,1===d.length){const t=d[0];f=t.width>t.height?"Landscape":"Portrait"}else d.length<=1||d[0].top!==d[1].top?d.length<=1||d[0].left!==d[1].left||(e=e||"DP"===f,f="DL"):(e=e||"DL"===f,f="DP");const n=m;"Landscape"===f||"DL"===f?m=d[0].width<=960?"Small":"Large":"Portrait"!==f&&"DP"!==f||(m=d[0].width<=720?"Small":"Large"),function(){const t=d;u&&t.push(u);for(const e in c)c[e](t,f)}(),e&&function(t){for(const e in a)a[e](t,f)}("DL"===f||"DP"===f),n!==m&&function(){for(const t in l)l[t](m)}()}function T(){if("Undefined"===f){const t=window.getWindowSegments?window.getWindowSegments():void 0;return!t||t.length<=1?window.innerWidth>window.innerHeight?"Landscape":"Portrait":window.innerWidth>window.innerHeight?"DP":"DL"}return f}function F(){return m}function M(){return u}function N(){return d}function B(){p||("undefined"!=typeof navigator&&navigator.virtualKeyboard&&void 0!==navigator.virtualKeyboard.overlaysContent&&(window===top&&(navigator.virtualKeyboard.overlaysContent=!0),navigator.virtualKeyboard.addEventListener("overlaygeometrychange",$)),s(),window.addEventListener("onBoundingWindowRectsChange",D),d&&0!==d.length||D(),p=!0)}function $(t){const{width:e,height:n,left:i}=t.boundingRect;0===e||0===n?(u=void 0,h=-1):(u=t.boundingRect,u.isOccluded=!0,h=i>0||"DL"===T()?1:0),D()}function V(){if(u)return d[h]}B();var U=n(949)},533:function(t,e,n){"use strict";n.r(e),n.d(e,{__addDisposableResource:function(){return D},__assign:function(){return s},__asyncDelegator:function(){return x},__asyncGenerator:function(){return k},__asyncValues:function(){return R},__await:function(){return _},__awaiter:function(){return m},__classPrivateFieldGet:function(){return W},__classPrivateFieldIn:function(){return O},__classPrivateFieldSet:function(){return L},__createBinding:function(){return g},__decorate:function(){return a},__disposeResources:function(){return F},__esDecorate:function(){return l},__exportStar:function(){return b},__extends:function(){return o},__generator:function(){return p},__importDefault:function(){return E},__importStar:function(){return I},__makeTemplateObject:function(){return A},__metadata:function(){return f},__param:function(){return c},__propKey:function(){return d},__read:function(){return v},__rest:function(){return r},__runInitializers:function(){return u},__setFunctionName:function(){return h},__spread:function(){return S},__spreadArray:function(){return y},__spreadArrays:function(){return C},__values:function(){return w},default:function(){return M}});var i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},i(t,e)};function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var s=function(){return s=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},s.apply(this,arguments)};function r(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(t);o<i.length;o++)e.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(t,i[o])&&(n[i[o]]=t[i[o]])}return n}function a(t,e,n,i){var o,s=arguments.length,r=s<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(r=(s<3?o(r):s>3?o(e,n,r):o(e,n))||r);return s>3&&r&&Object.defineProperty(e,n,r),r}function c(t,e){return function(n,i){e(n,i,t)}}function l(t,e,n,i,o,s){function r(t){if(void 0!==t&&"function"!=typeof t)throw new TypeError("Function expected");return t}for(var a,c=i.kind,l="getter"===c?"get":"setter"===c?"set":"value",u=!e&&t?i.static?t:t.prototype:null,d=e||(u?Object.getOwnPropertyDescriptor(u,i.name):{}),h=!1,f=n.length-1;f>=0;f--){var m={};for(var p in i)m[p]="access"===p?{}:i[p];for(var p in i.access)m.access[p]=i.access[p];m.addInitializer=function(t){if(h)throw new TypeError("Cannot add initializers after decoration has completed");s.push(r(t||null))};var g=(0,n[f])("accessor"===c?{get:d.get,set:d.set}:d[l],m);if("accessor"===c){if(void 0===g)continue;if(null===g||"object"!=typeof g)throw new TypeError("Object expected");(a=r(g.get))&&(d.get=a),(a=r(g.set))&&(d.set=a),(a=r(g.init))&&o.unshift(a)}else(a=r(g))&&("field"===c?o.unshift(a):d[l]=a)}u&&Object.defineProperty(u,i.name,d),h=!0}function u(t,e,n){for(var i=arguments.length>2,o=0;o<e.length;o++)n=i?e[o].call(t,n):e[o].call(t);return i?n:void 0}function d(t){return"symbol"==typeof t?t:"".concat(t)}function h(t,e,n){return"symbol"==typeof e&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(t,"name",{configurable:!0,value:n?"".concat(n," ",e):e})}function f(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function m(t,e,n,i){return new(n||(n=Promise))((function(o,s){function r(t){try{c(i.next(t))}catch(t){s(t)}}function a(t){try{c(i.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(r,a)}c((i=i.apply(t,e||[])).next())}))}function p(t,e){var n,i,o,s,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,a[0]&&(r=0)),r;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return r.label++,{value:a[1],done:!1};case 5:r.label++,i=a[1],a=[0];continue;case 7:a=r.ops.pop(),r.trys.pop();continue;default:if(!((o=(o=r.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){r=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){r.label=a[1];break}if(6===a[0]&&r.label<o[1]){r.label=o[1],o=a;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(a);break}o[2]&&r.ops.pop(),r.trys.pop();continue}a=e.call(t,r)}catch(t){a=[6,t],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}var g=Object.create?function(t,e,n,i){void 0===i&&(i=n);var o=Object.getOwnPropertyDescriptor(e,n);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,i,o)}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]};function b(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||g(e,t,n)}function w(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,o,s=n.call(t),r=[];try{for(;(void 0===e||e-- >0)&&!(i=s.next()).done;)r.push(i.value)}catch(t){o={error:t}}finally{try{i&&!i.done&&(n=s.return)&&n.call(s)}finally{if(o)throw o.error}}return r}function S(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(v(arguments[e]));return t}function C(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),o=0;for(e=0;e<n;e++)for(var s=arguments[e],r=0,a=s.length;r<a;r++,o++)i[o]=s[r];return i}function y(t,e,n){if(n||2===arguments.length)for(var i,o=0,s=e.length;o<s;o++)!i&&o in e||(i||(i=Array.prototype.slice.call(e,0,o)),i[o]=e[o]);return t.concat(i||Array.prototype.slice.call(e))}function _(t){return this instanceof _?(this.v=t,this):new _(t)}function k(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,o=n.apply(t,e||[]),s=[];return i={},r("next"),r("throw"),r("return"),i[Symbol.asyncIterator]=function(){return this},i;function r(t){o[t]&&(i[t]=function(e){return new Promise((function(n,i){s.push([t,e,n,i])>1||a(t,e)}))})}function a(t,e){try{(n=o[t](e)).value instanceof _?Promise.resolve(n.value.v).then(c,l):u(s[0][2],n)}catch(t){u(s[0][3],t)}var n}function c(t){a("next",t)}function l(t){a("throw",t)}function u(t,e){t(e),s.shift(),s.length&&a(s[0][0],s[0][1])}}function x(t){var e,n;return e={},i("next"),i("throw",(function(t){throw t})),i("return"),e[Symbol.iterator]=function(){return this},e;function i(i,o){e[i]=t[i]?function(e){return(n=!n)?{value:_(t[i](e)),done:!1}:o?o(e):e}:o}}function R(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=w(t),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(n){e[n]=t[n]&&function(e){return new Promise((function(i,o){!function(t,e,n,i){Promise.resolve(i).then((function(e){t({value:e,done:n})}),e)}(i,o,(e=t[n](e)).done,e.value)}))}}}function A(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}var P=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e};function I(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&g(e,t,n);return P(e,t),e}function E(t){return t&&t.__esModule?t:{default:t}}function W(t,e,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(t):i?i.value:e.get(t)}function L(t,e,n,i,o){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!o:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?o.call(t,n):o?o.value=n:e.set(t,n),n}function O(t,e){if(null===e||"object"!=typeof e&&"function"!=typeof e)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof t?e===t:t.has(e)}function D(t,e,n){if(null!=e){if("object"!=typeof e&&"function"!=typeof e)throw new TypeError("Object expected.");var i;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=e[Symbol.asyncDispose]}if(void 0===i){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=e[Symbol.dispose]}if("function"!=typeof i)throw new TypeError("Object not disposable.");t.stack.push({value:e,dispose:i,async:n})}else n&&t.stack.push({async:!0});return e}var T="function"==typeof SuppressedError?SuppressedError:function(t,e,n){var i=new Error(n);return i.name="SuppressedError",i.error=t,i.suppressed=e,i};function F(t){function e(e){t.error=t.hasError?new T(e,t.error,"An error was suppressed during disposal."):e,t.hasError=!0}return function n(){for(;t.stack.length;){var i=t.stack.pop();try{var o=i.dispose&&i.dispose.call(i.value);if(i.async)return Promise.resolve(o).then(n,(function(t){return e(t),n()}))}catch(t){e(t)}}if(t.hasError)throw t.error}()}const M={__extends:o,__assign:s,__rest:r,__decorate:a,__param:c,__metadata:f,__awaiter:m,__generator:p,__createBinding:g,__exportStar:b,__values:w,__read:v,__spread:S,__spreadArrays:C,__spreadArray:y,__await:_,__asyncGenerator:k,__asyncDelegator:x,__asyncValues:R,__makeTemplateObject:A,__importStar:I,__importDefault:E,__classPrivateFieldGet:W,__classPrivateFieldSet:L,__classPrivateFieldIn:O,__addDisposableResource:D,__disposeResources:F}}},i={};function o(t){var e=i[t];if(void 0!==e)return e.exports;var s=i[t]={exports:{}};return n[t].call(s.exports,s,s.exports,o),s.exports}o.m=n,o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,{a:e}),e},o.d=function(t,e){for(var n in e)o.o(e,n)&&!o.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},o.f={},o.e=function(t){return Promise.all(Object.keys(o.f).reduce((function(e,n){return o.f[n](t,e),e}),[]))},o.u=function(t){return"pasLogger.min.js"},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},t={},e="wacBoot:",o.l=function(n,i,s,r){if(t[n])t[n].push(i);else{var a,c;if(void 0!==s)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=l[u];if(d.getAttribute("src")==n||d.getAttribute("data-webpack")==e+s){a=d;break}}a||(c=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,o.nc&&a.setAttribute("nonce",o.nc),a.setAttribute("data-webpack",e+s),a.src=n,0!==a.src.indexOf(window.location.origin+"/")&&(a.crossOrigin="anonymous")),t[n]=[i];var h=function(e,i){a.onerror=a.onload=null,clearTimeout(f);var o=t[n];if(delete t[n],a.parentNode&&a.parentNode.removeChild(a),o&&o.forEach((function(t){return t(i)})),e)return e(i)},f=setTimeout(h.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=h.bind(null,a.onerror),a.onload=h.bind(null,a.onload),c&&document.head.appendChild(a)}},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.p="",function(){var t={506:0};o.f.j=function(e,n){var i=o.o(t,e)?t[e]:void 0;if(0!==i)if(i)n.push(i[2]);else{var s=new Promise((function(n,o){i=t[e]=[n,o]}));n.push(i[2]=s);var r=o.p+o.u(e),a=new Error;o.l(r,(function(n){if(o.o(t,e)&&(0!==(i=t[e])&&(t[e]=void 0),i)){var s=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;a.message="Loading chunk "+e+" failed.\n("+s+": "+r+")",a.name="ChunkLoadError",a.type=s,a.request=r,i[1](a)}}),"chunk-"+e,e)}};var e=function(e,n){var i,s,[r,a,c]=n,l=0;if(r.some((function(e){return 0!==t[e]}))){for(i in a)o.o(a,i)&&(o.m[i]=a[i]);c&&c(o)}for(e&&e(n);l<r.length;l++)s=r[l],o.o(t,s)&&t[s]&&t[s][0](),t[s]=0},n=globalThis.wacBootChunks=globalThis.wacBootChunks||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))}();var s={};!function(){"use strict";o.r(s),o.d(s,{CanvasCacheLoader:function(){return at},CanvasCacheRemover:function(){return ct},CtrlWheelMetrics:function(){return l},DocumentCacheInfo:function(){return Z},DocumentCacheItem:function(){return st},DocumentCacheManager:function(){return rt},DocumentCacheResult:function(){return it},DocumentCacheToastManager:function(){return vt},FastView:function(){return et},FastViewLogEntry:function(){return tt},FastViewSettings:function(){return d},FastViewUtils:function(){return _},LocalStorageDocumentCache:function(){return St},LocalStorageDocumentCacheTest:function(){return Ct},ShiftUtils:function(){return B},SkeletalBoot:function(){return N},WacSkeletalBoot:function(){return y},WindowUtil:function(){return t},WindowVisibilityMetrics:function(){return nt},WordEditorInstantApp:function(){return Xe},WordEditorInstantAppResult:function(){return Ke},bootSettings:function(){return u},cssClass:function(){return R},cssClassAbsolute:function(){return x},cssPositionRewriteClass:function(){return A},dispose:function(){return c},getFastViewCssClasses:function(){return P},getRegion:function(){return a},isTouchSupport:function(){return k},launchFastViewForSkeletalUX:function(){return qe},makeStyleChangesToHideHeader:function(){return L},removeCanvasSkeletalUX:function(){return E},removeSplashScreen:function(){return I},sendWacBeacon:function(){return S},setFastViewScrollTop:function(){return W},show:function(){return Qe},startWacBoot:function(){return Je}});var t=o(3);class e{render(t){t&&(this.keyboardSegment?(void 0!==this.setOffsetRafId&&cancelAnimationFrame(this.setOffsetRafId),this.setOffsetRafId=requestAnimationFrame((()=>{this.setOffsetForActiveAccountForKeyboardRegions(),i()}))):(void 0!==this.setOffsetRafId&&(cancelAnimationFrame(this.setOffsetRafId),this.setOffsetRafId=void 0),i()))}dispose(){Object.keys(this.regionContainers).forEach((t=>{const e=this.regionContainers[t];e&&document.removeChild(e),this.regionContainers[t]=void 0})),(0,t.unregisterBoundingWindowRectsChanged)("regionComposer"),(0,t.unregisterLayoutBreakpointChanged)("regionComposer"),this.regionContainers={}}getRegion(t){if(this.regionComposerRoot)return this.regionContainers[t]||(this.regionContainers[t]=this.regionComposerRoot.querySelector(`[id=${t}Region]`)),this.regionContainers[t]}getRegionComposer(){return document.getElementById(this.regionComposerRootId)}registerAccountForKeyboardRegionElements(){const{layoutCollection:t}=this.props;Object.keys(t).forEach((e=>{const n=t[e];n&&this.registerAccountForKeyboardRegionElementsForRegionLayoutAndWindowMode(n,e)}))}registerAccountForKeyboardRegionElementsForRegionLayoutAndWindowMode(t,e){Object.keys(t).forEach((n=>{t[n]?.forEach((t=>{const i=this.getRegion(t.id);i&&this.accountForKeyboardRegionElements[e][n].push(i)}))}))}getAffectedAccountForKeyboardRegions(e,n="Landscape",i="Default"){const o=this.accountForKeyboardRegionElements[n][i]||this.accountForKeyboardRegionElements[n].Default||void 0;return e&&o&&0!==o.length?o.filter((n=>(0,t.isRectWithin)(n.getBoundingClientRect(),e))):o}constructor(e){this.accountForKeyboardRegionElements={Portrait:{Default:[],Small:[],Large:[]},Landscape:{Default:[],Small:[],Large:[]},DP:{Default:[],Small:[],Large:[]},DL:{Default:[],Small:[],Large:[]}},this.regionComposerRootId="regionComposerRoot",this.regionContainers={},this.setOffsetForActiveAccountForKeyboardRegions=t=>{const e=t?void 0:this.getWindowRectForKeyboardSegment(),n="Undefined"===this.windowMode?"Landscape":this.windowMode,i=this.getAffectedAccountForKeyboardRegions(e,n,this.layoutBreakpoint);if(!i||0===i.length)return;const o=e?e.top+e.height:0;i.forEach((e=>{if(t)e.style.marginBottom="0px";else{const t=e.getBoundingClientRect(),n=Math.max(0,this.keyboardSegment.height-(o-t.bottom));e.style.marginBottom=`${n}px`}}))},this.boundingWindowRectsChanged=(t,e)=>{let n;for(let e=t.length-1;e>=0;e-=1)if(t[e].isOccluded){n=t[e];break}const i=this.windowMode!==e||this.keyboardSegment!==n;this.setOffsetForActiveAccountForKeyboardRegions(!0),this.windowMode=e,this.keyboardSegment=n,this.render(i)},this.layoutBreakpointChanged=t=>{this.layoutBreakpoint=t,this.render(!0)},this.getWindowRectForKeyboardSegment=()=>{if(this.keyboardSegment)return(0,t.getBoundingRect)(this.keyboardSegment)},this.props=e,this.windowMode=(0,t.getWindowMode)(),this.layoutBreakpoint=(0,t.getLayoutBreakpoint)(),this.keyboardSegment=(0,t.getKeyboardSegment)(),this.regionComposerRoot=this.getRegionComposer(),this.regionComposerRoot&&(e.container&&e.container.appendChild(this.regionComposerRoot),this.registerAccountForKeyboardRegionElements(),(0,t.registerBoundingWindowRectsChanged)("regionComposer",this.boundingWindowRectsChanged),(0,t.registerLayoutBreakpointChanged)("regionComposer",this.layoutBreakpointChanged),this.render())}}const n={};function i(){for(const t in n)n[t]()}let r;function a(t){return r?r.getRegion(t):void 0}function c(){r&&(r.dispose(),r=void 0)}class l{static initialize(){l.ctrlWheelOccurred=!1,document.addEventListener("wheel",l.handleWheel)}static stop(){document.removeEventListener("wheel",l.handleWheel)}static handleWheel(t){t.ctrlKey&&(l.ctrlWheelOccurred=!0)}}l.initialize();const u={g_initialRequestMade:!1,g_initialRequestCompleted:!1,g_getCellsFromFrameRequest:void 0,g_getCellsUuid:void 0,g_initialRequestResponseObject:void 0,g_acquireLockStartTime:void 0,g_acquireLockEndTime:void 0,g_acquireLockRequestStatus:void 0,g_getDocumentStartTime:void 0,g_getDocumentEndTime:void 0,g_getDocumentRequestStatus:void 0,g_getCellsStartTime:void 0,g_getCellsEndTime:void 0,g_getInitializeLocalCobaltStartTime:void 0,g_getInitializeLocalCobaltEndTime:void 0,g_initialResponseTime:void 0,g_initialResponseReadyTime:void 0,g_fastViewOpenTime:void 0,g_initialRequestInvokedTime:void 0,g_onInitialResponseReady:void 0,g_isUserCreatingPersonalNotebookFirstTime:!1,g_networkType:void 0,g_bootSSRData:void 0,g_bootSSRHtmlStringLength:void 0,g_useLoadAsync:0},d={fastView:void 0,initialParaId:0,fastBootError:void 0};class h{static getElement(t){if(this.DOMElements.hasOwnProperty(t))return this.DOMElements[t];const e=document.getElementById(t);return e?this.DOMElements[t]=e:null}static removeElement(t){t&&this.DOMElements.hasOwnProperty(t.id)&&delete this.DOMElements[t.id],t&&t.parentNode&&t.parentNode.removeChild(t)}static removeElementById(t){this.removeElement(this.getElement(t))}}h.DOMElements={};class f{static initialize(t,e,n,i,o,s,r,a,c,l,u,d,h,f,m,p,g,b,w,v,S){this.isViewMode=t&&!m,this.isEmbedMode=e,this.isInTouchMode="ontouchstart"in window,this.isSimplifiedReactRibbonInTreatment=n,this.isOldRibbonCollapsedCookieOn="false"!==_.getCookie(i).toLowerCase(),this.isSimplifiedRibbonCookieOn="false"!==_.getCookie(o).toLowerCase(),this.isNewHeaderShown=!this.isViewMode,this.isSimplifiedReactRibbonShown=this.isSimplifiedReactRibbonInTreatment&&this.isSimplifiedRibbonCookieOn&&!this.isViewMode,this.isOldRibbonExpandedAndShown=!this.isSimplifiedReactRibbonShown&&!this.isOldRibbonCollapsedCookieOn&&!this.isViewMode,this.isOldRibbonCollapsedAndShown=!this.isSimplifiedReactRibbonShown&&this.isOldRibbonCollapsedCookieOn&&!this.isViewMode,this.isViewModeAndRibbonPanelSmall=this.isViewMode&&this.isOldRibbonCollapsedCookieOn&&!this.isSimplifiedReactRibbonInTreatment,this.isViewModeAndRibbonPanelLarge=this.isViewMode&&(!this.isOldRibbonCollapsedCookieOn||this.isSimplifiedReactRibbonInTreatment),this.isSnackbarNavPaneEnabled=s,this.isTwoPaneNavEnabled=r,this.isCssPositionRewriteEnabled=a,this.hideSkeletalHeader=c,this.hideSkeletalRibbon=l,this.hideSkeletalNavPane=u,this.embedViewer=d,this.isHostRenderingEnabled=h,this.postMessageOrigin=f,this.isOneNoteNavPaneCollapseOnSmallScreenEnabled=p,this.regionComposerIsEnabled=g,this.OneNoteReactMLRPreference="true"===_.getCookie(w).toLowerCase(),this.isReactMLRibbonEnabled=b&&(!this.isSimplifiedRibbonCookieOn||this.OneNoteReactMLRPreference),this.isVerticalShiftCanvasFixEnabled=v,this.isOnitSkeletalCropFixEnabled=S}}var m;!function(t){t[t.HideAnimationTime=256]="HideAnimationTime",t[t.MinWidthToShowPageColumnPane=900]="MinWidthToShowPageColumnPane",t[t.MinWidthToShowNavpane=499]="MinWidthToShowNavpane",t[t.MinWidthToResizeTwoPaneNav=425]="MinWidthToResizeTwoPaneNav",t[t.MinWidthForTwoPaneNav=300]="MinWidthForTwoPaneNav"}(m||(m={}));let p=0,g=!1,b=!1;class w{static clearAriaLoadingAttributes(){const t=document.getElementById("applicationOuterContainer");t&&(t.removeAttribute("aria-busy"),t.removeAttribute("aria-hidden"))}static getFastViewSkeletalClass(){let t;return t=f.isCssPositionRewriteEnabled?this.t():this.i(),t}static updateRibbonPanel(){f.regionComposerIsEnabled||(f.isCssPositionRewriteEnabled&&f.isSimplifiedRibbonCookieOn?this.h():this.S())}static updateWacDocumentPanel(){f.isCssPositionRewriteEnabled&&f.isSimplifiedRibbonCookieOn?this.C():this.R()}static customizeSkeletalExperience(){p=document.body.clientWidth,f.isSimplifiedReactRibbonShown?h.removeElementById("SkeletalAdditionOldRibbon"):h.removeElementById("SkeletalNewRibbon"),f.isEmbedMode||f.embedViewer?(h.removeElementById("SkeletalHeader"),h.removeElementById("SkeletalNewHeader")):f.isNewHeaderShown?h.removeElementById("SkeletalHeader"):h.removeElementById("SkeletalNewHeader"),f.hideSkeletalRibbon&&h.removeElementById("SkeletalRibbon"),f.hideSkeletalNavPane&&h.removeElementById("SkeletalNavpane"),this.A()}static bringFastViewToForegroundOfSkeletalCanvas(){const t=h.getElement("WACFastView");t&&(t.style.position="initial")}static removeAllSubunitsFromSkeletalCanvas(){const t=h.getElement("SkeletalCanvas");if(t)for(let e=t.children.length-1;e>=0;e-=1){const n=t.children.item(e);n&&"WACFastView"!==n.id&&t.removeChild(n)}}static fadeOutAndRemoveElement(t,e){const n=h.getElement(t);n&&(n.style.background="transparent",n.style.opacity="0",n.className+=" skeletalCover",window.setTimeout((()=>{h.removeElement(n),e&&e()}),m.HideAnimationTime))}static setMainContentEditable(){if(g)return;g=!0,this.fadeOutAndRemoveElement("SkeletalNavpane"),this.fadeOutAndRemoveElement("SkeletalMainContent");const t=document.getElementById("load_back");t&&(t.style.height="auto")}}function v(){const t=h.getElement("SkeletalExperience");return null!=t&&"rtl"===t.getAttribute("direction")}function S(t,e){window._bB&&window._bB.sendBeacon(t,e)}var C;w.t=()=>w.i(),w.i=()=>{let t="";return v()?t="SkeletalFastViewRtl":(t="SkeletalFastView",f.isTwoPaneNavEnabled&&!f.isEmbedMode?t="SkeletalFastView":f.isEmbedMode||p<=m.MinWidthToShowNavpane?t="SkeletalFastViewNoNavpane":p<=m.MinWidthToShowPageColumnPane&&(t="SkeletalFastViewPageColumnNavpane")),f.isViewModeAndRibbonPanelLarge&&(t+=" SkeletalFastViewViewMode"),f.isEmbedMode&&(t+=" SkeletalFastViewEmbedMode"),t},w.P=()=>{f.isCssPositionRewriteEnabled?w.I():w.W()},w.I=()=>{w.W()},w.W=()=>{const t=h.getElement("SkeletalMainContent");t&&!f.isCssPositionRewriteEnabled&&(t.className+=f.isEmbedMode?" collapsedRibbonEmbedMode":" collapsedRibbon"),h.removeElementById("SkeletalRibbonExtension")},w.h=()=>{if(!b)if(f.isViewMode)b=!0;else{document.getElementById("WACRibbonPanel")&&(b=!0);const t=document.getElementsByClassName("WACReadingBarPanel").item(0);t&&(t.style.display="none")}},w.S=()=>{if(b)return;const t=document.getElementsByClassName("WACReadingBarPanel").item(0);if(f.isViewMode&&t)b=!0,f.isViewModeAndRibbonPanelLarge?t.className+=" RibbonPanelMaximizedViewMode":f.isViewModeAndRibbonPanelSmall&&(t.className+=" RibbonPanelMinimized");else{if(!f.regionComposerIsEnabled){const t=document.getElementById("WACRibbonPanel");null!=t&&(b=!0,f.isSimplifiedReactRibbonShown?(t.className+=" RibbonPanelSLRMode",t.className+=" RibbonPanelNewSLRMode"):f.isOldRibbonExpandedAndShown&&!f.isInTouchMode?t.className+=" RibbonPanelMaximized":f.isOldRibbonExpandedAndShown&&f.isInTouchMode?t.className+=" RibbonPanelMaximizedTouchMode":f.isOldRibbonCollapsedAndShown&&(t.className+=" RibbonPanelMinimized"))}t&&(t.style.display="none")}},w.C=()=>{const t=document.getElementById("WACDocumentPanelContent");null!=t&&(t.style.border="unset")},w.R=()=>{const t=document.getElementById("WACDocumentPanel"),e=document.getElementById("WACDocumentPanelContent");null!=t&&(t.className+=" skeletalEnabled",f.isViewModeAndRibbonPanelLarge?t.style.top="40px":f.isViewModeAndRibbonPanelSmall?t.style.top="30px":f.isSimplifiedReactRibbonShown?t.style.top="77px":f.isOldRibbonCollapsedCookieOn||f.isInTouchMode||(t.style.top="124px"),v()?t.style.right="0px":f.isTwoPaneNavEnabled&&!f.isEmbedMode?p<m.MinWidthForTwoPaneNav?t.style.left=m.MinWidthToShowNavpane.toFixed()+"px":p<m.MinWidthToResizeTwoPaneNav?t.style.left=p.toFixed()+"px":t.style.left="426px":f.isEmbedMode||p<=m.MinWidthToShowNavpane?t.style.left="0px":p<=m.MinWidthToShowPageColumnPane?t.style.left="198px":f.isSnackbarNavPaneEnabled?t.style.left="426px":t.style.left="393px"),null!=e&&(e.style.border="unset")},w.A=()=>{const t=h.getElement("SkeletalMainContent"),e=h.getElement("SkeletalExperience"),n=h.getElement("SkeletalRibbon");if(f.hideSkeletalHeader&&e&&(e.className+=" noHeader"),f.hideSkeletalRibbon&&e&&(e.className+=" noRibbon"),f.hideSkeletalNavPane&&e&&(e.className+=" noNavPane"),f.isViewMode?(e&&f.isCssPositionRewriteEnabled&&e.classList.remove("skeletalSLRGridRows"),n&&(n.innerHTML=""),f.isViewModeAndRibbonPanelSmall?(t&&!f.isCssPositionRewriteEnabled&&(t.style.top=f.isEmbedMode?"30px":"78px"),e&&f.isCssPositionRewriteEnabled&&(e.className+=" skeletalLegacyRibbonGridRows"),n&&!f.isCssPositionRewriteEnabled&&(n.className="skeletalRibbon skeletalRibbonCollapsedViewMode")):f.isViewModeAndRibbonPanelLarge?(n&&!f.isCssPositionRewriteEnabled&&(n.className="skeletalRibbon skeletalRibbonExpandedViewMode"),f.isCssPositionRewriteEnabled&&e?e.className+=" skeletalReadingRibbonGridRows":!f.isCssPositionRewriteEnabled&&t&&(t.style.top=f.isEmbedMode?"40px":"88px")):e&&f.isCssPositionRewriteEnabled&&(e.className+=" skeletalReadingRibbonGridRows")):e&&!f.isSimplifiedReactRibbonShown&&f.isCssPositionRewriteEnabled&&(f.isOldRibbonExpandedAndShown&&!f.isInTouchMode?e.className+=" skeletalLegacyRibbonMaximizedGridRows":f.isOldRibbonExpandedAndShown&&f.isInTouchMode?e.className+=" skeletalLegacyRibbonMaximizedTouchModeGridRows":f.isOldRibbonCollapsedAndShown&&(e.className+=" skeletalLegacyRibbonGridRows")),f.isSimplifiedReactRibbonShown?n&&(n.className=f.isCssPositionRewriteEnabled?"skeletalPositionRewriteRibbon":"skeletalSLRNewVisual"):n&&f.isCssPositionRewriteEnabled&&(n.className="skeletalPositionRewriteRibbon",f.isViewMode&&(n.className+=" viewMode")),f.isEmbedMode){f.hideSkeletalHeader?n&&(f.isCssPositionRewriteEnabled||(n.style.top="0px")):n&&(f.isCssPositionRewriteEnabled||(n.style.top="48px"));const t=h.getElement("SkeletalAdditionOldRibbon");t&&!f.isCssPositionRewriteEnabled&&(t.style.top="0px")}if(v()&&w.L(),f.isOldRibbonCollapsedAndShown?w.P():f.isOldRibbonExpandedAndShown&&f.isEmbedMode&&t&&!f.isCssPositionRewriteEnabled&&(t.style.top="125px"),f.isTwoPaneNavEnabled&&!f.isEmbedMode&&(p>m.MinWidthToShowNavpane||!f.isOneNoteNavPaneCollapseOnSmallScreenEnabled)){const t=h.getElement("SkeletalNavpane"),e=h.getElement("SkeletalNavpaneSectionColumn"),n=h.getElement("SkeletalNavpanePageColumn"),i=h.getElement("SkeletalCanvas"),o=h.getElement("SkeletalExperience");if(null!=t&&null!=e&&null!=n&&null!=i&&null!=o)if(p<=m.MinWidthForTwoPaneNav)f.isCssPositionRewriteEnabled?o.className+=" skeletalOreoTwopaneShrunkGridColumns":(t.style.width="300px",i.style.left="299px"),e.style.width="124px",n.style.width="124px";else if(p<=m.MinWidthToResizeTwoPaneNav){f.isCssPositionRewriteEnabled?o.style.gridTemplateColumns=p.toFixed()+"px 100%":(t.style.width=p.toFixed()+"px",i.style.left=p-1+"px");const s=.5*p-24;e.style.width=s.toFixed()+"px",n.style.width=s.toFixed()+"px"}}else if(f.isEmbedMode||p<=m.MinWidthToShowNavpane){h.removeElementById("SkeletalNavpane");const t=h.getElement("SkeletalCanvas"),e=h.getElement("SkeletalExperience");f.isCssPositionRewriteEnabled&&e&&!f.hideSkeletalNavPane?f.isTwoPaneNavEnabled?e.className+=" skeletalNoTwopaneGridColumns":e.className+=" skeletalNoNavpaneGridColumns":!f.isCssPositionRewriteEnabled&&t&&(t.style.left="0px")}else if(p<=m.MinWidthToShowPageColumnPane){const t=h.getElement("SkeletalNavpane"),e=h.getElement("SkeletalNotebookName"),n=h.getElement("SkeletalCanvas"),i=h.getElement("SkeletalExperience");h.removeElementById("SkeletalNavpaneSectionColumn"),h.removeElementById("skeletalNavpaneTab"),f.isCssPositionRewriteEnabled&&i?i.className+=" skeletalLegacyNavpanePageOnlyGridColumns":f.isCssPositionRewriteEnabled&&null!=t&&null!=n&&(t.style.width="201px",n.style.left="200px"),e&&(e.style.right="42px")}if(f.isSimplifiedReactRibbonShown&&null!=t)f.isCssPositionRewriteEnabled||(t.style.paddingTop=f.isVerticalShiftCanvasFixEnabled?"124px":"126px",f.isEmbedMode&&!f.isOnitSkeletalCropFixEnabled&&(t.style.paddingTop="74px"),t.style.top=f.isReactMLRibbonEnabled?"60px":"0px");else if(f.isOldRibbonCollapsedAndShown){const e=document.getElementsByClassName("skeletalRibbonBoxContainer").item(0),n=h.getElement("SkeletalRibbonBar");null!=t&&null!=n&&null!=e&&(h.removeElement(e),n.style.height="29px",n.style.borderBottom="1px solid #d2d2d2",f.isCssPositionRewriteEnabled||(t.style.top="0px"))}else if(f.isOldRibbonExpandedAndShown&&f.isInTouchMode){const e=h.getElement("SkeletalRibbonExtension");null==t||null==e||f.isCssPositionRewriteEnabled||(e.style.height="108px",t.style.top="187px")}},w.L=()=>{const t=["SkeletalHeader","SkeletalNewHeader","SkeletalRibbonAppTitle","SkeletalSLRAppTitle","SkeletalRibbon","SkeletalAdditionOldRibbon","SkeletalMainContent","SkeletalCanvas"];for(const e in t){const n=h.getElement(t[e]);n&&(n.className+=" skeletalRTL")}const e=h.getElement("SkeletalCanvas");e&&(e.className+=" skeletalCanvasRtl")};class y{static initialize(t,e){C.O=t,C.D||(e?(C.T=document.getElementById("SkeletalContainer"),C.D=!0):(C.D=!0,C.T=document.createElement("div"),C.T.setAttribute("unselectable","on"),Object.assign(C.T.style,{pointerEvents:"none",width:"100%",height:"100%",zIndex:"1000",position:"absolute",visibility:"hidden",transition:"opacity "+C.F+"ms"}),C.T.id=C.M,C.T.className=C.T.id))}static launchExperience(t,e,n){let i="applicationOuterContainer";t&&(i=t),e&&(C.N=e);const o=document.getElementById(i);n||o.appendChild(C.T),C.B(),window.setTimeout((()=>C.dismissSkeletalBootUx()),C.N)}static setComponentReady(t){const e=C.$(t);!C.V&&e&&(e.isReady=!0,C.U()||C.fadeOutAndRemove(t))}static dismissSkeletalBootUx(){if(C.V)return!1;C.fadeOutAndRemove(C.M);for(const t in C.H)C.fadeOutAndRemove(t);return C.H={},C.V=!0,self.dispatchEvent(new CustomEvent("RibbonVisible")),!0}static getSkeletalComponentColor(t,e){return t?e?"#3D3D3D":"#323130":e?"#EBEBEB":C.G}static getSkeletalBackgroundColor(t,e){return t?e?"#141414":"#252423":e?"#F5F5F5":C.q}static getPlaceholderChatPaneGrandientColor1(t){return t?"#575757":"#e6e6e6"}static getPlaceholderChatPaneGrandientColor2(t){return t?"#333333":"#fafafa"}static addComponent(t){C.H[t.element.id]=t,t.element.style.transition="opacity "+C.F+"ms",C.T.appendChild(t.element),this.J.push(t.element.id)}static addComponentOutsideSkeletalContainer(t){C.H[t.element.id]=t,t.element.style.transition="opacity "+C.F+"ms"}static addShimmerToElement(e){if((0,t.isReducedAnimations)())return;const n=document.getElementById(e);if(!n)return;this.K();const i=document.createElement("div");i.id=e+"_Shimmer",Object.assign(i.style,{height:"200px",top:"-200px",width:"100000%",left:"-99900%",backgroundColor:"linear-gradient(rgba(255,255,255, 0), rgba(255,255,255,.4), rgba(255,255,255,.8), rgba(255,255,255,.4), rgba(255,255,255,0))",position:"absolute",transformOrigin:"left",zIndex:"1000",animation:"SkeletalShimmer 3s infinite linear"}),n.appendChild(i)}static fadeOutAndRemove(t,e){let n,i;t===C.M?n=C.T:(i=C.$(t),i&&(n=i.element)),n&&(n.style.opacity="0",window.setTimeout((()=>{C.X(n),i&&(C.Y(t),i.onRemoval&&i.onRemoval()),e&&e()}),C.F))}static isSkeletalDeepLink(){return C.O}static skeletalBootLoggingData(){return`isSkeletalBootShown: ${this.Z}, skeletalComponentsAdded: ${this.J}`}}C=y,y.D=!1,y.V=!1,y.N=3e4,y.M="SkeletalContainer",y.F=(0,t.isReducedAnimations)()?.001:200,y.H={},y.G="#EDEBE9",y.q="#F3F2F1",y.O=!1,y.tt=!1,y.Z=!1,y.J=[],y.B=()=>{C.T&&(C.T.style.visibility="visible",C.T.style.opacity="1",C.Z=!0)},y.et=()=>{for(const t in C.H)if(!C.H[t].isReady)return!1;return!0},y.U=()=>!!C.et()&&C.dismissSkeletalBootUx(),y.K=()=>{if(C.tt)return;const t=document.createElement("style");t.type="text/css",t.appendChild(document.createTextNode("@keyframes SkeletalShimmer {       100% { -webkit-transform: rotate(0.06deg); transform: rotate(0.06deg); }      }")),document.getElementsByTagName("head")[0].appendChild(t),C.tt=!0},y.$=t=>C.H[t],y.Y=t=>{delete C.H[t]},y.X=t=>{t&&t.parentNode&&t.parentNode.removeChild(t)};class _{static ensureCookieCompliance(t,e){if(t){let t=[];e&&(t=JSON.parse(e)),WacCookieCompliance.requestConsentWithSettings(new CookieComplianceSettings(t))}}static getCookie(t){if(!t)return"";if(t.indexOf("=")>=0)throw new RangeError(" = is not found in the cookie");const e=""+document.cookie,n=new RegExp("(?:^|; )"+t+"=([^;]*)"),i=e.match(n);return!i||i.length<2?"":i[1]}static isDocumentEmpty(t){function e(t,e){return-1===(" "+t.className+" ").indexOf(" "+e+" ")}const n=t.querySelectorAll(".Paragraph");return!(!n||1!==n.length||2!==n[0].childElementCount||e(n[0].children[0],"TextRun")||e(n[0].children[1],"EOP")||""!==n[0].children[0].innerText)}}function k(){function t(){return navigator.maxTouchPoints>0}return navigator.userAgent.indexOf("Android")>=0||navigator.userAgent.indexOf("iPad")>=0||navigator.userAgent.indexOf("Macintosh")>=0&&t()&&!(navigator.userAgent.indexOf("iPhone")>=0)||t()}const x="WACFastViewAbsolute",R="WACFastView",A="WACFastViewPositionRewrite";function P(t,e,n,i){let o;if(o=t.cssPositionRewriteIsEnabled&&!i?A:t.isRegionComposerShown&&!i?`${R} regionComposer`:R,t.wordIsSkeletalDeepLinkOn&&t.isDeepLinkScenario&&(o+=" Deeplink"),t.showRibbon||(o+=" HideRibbon"),t.showNavPane||(o+=" HideNavPane"),t.isOneNoteMobileViewerNavigationEnabled&&(o+=" ShowMobileViewerNavigation"),t.positionAbsolute){if(o+=" "+x,t.showRibbon?t.showRibbonHeader||(o+=" HeaderHidden"):o+=" HeaderAndRibbonHidden",t.showNavPane?t.showNavSections||(o+=" SectionsHidden"):o+=" NavHidden",t.simplifiedReactRibbonUxIsEnabled)o+=" OneLineRibbon",o+=" OneLineRibbonWithTabHeaderRefresh",t.bootToTabsOnly&&(o+=" TabsOnly");else{const i=e(t.ribbonPreferenceCookieName);(!t.ribbonExpandedByDefault&&"false"===i||t.ribbonExpandedByDefault&&"true"!==i)&&(o+=" RibbonPinned",n&&(o+=" Touch"))}t.skeletalBootUXIsEnabled&&(o+=" "+w.getFastViewSkeletalClass()),t.snackbarNavPaneIsEnabled&&(o+=" Snackbar"),t.twoPaneNavIsEnabled&&(o+=" TwoPaneNav")}return o}function I(){const t=document.getElementById("load_img");t&&(t.style.opacity="0",t.style.height="1px");const e=document.getElementById("load_back");e&&(e.style.opacity="0",e.style.height="1px"),function(){const t=window.performance&&window.performance.now?window.performance.now():0;let e;e=t>0&&window.g_splashScreenShownHighResTime>0?`{'k':[{'e': 3,'n':'BBISS', 'd': ${t-window.g_splashScreenShownHighResTime}, 'p':{'DismissedFrom':'FastView'}}]}`:"{'k':[{'e': 3,'n':'BBISS', 'p':{'DismissedFrom':'FastView'}}]}",S(e,"Kpi")}()}function E(){const t=document.getElementById("SkeletalPage");t&&(t.style.display="none",y.setComponentReady("SkeletalPage"))}function W(t,e){if(!(e.wordIsSkeletalDeepLinkOn&&e.isDeepLinkScenario||0===d.initialParaId)){const e=document.querySelector("p[paraid='"+d.initialParaId+"']");if(!e||!e.getBoundingClientRect)return;const n=e.getBoundingClientRect().bottom,i=t.getBoundingClientRect().bottom;t.firstElementChild&&(t.firstElementChild.scrollTop=n-i+70)}}function L(){const t=document.getElementById("application");t&&(t.style.top="0")}let O,D;function T(t){O=t;try{D=JSON.parse(M("DisabledChangeGates","{}"))}catch{D={}}}function F(t,e=!1){return!!O&&!!O[t]&&"true"===O[t].toLowerCase()||((t,e=!1)=>e)(0,e)}function M(t,e){return O&&O[t]?O[t]:e}class N{static launchExperience(t){f.initialize("false"===t.IsEditMode,"true"===t.IsEmbedMode,"true"===t.SimplifiedReactRibbonUxIsEnabled,t.RibbonPreferenceCookieNameHint,t.IsSimplifiedRibbonOnCookieName,"true"===t.SnackbarNavPaneIsEnabled,"true"===t.OneNoteTwoPaneNavPaneIsEnabled,"true"===t.OneNoteCssPositionRewriteIsEnabled,"true"===t.HideHeaderEmbedded,"true"===t.HideRibbonEmbedded||"true"===t.IsQuickNote,"true"===t.ONHideNavEmbedded,"true"===t.MobileEmbedViewer,"true"===t.PageSSRHostRenderingIsEnabled,t.PostMessageOrigin,"true"===t.OneNoteModeSwitcherIsEnabled,"true"===t.OneNoteNavPaneCollapseOnSmallScreenIsEnabled,"true"===t.RegionComposerIsEnabled,"true"===t.ShowSkeletalMLR,t.ReactRibbonMLRPreferenceCookieName,"true"===t.VerticalShiftCanvasFixEnabled,"true"===t.OnitSkeletalCropFixEnabled),w.customizeSkeletalExperience(),this.showSkeletalUx(),window.setTimeout((()=>{N.dismissSkeletalBootUx(!0)}),this.FORCE_DISMISS_AFTER)}static showSkeletalUx(){const t=h.getElement("SkeletalExperience");if(t){const e=h.getElement("SkeletalCanvas");"true"===M("MobileEmbedViewerIsEnabled","false")&&e&&(e.style.left="-28px"),t.style.opacity="1",t.className+=" skeletalShow"}}static setRibbonReady(){this.V||(this.nt=!0,!this.tryDismissSkeletalBootUxIfAllComponentsReady()&&this.it&&w.fadeOutAndRemoveElement("SkeletalRibbon",(()=>{self.dispatchEvent(new CustomEvent("RibbonVisible"))})))}static setPageReady(){this.V||(w.updateRibbonPanel(),w.updateWacDocumentPanel(),this.it=!0,this.tryDismissSkeletalBootUxIfAllComponentsReady()||this.dismissSkeletalCanvas())}static setNavpaneReady(){this.V||(w.updateRibbonPanel(),this.ot=!0,!this.tryDismissSkeletalBootUxIfAllComponentsReady()&&this.it&&w.fadeOutAndRemoveElement("SkeletalNavpane",(()=>{w.setMainContentEditable()})))}static sendPostMessageToHostWindowRendering(){window.requestAnimationFrame((()=>{window.requestAnimationFrame((()=>{if(!this.st){const t=window.parent,e={MessageId:"App_SwitchToWacFrame",SendTime:(new Date).getTime(),CorrelationId:"",Values:{entryPoint:"FastView"}};""!==f.postMessageOrigin&&t.postMessage(JSON.stringify(e),f.postMessageOrigin),this.st=!0}}))}))}static setFastViewReady(){this.V||(f.isHostRenderingEnabled?this.dismissSkeletalCanvas(this.sendPostMessageToHostWindowRendering.bind(this)):this.dismissSkeletalCanvas())}static showFastViewOnSkeletalCanvas(){if(w.bringFastViewToForegroundOfSkeletalCanvas(),w.removeAllSubunitsFromSkeletalCanvas(),f.isHostRenderingEnabled){const t=document.querySelector(".skeletalShow");t&&t.addEventListener("animationend",(()=>{this.sendPostMessageToHostWindowRendering()})),window.setTimeout((()=>{this.sendPostMessageToHostWindowRendering()}),this.POST_MESSAGE_FOR_HOST_RENDERING)}}static tryDismissSkeletalBootUxIfAllComponentsReady(){return!!(this.it&&this.ot&&this.nt)&&this.dismissSkeletalBootUx()}static dismissSkeletalBootUx(t=!1){if(this.V)return!1;const e=document.getElementById("load_back"),n=document.getElementById("WACDocumentPanel"),i=document.getElementById("WACRibbonPanel");return e&&n&&i?(N.removeSkeletalExperience(),N.adjustElementsAfterSkeletalDismissal(e,n,i),this.V=!0,!0):(t&&N.removeSkeletalExperience(),!1)}static removeSkeletalExperience(){const t=h.getElement("SkeletalExperience");t&&h.removeElement(t)}static adjustWacRibbonAfterDismissSkeletal(t){f.regionComposerIsEnabled?t.style.height="100%":f.isCssPositionRewriteEnabled?this.adjustPositionRewriteWacRibbonAfterDismissSkeletal(t):this.adjustAbsoluteWacRibbonAfterDismissSkeletal(t)}static adjustPositionRewriteWacRibbonAfterDismissSkeletal(t){t.style.height="auto"}static adjustAbsoluteWacRibbonAfterDismissSkeletal(t){f.isSimplifiedReactRibbonShown?t.style.height="77px":t.style.height="auto"}static adjustWacCanvasAfterDismissSkeletal(t){f.isCssPositionRewriteEnabled&&f.isSimplifiedReactRibbonShown||this.adjustAbsoluteWacCanvasAfterDismissSkeletal(t)}static adjustAbsoluteWacCanvasAfterDismissSkeletal(t){t.className="SkeletalWacDocumentPanel skeletalEnabled "+t.className}static dismissSkeletalCanvas(t){const e=document.getElementById("WACFastView");if(this.V&&(!e||!e.parentElement||"SkeletalCanvas"!==e.parentElement.id))return;this.it=!0;const n=document.getElementById("load_back");null!=n&&(this.preDismissSkeletalCanvas(n),w.fadeOutAndRemoveElement("SkeletalCanvas",(()=>{t&&t(),this.ot&&w.setMainContentEditable()})))}static preDismissSkeletalCanvas(t){f.isCssPositionRewriteEnabled?this.preDismissPositionRewriteSkeletalCanvas(t):this.preDismissAbsoluteSkeletalCanvas(t)}static preDismissPositionRewriteSkeletalCanvas(t){this.preDismissAbsoluteSkeletalCanvas(t)}static preDismissAbsoluteSkeletalCanvas(t){const e=document.getElementById("WACRibbonPlaceholder"),n=h.getElement("SkeletalRibbonExtension");if(null!=e&&null!=n&&(e.style.height="124px"),t.style.background="transparent",v()){const t=document.getElementById("application");t&&(t.style.minWidth="0px")}if(!f.isEmbedMode){const t=document.getElementById("AppHeaderPanel");t&&(t.style.height="48px")}}static adjustElementsAfterSkeletalDismissal(t,e,n){t&&(t.style.display="none",t.style.height="1px",t.style.opacity="0",t.setAttribute("aria-hidden","true"),w.clearAriaLoadingAttributes()),e&&this.adjustWacCanvasAfterDismissSkeletal(e),n&&this.adjustWacRibbonAfterDismissSkeletal(n)}}N.nt=!1,N.it=!1,N.ot=!1,N.V=!1,N.st=!1,N.FORCE_DISMISS_AFTER=2e4,N.POST_MESSAGE_FOR_HOST_RENDERING=500;class B{static getFloatingObjectsContainerWidth(t=!1){return t?332:this.canvasAndFcOuterSurfaceOffset+this.floatingContainersOuterSurfaceWidth}static shouldShiftFastView(t,e,n){return B.shouldShiftBasedOnScreenSize(n)&&B.shouldShiftBasedOnNumSections(e)&&t}static shouldShiftRealCanvas(t,e,n,i,o){if(!B.shouldShiftBasedOnScreenSize(t))return!1;const s=e(n);return!!B.shouldShiftBasedOnNumSections(s)&&i(o)}static shouldShiftBasedOnScreenSize(t){return"Small"!==t}static shouldShiftBasedOnNumSections(t){return 1===t}}B.canvasAndFcOuterSurfaceOffset=30,B.floatingContainersOuterSurfaceWidth=240;const $=()=>!!window&&!!window.performance&&!!window.performance.mark;function V(){return"PerformanceObserver"in window&&"function"==typeof PerformanceObserver}function U(t){return V()&&PerformanceObserver.supportedEntryTypes&&-1!==PerformanceObserver.supportedEntryTypes.indexOf(t)}const H=t=>{if($())try{window.performance.mark(t)}catch{}};function j(t,e,n){if($()&&window.performance.measure)try{window.performance.measure(t,e,n)}catch(t){}}const z={},G="undefined"!=typeof self&&self.trustedTypes?self.trustedTypes:{createPolicy:(t,e)=>e};var q=o(992),J=o.n(q);const K={ADD_TAGS:["#comment"],RETURN_TRUSTED_TYPE:!1},X=["applet","base","basefont","command","embed","frame","frameset","keygen","link","meta","noframes","noscript","object","param","script","title"],Q=["contenteditable","contextmenu","controls","data","decoding","defer","dirname","draggable","dropzone","form","formaction","http-equiv","icon","importance","itemprop","keytype","kind","language","lazyload","manifest","minlength","muted","ping","sandbox","scoped","slot","spellcheck","srcdoc","srclang","start","target","translate","wrap","onerror","onclick","onload","onmouseover","onfocus","onblur","src","href"],Y=((t,e,n=G)=>{try{z[t]||(z[t]=n.createPolicy(t,{createHTML:e.createHTML,createScript:e.createScript,createScriptURL:e.createScriptURL}))}catch{console.info(`Skipped duplicate policy creation: ${t}`)}return z[t]})("domPurifyHTML",{createHTML:(t,e)=>((t,e)=>{let n=!1;const i=e?{...K,...e}:K,o=(0,q.sanitize)(t,i);return e?.USE_PROFILES?o:(n=(t=>{let e=!1,n=!1;const i=new Set,o=new Set;return t.length>0&&(t.forEach((t=>{t.attribute?(n=Q.includes(t.attribute.localName)||n,i.add(t.attribute.localName)):t.element&&(n=X.includes(t.element.localName)||n,o.add(t.element.localName))})),(i.size>0||o.size>0)&&(n||(e=!0))),e})(q.removed),n?t:o)})(t,e)},undefined);var Z;class tt{constructor(t,e){this.eventName=t,this.timeStamp=(new Date).getTime()-e}}class et{removeKeypressEventListener(){this.appearance.fixRemoveKeypressEventListenerInFastView?document.removeEventListener("keydown",this.rt):this.ct&&document.removeEventListener("keydown",this.ct)}showRibbonPlaceholder(){function t(t,e){const n=document.createElement("div");return n.className="ribbonBar",n.setAttribute("unselectable","on"),n.appendChild(t),e&&n.appendChild(e),n}const e=(e,n,i)=>{const o=document.createElement("div");let s;return o.className=e?"oneLineRibbonUpperWithAnimation":"oneLineRibbonUpper",o.className+=" oneLineRibbonUpperWithTabHeaderRefresh",i||(s=document.createElement("div"),s.className=e?"oneLineRibbonLowerWithAnimation":"oneLineRibbonLower"),this.appearance.darkModeEnabled&&(o.className+=" SharedUXDarkModeFastViewRibbon",s&&(s.className+=" SharedUXDarkModeFastViewRibbon")),n&&s&&(s.style.height="90px"),t(o,s)},n=()=>{const t=document.createElement("div");t.className="cui-topBar1",this.appearance.reactSharedHeaderIsEnabled?t.className+=" cui-topBar1-transitionalReactHeaderUI":t.className+=" cui-topBar1-transistionalHeaderUI",this.appearance.darkModeEnabled&&(t.className+=" SharedUXDarkModeFastViewHeader"),t.setAttribute("unselectable","on");let e="",n="";this.appearance.headerBackgroundColorOverride&&(e=`background-color:${this.appearance.headerBackgroundColorOverride};`),this.appearance.headerTextColorOverride&&(n=`color:${this.appearance.headerTextColorOverride};`),this.appearance.reactSharedHeaderIsEnabled&&(e||n)&&t.setAttribute("style",`${e}${n}`);const i=document.createElement("span");i.className="cui-QATRowLeft BreadcrumbContainer";const o=document.createElement("span");o.className="AppAndBrandContainer",this.appearance.reactSharedHeaderIsEnabled&&e&&o.setAttribute("style",e);const s=document.createElement("div");s.className="WACFastBootLoader";const r=document.createElement("span");r.className="BreadcrumbItem";const a=this.appearance.reactSharedHeaderIsEnabled&&this.appearance.headerAppLauncherIsHidden;a?r.setAttribute("style","width:8px;height:48px;display:inline-block;"):r.setAttribute("style","width:48px;height:48px;display:inline-block;"),document.createElement("span").className="OfficeOnlineBrandSwitcherSeparator";const c=document.createElement("span");return c.className="headBrand",this.appearance.reactSharedHeaderIsEnabled?c.setAttribute("style","line-height:48px;margin-left:2px;"):c.setAttribute("style","line-height:48px;"),c.appendChild(document.createTextNode(this.appearance.appBrandedName)),o.appendChild(r),o.appendChild(c),a||o.appendChild(s),i.appendChild(o),t.appendChild(i),this.appearance.appColorUpdateIsEnabled&&(t.className+=" cui-color-update",o.className+=" cui-color-update"),t};if(document.getElementById("ExternalHeaderFullTopBars"))return;const i=this.getTopbarContainerFunc(),o=this.appearance.showHeaderPlaceholder?document.getElementById("HeaderPlaceholder"):void 0;if(i&&this.appearance.showRibbonHeader)if(o)this.topbarPlaceholderElement=o;else{const t=document.createElement("div");t.className="cui-topBar2",this.appearance.darkModeEnabled&&(t.className+=" SharedUXDarkModeFastViewHeader"),t.setAttribute("unselectable","on");const e=document.createElement("div");e.id="WACTopbarPlaceholder";const o=n();e.appendChild(o),e.appendChild(t),i.appendChild(e),this.topbarPlaceholderElement=e}const s=this.getRibbonContainerFunc();if(s&&0===s.children.length){const n=document.createElement("div");if(n.id="WACRibbonPlaceholder",n.className=n.id,this.appearance.showRibbon&&!this.appearance.skeletalBootUXIsEnabled)if(this.appearance.simplifiedReactRibbonUxIsEnabled){const t=e(this.appearance.simplifiedReactRibbonAnimationIsEnabled,this.appearance.reactMultiLineRibbonIsVisible,this.appearance.bootToTabsOnly);t.addEventListener("click",(()=>{this.lt(),this.ut("ribbonClick")})),n.appendChild(t)}else if(this.appearance.showRibbonImage&&this.appearance.ribbonExpandedByDefault&&"true"!==this.getCookieFunc(this.appearance.ribbonPreferenceCookieName)){const e=function(e,n){const i=document.createElement("div");i.className="ribbonUpper";const o=document.createElement("div");o.className="ribbonLower";const s=document.createElement("div");s.className="ribbonLeft";const r=function(t,e){let n=e;if(t){const t="bgapp_word_topleft",i="bgapp_word_topleft_touch";n=e.replace(t,i)}return n}(e,n);return s.style.backgroundImage=`url('${r}')`,e&&(o.className+=" ribbonTouch",s.className+=" ribbonTouch"),i.appendChild(s),t(i,o)}(this.dt,this.appearance.ribbonImageBase);e.addEventListener("click",(()=>{this.lt(),this.ut("ribbonClick")})),n.appendChild(e)}else n.style.height="30px";else n.className="cui-exth";s.appendChild(n),this.ribbonPlaceholderElement=n}}open(e,n=!1){this.appearance.showRibbonHeader||L(),this.ht();const i=this.getDocumentContainerFunc();if(!i||!e)return!1;const o="canvasWrap"===i.id,s=document.createElement("div");let r=P(this.appearance,this.getCookieFunc,this.dt,o);this.appearance.isRegionComposerShown&&(r+=" WACFastViewRegionComposer"),this.appearance.reactMultiLineRibbonIsVisible&&(r+=" WACFastViewMLRVisible"),s.className=r,s.id="WACFastView";const a=document.getElementById("CachedViewThemedCanvasBackgroundContainer");if(this.appearance.isBrowserSideCacheEnabled&&a?(i.removeChild(a),s.appendChild(a),a.innerHTML=this.appearance.isInnerHTMLOfficeBootPolicyEnabled?Y.createHTML(e):e):s.innerHTML=this.appearance.isInnerHTMLOfficeBootPolicyEnabled?Y.createHTML(e):e,this.appearance.isOneNoteCanvasZoomEnabled&&this.appearance.currentZoomLevel&&1!==this.appearance.currentZoomLevel){const t=s.querySelector(".PageContentOrigin");null!==t&&(t.style.transform=`scale(${this.appearance.currentZoomLevel})`)}if(this.htmlElement=s,this.appearance.editable&&(this.isEditable=_.isDocumentEmpty(s)),n)s.style.visibility="hidden";else{this.appearance.fixRemoveKeypressEventListenerInFastView?document.addEventListener("keydown",this.rt):(this.ct=this.rt,document.addEventListener("keydown",(t=>{this.ct&&this.ct(t)})));const e=t=>{this.ut(t.type),this.lt()};if(s.firstChild&&(s.firstChild.addEventListener("scroll",e),s.firstChild.addEventListener("click",e),s.firstChild.addEventListener("dblclick",e),s.firstChild.addEventListener("contextmenu",(t=>{this.lt(),this.ft(t)})),o)&&s.firstChild.classList.add("WACFastViewNavOreoGrid"),B.shouldShiftFastView(this.hasUnresolvedComments,this.numSections,t.getLayoutBreakpoint())?(this.ut("Shifting Fast View"),this.appearance.isBrowserSideCacheEnabled||this.gt(s),this.hasShifted=!0):this.ut("Not shifting Fast View"),this.ut("HasUnresolvedComments: "+this.hasUnresolvedComments+", NumSections == 1: "+(1===this.numSections)+", ScreenSize == Small: "+("Small"===t.getLayoutBreakpoint())),this.appearance.showSkeletalTaskPane&&this.appearance.isBrowserSideCacheEnabled){const t=s.querySelector(".PaginatedContentContainer");if(t){const e=this.appearance.defaultCopilotChatPaneWidth+"px";if(this.appearance.isRtl){t.style.paddingLeft=e;const n=s.querySelector(".WACViewPanel");n&&n.classList.contains("Ltr")&&!n.classList.contains("Rtl")&&(n.classList.remove("Ltr"),n.classList.add("Rtl"))}else t.style.paddingRight=e}}i.appendChild(s),navigator.userAgent.indexOf("Macintosh")>=0&&document.body.classList.add("Mac"),this.appearance.wordIsSkeletalDeepLinkOn&&this.appearance.isDeepLinkScenario&&document.body.classList.add("Deeplink"),this.fastViewOnSkeletal?N.showFastViewOnSkeletalCanvas():u.g_isUserCreatingPersonalNotebookFirstTime||(this.appearance.skeletalBootUXIsEnabled?N.setFastViewReady():(I(),this.appearance.isNewSkeletalUXExperienceEnabled&&E())),W(s,this.appearance),this.bt("RecordContentDisplayed"),this.isEditable&&(s.className+=" WACFastViewEditable",this.wt(s),this.bt("RecordAppInteractive"))}return this.openTime=(new Date).getTime(),H("ViewableEnd"),j("Viewable","StartWacBoot","ViewableEnd"),!0}isOpen(){return!(!this.htmlElement||!this.htmlElement.parentNode)}constructor(t,e,n,i,o="Default",s=_.getCookie,r=!1,a=!1,c=0,l=(t=>{})){this.getTopbarContainerFunc=t,this.getRibbonContainerFunc=e,this.getDocumentContainerFunc=n,this.appearance=i,this.entry=o,this.getCookieFunc=s,this.fastViewOnSkeletal=r,this.hasUnresolvedComments=a,this.numSections=c,this.displayToastFunc=l,this.dt=k(),this.rt=t=>{"Shift"!==t.key&&"Control"!==t.key&&"Alt"!==t.key&&(this.lt(),this.ut(t.type))},this.vt=t=>{(13===t.keyCode||t.ctrlKey&&(66===t.keyCode||73===t.keyCode||85===t.keyCode))&&(t.preventDefault(),this.lt(),this.ut(t.key))},this.St=t=>{if(void 0!==this.isEditable&&void 0!==this.htmlElement&&void 0!==this.Ct&&this.isEditable&&this.appearance.pasteLoadingUI&&!this.isPasteLoading&&this.htmlElement.parentElement){this.isPasteLoading=!0;const e=function(t){const e=document.createElement("div");e.id="WACLoadingPasteUI";const n=document.createElement("div");n.className="WACFastLoadingBoxUI";const i=document.createElement("img");return i.src=t,i.className="WACProgressIcon",n.appendChild(i),e.appendChild(n),e.appendChild(function(){const t=document.createElement("div");return t.className="WACFastLoadingOverlay WACDialogOverlay",t}()),e.setAttribute("aria-busy","true"),e.setAttribute("role","progressbar"),e}(this.appearance.loadingUIGif);this.htmlElement.parentElement.appendChild(e),this.pasteData=function(t){const e={};if(null!=t&&null!=t.types){const n=t.types[0];e.type=n,e.data=t.getData(n)}else{const t=window.clipboardData,n=t.getData("text");null!==n?(e.type="text/plain",e.data=n):t.files.length>0&&(e.type="image/png",e.data=t.files[0])}return e}(t.clipboardData),this.Ct.removeAttribute("contentEditable"),t.preventDefault()}else this.ft(t);this.lt()},this.ft=t=>{this.ut(t.type),t.preventDefault()},this.ut=t=>{this.eventLogs&&this.openTime&&this.eventLogs.push(new tt(t,this.openTime))},this.lt=()=>{this.appearance.isBrowserSideCacheEnabled&&(this.displayToastFunc(this.appearance.isRtl),this.ut("Toast shown"))},this.yt=t=>{if(this.lt(),this.ut(t.type),this.Ct&&t.target!==this.Ct){if(this.Ct.focus(),window.getSelection){const t=window.getSelection();t&&t.collapseToEnd()}t.preventDefault()}},this.wt=t=>{const e=t.querySelector(".PageContentContainer");e&&(e.className+=" WACFastViewEditor",e.addEventListener("mousedown",(t=>{this.yt(t)}))),this.Ct=t.querySelector(".NormalTextRun"),this.Ct&&(this.Ct.contentEditable="true",this.Ct.style.outline="0px",this.Ct.spellcheck=!1,this.Ct.setAttribute("aria-hidden","true"),this.Ct.focus(),this.Ct.addEventListener("paste",(t=>{this.St(t)})),this.Ct.addEventListener("keydown",(t=>{this.vt(t)})))},this.bt=t=>{S(t,"BootPhaseCompleted")},this.gt=t=>{if(null==t)return;const e=t.querySelector(".OutlineContainer"),n=t.querySelector(".PageContentContainer");if(null==e||null==n)return;const i=document.createElement("div"),o=B.getFloatingObjectsContainerWidth(this.appearance.commentUXRefreshEnabled)+"px";this.appearance.isRtl?i.style.paddingLeft=o:i.style.paddingRight=o,n.appendChild(i),i.appendChild(e)},this.ht=()=>{this.appearance.positionAbsolute&&this.appearance.showRibbon&&!this._t&&!this.appearance.skeletalBootUXIsEnabled&&(this.showRibbonPlaceholder(),this._t=!0)},this.eventLogs=[],this.openTime=0,this.hasShifted=!1}}et.cssClass=R,et.cssPositionRewriteClass=A,et.cssClassAbsolute=x;class nt{static initialize(){this.metrics={initialVisibility:document.visibilityState,initializeTime:new Date,events:[]},document.addEventListener("visibilitychange",nt.handleVisibilityChange)}static stop(){document.removeEventListener("visibilitychange",this.handleVisibilityChange)}static handleVisibilityChange(){const t={visibility:document.visibilityState,time:new Date};nt.metrics.events.push(t)}}nt.initialize();class it{get result(){return this.kt}get isSuccess(){return this.xt}get errorMessage(){return this.Rt}constructor(t,e,n=""){this.kt=t,this.xt=e,this.Rt=n}}!function(t){t.DocumentCacheItemCacheMiss="CacheMiss",t.DocumentCacheItemInvalidSchemaVersion="InvalidSchemaVersion",t.DocumentCacheItemExpired="CacheExpired",t.DocumentCacheItemInvalidColorViewMode="InvalidColorView",t.DocumentCacheItemInvalidCanvasViewMode="InvalidCanvasView",t.DocumentCacheItemValid="CacheValid"}(Z||(Z={}));class ot{static validateDocumentCacheItem(t,e){return t?Date.now()-t.timeStamp>=ot.TIMEOUT_IN_MILLISECONDS?Z.DocumentCacheItemExpired:t.schemaVersion!==e?Z.DocumentCacheItemInvalidSchemaVersion:Z.DocumentCacheItemValid:Z.DocumentCacheItemCacheMiss}static validateDocumentCacheItemViewMode(t,e,n){return t?t.isPaginatedView!==e?Z.DocumentCacheItemInvalidCanvasViewMode:t.isDarkCachedView!==n?Z.DocumentCacheItemInvalidColorViewMode:Z.DocumentCacheItemValid:Z.DocumentCacheItemCacheMiss}static validateDocumentCacheItemColorViewModeOnly(t,e){return t?t.isDarkCachedView!==e?Z.DocumentCacheItemInvalidColorViewMode:Z.DocumentCacheItemValid:Z.DocumentCacheItemCacheMiss}}ot.MILLISECONDS_IN_A_DAY=864e5,ot.TIMEOUT_IN_DAYS=30,ot.TIMEOUT_IN_MILLISECONDS=ot.TIMEOUT_IN_DAYS*ot.MILLISECONDS_IN_A_DAY,ot.LOG_CATEGORY="DocumentCacheUtilsLogs";class st{constructor(t,e,n,i,o,s,r,a){this.documentViewport=t,this.timeStamp=e,this.schemaVersion=n,this.isPaginatedView=i,this.documentItemSize=o,this.hasUnresolvedComments=s,this.numSections=r,this.isDarkCachedView=a}}class rt{static executeStorageAction(t,e,n){try{return t()}catch(t){return new it(n,!1,"Unexpected error in "+e+": "+(t.message||"Unknown"))}}static getAndLoadDocumentCache(t,e=!1){return this.executeStorageAction((()=>t.loadDocumentCache(e)),this.LOAD_LOG_CATEGORY,rt.defaultDocumentCacheItem)}static getLoadedDocumentCacheItem(t){if(!t.getDocumentBrowserCache().isSupported())return S("Cache is not supported",rt.LOAD_LOG_CATEGORY),null;let e=null;try{e=t.getDocumentCacheItemFromStorage(),S(`getDocumentCacheItemFromStorage result: ${e}`,rt.LOAD_LOG_CATEGORY)}catch(t){S("Exception in DocumentCacheLoader: "+t.message,rt.LOAD_LOG_CATEGORY)}return e}static saveDocument(t,e,n=!0,i=!1,o=!1,s=1,r="",a=""){return this.executeStorageAction((()=>t.saveDocument(e,n,i,o,s,r,a)),this.SAVE_LOG_CATEGORY,"")}static evictInvalidCacheEntries(t){try{S(`DocumentCacheRemover.evictInvalidCacheEntries result: ${t.evictInvalidCacheItems()}`,rt.REMOVE_LOG_CATEGORY)}catch(t){S("Exception in DocumentCacheRemover.evictInvalidCacheEntries: "+t.message,rt.REMOVE_LOG_CATEGORY)}}static evictSpecifiedCacheItem(t,e){try{S(`DocumentCacheRemover.evictSpecifiedCacheItem result: ${t.evictSpecifiedCacheItem(e)}`,rt.REMOVE_LOG_CATEGORY)}catch(t){S("Exception in DocumentCacheRemover.evictSpecifiedCacheItem: "+t.message,rt.REMOVE_LOG_CATEGORY)}}static evictAllCacheItems(t){try{S(`DocumentCacheRemover.evcitAllCacheItem result: ${t.evictAllCacheItems()}`,rt.REMOVE_LOG_CATEGORY)}catch(t){S("Exception in DocumentCacheRemover.evictAllCacheItems: "+t.message,rt.REMOVE_LOG_CATEGORY)}}}rt.LOAD_LOG_CATEGORY="GetAndLoadDocumentCache",rt.SAVE_LOG_CATEGORY="SaveDocument",rt.REMOVE_LOG_CATEGORY="RemoveInvalidDocumentCacheItem",rt.defaultDocumentCacheItem=new st("",0,"",!1,0,!1,0,!1);class at{getDocumentBrowserCache(){return this.documentBrowserCache}loadDocumentCache(t=!1){const e=this.getDocumentCacheItemFromStorage();let n=ot.validateDocumentCacheItem(e,this.currentSchemaVersion);if(n===Z.DocumentCacheItemValid&&(n=t?ot.validateDocumentCacheItemColorViewModeOnly(e,this.isDarkCanvasBackground):ot.validateDocumentCacheItemViewMode(e,this.isPaginatedMode,this.isDarkCanvasBackground)),n!==Z.DocumentCacheItemValid)return new it(rt.defaultDocumentCacheItem,!1,n);if(e?.isDarkCachedView&&!this.createDarkModeThemeContainer())throw"DarkModeThemeContainer creation failed";const i=window.self.g_instantApp;if(!i||!e)throw"Instant app is null";{const t=J().sanitize(e.documentViewport);i.launchFastView(t,!1,e.hasUnresolvedComments,e.numSections,this.toastMessage)}return new it(e,!0)}getDocumentCacheItemFromStorage(){if(this.documentCacheItem)return this.documentCacheItem;const t=this.documentBrowserCache.getCacheKey(this.documentId);return this.documentCacheItem=this.documentBrowserCache.getDocumentCacheItem(t),this.documentCacheItem}constructor(t,e,n,i,o,s,r){this.documentCacheItem=null,this.documentBrowserCache=t,this.documentId=e,this.currentSchemaVersion=n,this.isPaginatedMode=i,this.isDarkCanvasBackground=o,this.createDarkModeThemeContainer=s,this.toastMessage=r}}at.MILLISECONDS_IN_A_DAY=864e5,at.TIMEOUT_IN_DAYS=30,at.LOG_CATEGORY="CanvasLoaderLogs";class ct{evictInvalidCacheItems(){const t=this.documentBrowserCache.getKeysInCache();let e=0;for(let n=0;n<t.length;n++){const i=t[n],o=this.documentBrowserCache.getDocumentCacheItem(i);ot.validateDocumentCacheItem(o,this.currentSchemaVersion)!==Z.DocumentCacheItemValid&&(this.documentBrowserCache.removeDocumentCacheItem(i),e++)}return e}evictSpecifiedCacheItem(t){const e=this.documentBrowserCache.getCacheKey(t);return!!this.documentBrowserCache.getDocumentCacheItem(e)&&(this.documentBrowserCache.removeDocumentCacheItem(e),!0)}evictAllCacheItems(){return this.documentBrowserCache.clearBrowserCache()}constructor(t,e){this.documentBrowserCache=t,this.currentSchemaVersion=e}}const lt="UnavailabilityToast";class ut{setVisibility(t){this.toastElement.style.visibility=t?"visible":"hidden"}dispose(){this.toastElement.parentNode?.removeChild(this.toastElement)}setTitle(t){t?this.toastTitleElement?this.toastTitleElement.innerText=t:(this.toastTitleElement=this.createToastTitle(t),this.toastElement.appendChild(this.toastTitleElement)):this.toastTitleElement&&(this.toastElement.removeChild(this.toastTitleElement),this.toastTitleElement=void 0)}setMessage(t){t?this.toastMessageElement?this.toastMessageElement.innerText=t:(this.toastMessageElement=this.createToastMessage(t),this.toastElement.appendChild(this.toastMessageElement)):this.toastMessageElement&&(this.toastElement.removeChild(this.toastMessageElement),this.toastMessageElement=void 0)}setIcon(t,e){this.hasSpinner=!!e,this.toastElement.removeChild(this.toastIconElement),this.toastIconElement=this.createToastIcon(t),this.toastElement.insertBefore(this.toastIconElement,this.toastElement.firstChild)}createToastContainer(){const t=document.createElement("div");return t.id=lt,t.setAttribute("role","alert"),t.setAttribute("style",'display: flex;\n      visibility: hidden;\n      padding: 12px 16px;\n      background-color: #FFF4CE;\n      color: #484644;\n      font-size: 14px;\n      line-height: 20px;\n      box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 10px 0 rgba(0, 0, 0, 0.19);\n      border-radius: 4px;\n      font-family: "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif;\n      -webkit-touch-callout: none;\n      -webkit-user-select: none;\n      -moz-user-select: none;\n      -ms-user-select: none;\n      user-select: none;\n      pointer-events: auto;\n      border: 2px solid transparent;'),t.appendChild(this.toastIconElement),t}createToastIcon(t){const e=document.createElement("span");if(e.id="UnavailabilityToastIcon",this.hasSpinner)!function(t,e){const n=document.createElement("div");n.id="UnavailbilitySpinner",n.setAttribute("style","border: 1.5px solid black;\n    border-top: 1.5px solid gray;\n    border-radius: 100%;\n    font-size: 12px;\n    width: 20px;\n    height: 20px;\n    -webkit-animation: spin 1.2s linear infinite; /* Safari */\n    animation: spin 1.2s linear infinite;"),e?n.style.marginLeft="7px":n.style.marginRight="7px";const i=document.createElement("style");i.type="text/css";const o=document.createTextNode("  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    20% { transform: rotate(50deg); }\n    70% { transform: rotate(270deg); }\n    100% { transform: rotate(360deg); }\n  }\n  \n  @-webkit-keyframes spin {\n    0% { -webkit-transform: rotate(0deg); }\n    20% { -webkit-transform: rotate(50deg); }\n    70% { -webkit-transform: rotate(270deg); }\n    100% { -webkit-transform: rotate(360deg); }\n  }\n  ");i.appendChild(o),n.appendChild(i),t.appendChild(n)}(e,this.isRTL);else{const n=t??this.OpenWorkbookIcon;e.setAttribute("style",`display: inline-block;\n        height: 20px;\n        width: 20px;\n        background-repeat: no-repeat;\n        background-image: url("data:image/svg+xml;charset=utf8,${n}");`+this.elementsMargin)}return e}createToastTitle(t){const e=document.createElement("span");return e.id="UnavailabilityToastTitle",e.innerText=t,e.setAttribute("style","font-weight: 600;"+this.elementsMargin),e}createToastMessage(t){const e=document.createElement("span");return e.id="UnavailabilityToastText",e.innerText=t,e}constructor(t,e,n,i,o,s){this.OpenWorkbookIcon="%3Csvg%20width%3D%2220%22%20height%3D%2218%22%20viewBox%3D%220%200%2020%2018%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0D%0A%3Cpath%20d%3D%22M8.17383%207.24219C8.02409%207.48307%207.84831%207.70443%207.64648%207.90625C7.45117%208.10156%207.23307%208.27409%206.99219%208.42383L7.49023%209.63477L6.33789%2010.1035L5.83984%208.90234C5.57943%208.96745%205.29948%209%205%209C4.70052%209%204.42057%208.96745%204.16016%208.90234L3.66211%2010.1035L2.50977%209.63477L3.00781%208.42383C2.76693%208.27409%202.54557%208.10156%202.34375%207.90625C2.14844%207.70443%201.97591%207.48307%201.82617%207.24219L0.615234%207.74023L0.146484%206.58789L1.34766%206.08984C1.28255%205.82943%201.25%205.54948%201.25%205.25C1.25%204.95052%201.28255%204.67057%201.34766%204.41016L0.146484%203.91211L0.615234%202.75977L1.82617%203.25781C2.12565%202.76953%202.51953%202.37565%203.00781%202.07617L2.50977%200.865234L3.66211%200.396484L4.16016%201.59766C4.42057%201.53255%204.70052%201.5%205%201.5C5.29948%201.5%205.57943%201.53255%205.83984%201.59766L6.33789%200.396484L7.49023%200.865234L6.99219%202.07617C7.48047%202.37565%207.87435%202.76953%208.17383%203.25781L9.38477%202.75977L9.85352%203.91211L8.65234%204.41016C8.71745%204.67057%208.75%204.95052%208.75%205.25C8.75%205.54948%208.71745%205.82943%208.65234%206.08984L9.85352%206.58789L9.38477%207.74023L8.17383%207.24219ZM5%207.75C5.34505%207.75%205.66732%207.6849%205.9668%207.55469C6.27279%207.42448%206.53971%207.24544%206.76758%207.01758C6.99544%206.78971%207.17448%206.52604%207.30469%206.22656C7.4349%205.92057%207.5%205.59505%207.5%205.25C7.5%204.90495%207.4349%204.58268%207.30469%204.2832C7.17448%203.97721%206.99544%203.71029%206.76758%203.48242C6.53971%203.25456%206.27279%203.07552%205.9668%202.94531C5.66732%202.8151%205.34505%202.75%205%202.75C4.65495%202.75%204.32943%202.8151%204.02344%202.94531C3.72396%203.07552%203.46029%203.25456%203.23242%203.48242C3.00456%203.71029%202.82552%203.97721%202.69531%204.2832C2.5651%204.58268%202.5%204.90495%202.5%205.25C2.5%205.59505%202.5651%205.92057%202.69531%206.22656C2.82552%206.52604%203.00456%206.78971%203.23242%207.01758C3.46029%207.24544%203.72396%207.42448%204.02344%207.55469C4.32943%207.6849%204.65495%207.75%205%207.75ZM18.75%2012.125C18.75%2012.4831%2018.7044%2012.8444%2018.6133%2013.209L19.9512%2013.7559L19.4824%2014.918L18.1348%2014.3613C17.7507%2014.9993%2017.2428%2015.5072%2016.6113%2015.8848L17.168%2017.2227L16.0059%2017.7012L15.459%2016.3633C15.0944%2016.4544%2014.7331%2016.5%2014.375%2016.5C14.0169%2016.5%2013.6556%2016.4544%2013.291%2016.3633L12.7441%2017.7012L11.582%2017.2227L12.1387%2015.8848C11.5007%2015.5072%2010.9928%2014.9993%2010.6152%2014.3613L9.26758%2014.918L8.79883%2013.7559L10.1367%2013.209C10.0456%2012.8444%2010%2012.4831%2010%2012.125C10%2011.7669%2010.0456%2011.4056%2010.1367%2011.041L8.79883%2010.4941L9.26758%209.33203L10.6152%209.88867C10.9928%209.25716%2011.5007%208.74935%2012.1387%208.36523L11.582%207.01758L12.7441%206.54883L13.291%207.88672C13.6556%207.79557%2014.0169%207.75%2014.375%207.75C14.7331%207.75%2015.0944%207.79557%2015.459%207.88672L16.0059%206.54883L17.168%207.01758L16.6113%208.36523C17.2428%208.74935%2017.7507%209.25716%2018.1348%209.88867L19.4824%209.33203L19.9512%2010.4941L18.6133%2011.041C18.7044%2011.4056%2018.75%2011.7669%2018.75%2012.125ZM14.375%2015.25C14.8047%2015.25%2015.2083%2015.1686%2015.5859%2015.0059C15.9635%2014.8431%2016.2923%2014.6217%2016.5723%2014.3418C16.8587%2014.0553%2017.0833%2013.7233%2017.2461%2013.3457C17.4154%2012.9616%2017.5%2012.5547%2017.5%2012.125C17.5%2011.6953%2017.4154%2011.2917%2017.2461%2010.9141C17.0833%2010.5365%2016.8587%2010.2077%2016.5723%209.92773C16.2923%209.64128%2015.9635%209.41667%2015.5859%209.25391C15.2083%209.08464%2014.8047%209%2014.375%209C13.9453%209%2013.5384%209.08464%2013.1543%209.25391C12.7767%209.41667%2012.4447%209.64128%2012.1582%209.92773C11.8783%2010.2077%2011.6569%2010.5365%2011.4941%2010.9141C11.3314%2011.2917%2011.25%2011.6953%2011.25%2012.125C11.25%2012.5547%2011.3314%2012.9616%2011.4941%2013.3457C11.6569%2013.7233%2011.8783%2014.0553%2012.1582%2014.3418C12.4447%2014.6217%2012.7767%2014.8431%2013.1543%2015.0059C13.5384%2015.1686%2013.9453%2015.25%2014.375%2015.25Z%22%20fill%3D%22%23797775%22%2F%3E%0D%0A%3C%2Fsvg%3E",this.hasSpinner=s??!1,this.isRTL=i,this.elementsMargin=i?"margin-left: 8px;":"margin-right: 8px;",this.toastIconElement=this.createToastIcon(o),this.toastElement=this.createToastContainer(),this.setTitle(e),this.setMessage(n),t.appendChild(this.toastElement)}}class dt{static createInstance(t,e,n,i,o,s){return new ut(t,e,n,i,o,s)}}var ht=o(14),ft=o(799),mt=o(828);function pt(t,e){return t?e(t)?t:pt(t.parentElement,e):null}var gt=o(400);let bt;class wt{static getInstance(){return bt||(bt=new wt),bt}showToast(t,e,n,i,o,s,r,a){if(!this.isToastVisible()||a){if(this.toast)this.toast.setIcon(i,o),this.toast.setTitle(t),this.toast.setMessage(e);else{const r=document.createElement("div");r.setAttribute("style",(t=>`position: absolute;\n        display: flex;\n        z-index: 2000;\n        left: 0px;\n        right: 0px;\n        top: ${t?"40px":"8px"};\n        margin: auto;\n        align-items: center;\n        justify-content: center;\n        pointer-events: none;\n        opacity : 0;\n        transition: opacity 0.35s;\n        transition-timing-function: ease-in;`)(s)),document.body.appendChild(r),this.toast=dt.createInstance(r,t,e,n,i,o),requestAnimationFrame((()=>{r.style.opacity="1"}))}this.isToastVisible()||(this.toast.setVisibility(!0),this.isVisible=!0),this.logToastVisibilityChange(!0,r),this.displayTime=window.performance.now()}}dismissToast(t){this.isToastVisible()&&(this.toast?.setVisibility(!1),this.isVisible=!1,this.logToastVisibilityChange(!1,t),this.displayTime=void 0)}isToastVisible(){return(0,gt.isChangeGateEnabled)("SharedOnline.ChangeGate.IsToastVisibleModified")?this.isVisible||"visible"===document.getElementById(lt)?.style.visibility&&!pt(document.getElementById(lt),(t=>"none"===getComputedStyle(t).display)):this.isVisible||"visible"===document.getElementById(lt)?.style.visibility}logToastVisibilityChange(t,e){let n="Unavailability Toast Visibility Changed: "+(t?"Shown":"Dismissed");!t&&this.displayTime&&(n+=`, Duration Visible: ${Math.trunc(window.performance.now()-this.displayTime)}`),e&&(n+=`, Kind: ${e}`),ht.Hv.sendTraceTag(537249949,ft.n.msoulscat_Wac_Telemetry,mt.k.Info,n)}constructor(){this.toast=void 0,this.isVisible=!1}}class vt{static showToast(t,e){this.toastDismissed||wt.getInstance().showToast(e,"",t,void 0,void 0,!0,"DocumentCache")}static dismissToast(){this.toastDismissed=!0,wt.getInstance().dismissToast("DocumentCache"),S("dismissToastTriggered",vt.DOCUMENTCACHETOASTMANAGER_LOG_CATEGORY)}}vt.toastDismissed=!1,vt.DOCUMENTCACHETOASTMANAGER_LOG_CATEGORY="DocumentCacheToast";class St{isSupported(){try{const t="__storage_test__";return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&localStorage&&0!==localStorage.length}}getDocumentCacheItem(t){const e=localStorage.getItem(t);return e?JSON.parse(e):null}saveDocumentCacheItem(t,e){if(!e)return!1;const n=JSON.stringify(e);return localStorage.setItem(t,n),!0}removeDocumentCacheItem(t){localStorage.removeItem(t)}clearBrowserCache(){let t=0;const e=Object.keys(localStorage);for(let n=0;n<e.length;n++){const i=e[n];i.startsWith(St.KEY_PREFIX)&&(localStorage.removeItem(i),t++)}return t}getItemsInCache(){const t=[],e=Object.keys(localStorage);for(let n=0;n<e.length;n++){const i=e[n];if(i.startsWith(St.KEY_PREFIX)){const e=this.getDocumentCacheItem(i);e&&t.push({key:i,item:e})}}return t}getKeysInCache(){const t=[],e=Object.keys(localStorage);for(let n=0;n<e.length;n++){const i=e[n];i.startsWith(St.KEY_PREFIX)&&t.push(i)}return t}getCacheKey(t){if(!t)throw new Error("documentId is an empty string");return St.KEY_PREFIX+t}}St.KEY_PREFIX="WordCachedDoc_";class Ct{isSupported(){return!0}getDocumentCacheItem(t){const e=localStorage.getItem(t);return JSON.parse(e)}saveDocumentCacheItem(t,e){const n=new st("test",1633560587,"1.0",!1,5,!1,0,!1),i=JSON.stringify(n);return localStorage.setItem(t,i),!0}removeDocumentCacheItem(t){localStorage.removeItem(t)}clearBrowserCache(){return 0}getItemsInCache(){return[]}getKeysInCache(){return[]}getCacheKey(t){return"WordCachedDoc_"+t}}function yt(t){if(/apple/i.test(navigator.vendor))return!1;try{const e=localStorage?.getItem("copilotChatPaneAutoOpen");if(!e)return!1;const n=JSON.parse(e),i=t.CreateNewBlankDoc;return n?.autoOpenSupported&&!n?.autoOpened&&"true"!==i}catch{return!1}}function _t(t,e){if(t&&e){const e=Math.floor(Math.abs(Math.max(t/100*window.innerWidth,320)));return Math.min(920,e)}return 320}o(949);class kt{launchFastView(t,e,n=!1,i=!1,o=!1,s=0,r=(t=>{})){if(S("Launching FastView from entry point "+e,"BootLogs"),this.appearance.editable=n,this.fastBootEnabled&&!d.fastView&&!document.getElementById("PageContentContainer")){let n;const a=document.getElementById("canvasWrap");if(null!=a&&this.appearance.cssPositionRewriteIsEnabled)n=a;else{const t=this.appearance.renderFastViewOnSkeletalUXIsEnabled&&i?"SkeletalCanvas":"WACInnerFrame";n=document.getElementById(t)}d.fastView=new et((()=>document.getElementById("AppHeaderPanel")),(()=>document.getElementById("WACRibbonPanel")),(()=>n),this.appearance,e,_.getCookie,i,o,s,r);try{return d.fastView.open(t)}catch(t){return d.fastBootError="FastView open failed: "+t.message+"\r\n"+t.stack,!1}}return!1}static getSlice0(){if(null!=kt.slice0Name&&kt.slice0Name.length>0){const t=document.createElement("script");t.type="text/javascript",t.src=kt.slice0Name,document.getElementsByTagName("head")[0].appendChild(t)}}static isReactMultilineRibbonVisible(t){const e=kt.userHasMLRPreference(t);return"true"===t.ReactMultilineRibbonIsEnabled&&("true"===e||"false"===_.getCookie(t.IsSimplifiedRibbonOnCookieName).toLowerCase()||kt.defaultMLRIsEnabled(t))}static isBootingToTabsOnly(t){const e=_.getCookie(t.ReactShyRibbonPreferenceCookieName).toLowerCase(),n="true"===t.ResponsiveUxIsEnabled,i="true"===t.NewSkeletalUXExperienceEnabled;if(n&&i)return window.ShouldHideBottomBarAtBoot;const o=n&&(window.ShouldHideBottomBarAtBoot||"true"===e||(""===e||"undefined"===e)&&kt.getIsDocumentBelowTabsOnlyThreshold(t));return window.ShouldHideBottomBarAtBoot=o,o}static getIsDocumentBelowTabsOnlyThreshold(t){const e=window.innerHeight,n=window.innerWidth,i=e*n,o=i-("true"===t.HideHeaderEmbedded?0:48*n)-24*n-(36+(kt.isReactMultilineRibbonVisible(t)?100:40))*n;let s=parseFloat(t.ResponsiveUxBreakpoint);return s=isNaN(s)?.67:s,o/i<s}static isDarkModePreferenceOn(t){return"true"===t.WordDarkModeIsEnabled&&"true"===t.DarkModeIsOn}static defaultMLRIsEnabled(t){return"true"===M("IsO365ConsumerHost","")&&""===_.getCookie(t.ReactRibbonMLRPreferenceCookieName).toLowerCase()&&window.innerWidth>=1024&&window.innerHeight>=600}static userHasMLRPreference(t){return _.getCookie(t.ReactRibbonMLRPreferenceCookieName).toLowerCase()}constructor(t,e,n,i,s,r){T(s);const a=t=>"true"===s[t]||"True"===s[t],c=(F("AppChromeOverrideEnabled")?M("AppChromeBaseScriptUrlOverride",""):M("StaticContentUrl",""))+(a("IsWebpack5RibbonEnabled")?"wp5/":"");o.p=c;const l=parseFloat(s.DefaultCopilotPaneWidthPercent);this.fastBootEnabled=a("FastBoot"),kt.slice0Name=s.Slice0Name,this.appearance={positionAbsolute:!a("OneNoteCssPositionRewriteIsEnabled"),showRibbon:!a("HideRibbonEmbedded"),ribbonExpandedByDefault:t,ribbonPreferenceCookieName:s.RibbonPreferenceCookieNameHint,showRibbonImage:e,ribbonImageBase:s.RibbonImageBase,shouldStretchPageToBottom:n,appBrandedName:s.BrandedWebAppName,showRibbonHeader:!a("HideHeaderEmbedded"),showNavPane:i&&!a("ONHideNavEmbedded"),showNavSections:!a("ONHideSectionsEmbedded"),editable:!1,pasteLoadingUI:a("PasteInBootLoadingUIIsEnabled"),loadingUIGif:s.ProgressGifResource,simplifiedReactRibbonUxIsEnabled:!0,simplifiedReactRibbonAnimationIsEnabled:xt(s),skeletalBootUXIsEnabled:a("OneNoteSkeletalBootUXIsEnabled"),snackbarNavPaneIsEnabled:a("SnackbarNavPaneIsEnabled"),twoPaneNavIsEnabled:a("OneNoteTwoPaneNavPaneIsEnabled"),reactSharedHeaderIsEnabled:a("ReactSharedHeaderIsEnabled"),headerAppLauncherIsHidden:a("AppLauncherIsHidden"),headerBackgroundColorOverride:decodeURIComponent(_.getCookie("ThemedHeaderBackgroundColor")),headerTextColorOverride:decodeURIComponent(_.getCookie("ThemedHeaderTextColor")),cssPositionRewriteIsEnabled:a("OneNoteCssPositionRewriteIsEnabled"),wordIsSkeletalDeepLinkOn:a("WordIsSkeletalDeepLinkOn"),isDeepLinkScenario:a("IsDeepLinkScenario"),reactMultiLineRibbonIsVisible:kt.isReactMultilineRibbonVisible(s),renderFastViewOnSkeletalUXIsEnabled:a("OneNoteRenderFastViewOnSkeletalIsEnabled"),isRegionComposerShown:!!r,appColorUpdateIsEnabled:a("AppColorUpdateIsEnabled"),isRtl:a("Rtl"),showHeaderPlaceholder:a("ShowHeaderPlaceholder"),darkModeEnabled:kt.isDarkModePreferenceOn(s),isOneNoteCanvasZoomEnabled:!1,currentZoomLevel:1,isOneNoteMobileViewerNavigationEnabled:a("OneNoteMobileViewerNavigationIsEnabled"),isBrowserSideCacheEnabled:a("IsBrowserSideCacheEnabled"),fixRemoveKeypressEventListenerInFastView:a("FixRemoveKeypressEventListenerInFastView"),fluent2StylesEnabled:a("Fluent2StyleIsEnabled"),bootToTabsOnly:kt.isBootingToTabsOnly(s),isNewSkeletalUXExperienceEnabled:a("NewSkeletalUXExperienceEnabled"),commentUXRefreshEnabled:a("CommentUXRefreshEnabled"),isInnerHTMLOfficeBootPolicyEnabled:a("IsInnerHTMLOfficeBootPolicyEnabled"),showSkeletalTaskPane:a("WordIsSkeletalTaskPaneOn")&&yt(s),defaultCopilotChatPaneWidth:_t(isNaN(l)?0:l,a("HideCopilotTaskPaneHeader"))}}}function xt(t){return"true"===t.OneLineRibbonAnimationIsEnabled}class Rt{constructor(t,e,n=!1,i=1){this.pageHtml=t,this.editable=e,this.hasUnresolvedComments=n,this.numSections=i}}function At(t,e,n,i){return{baseDocId:t.BaseDocId,documentCacheItemSchemaVersion:t.DocumentCacheItemSchemaVersion,fastBootEnabled:"true"===t.FastBoot,getCachedSSR:"true"===t.GetCachedSSR,getCellsVersion:parseInt(t.GetCellsVersion,10),isRunAcquireLockInitLocalCobaltInBackgroundEnabled:"true"===t.IsRunAcquireLockInitLocalCobaltInBackgroundEnabled,isGetCellsRefactorAcquireLockInfoEnabled:"true"===t.GetCellsRefactorAcquireLockInfo,isGetCellsRefactorSaveDocumentStreamEnabled:"true"===t.GetCellsRefactorSaveDocumentStream,indexedDBPageTargetKey:"",initParagraphId:parseInt(t.InitialParaId,16),isIndexedDBEnabled:"true"===t.OneNoteIndexedDbCacheIsEnabled,isIndexedDBDefaultPageEnabled:"true"===t.OneNoteIndexedDBCacheDefaultPageIsEnabled,isOneNoteQuickloadCacheLocalStorageEnabled:"true"===t.OneNoteQuickloadCacheLocalStorageIsEnabled,isNewFile:"true"===t.CreateNew,isOneNoteHierarchySyncOnBootEnabled:"true"===t.OneNoteHierarchySyncIsEnabled,isOneNoteSyncConnectOnBootEnabled:"true"===t.OneNoteSyncConnectOnBootEnabled,isOneNoteSyncHeartBeatEnabled:"true"===t.OneNoteSyncHeartBeatIsEnabled,isOneNoteSyncHeartBeatNoShutdownEnabled:"true"===t.OneNoteSyncHeartBeatNoShutdownEnabled,isOneNoteAddUUIDForGetCellsEnabled:"true"===t.OneNoteAddUUIDForGetCellsIsEnabled,isOneNoteConvergedStackParsingEnabled:"true"===t.OneNoteConvergedStackParsing,isUserCreatingPersonalNotebookFirstTime:"true"===t.IsUserCreatingPersonalNotebookFirstTime,isRemoveSsrEnabled:"true"===t.IsRemoveSsrEnabled,IsBrowserSideCacheEnabled:"true"===t.IsBrowserSideCacheEnabled,isRemoveSsrEnabledForDarkMode:kt.isDarkModePreferenceOn(t),oneNoteShouldSendQuerySignatureOnSocketSetup:"true"===t.OneNoteShouldSendQuerySignatureOnSocketSetup,contentSyncVersion:parseInt(t.OneNoteContentSyncVersion,10),optimizedForNewFile:n,pageTarget:t.PageTarget,pageTargetHtml:t.PageTargetHtml,requestOptions:Pt(t,e,i),sessionStartJson:t.SessionStartInfoJson??"UNKNOWN",skipPageHtmlInGetCellsResponse:"true"===t.SkipPageHtmlInGetCellsResponse,slice0Name:t.Slice0Name,syncHeartBeatSendInterval:parseInt(t.OneNoteSyncHeartBeatSendIntervalMs,10),syncHeartBeatWaitInterval:parseInt(t.OneNoteSyncHeartBeatWaitIntervalMs,10),channelOutboundTimeoutInterval:parseInt(t.OneNoteSyncChannelOutboundTimeoutIntervalMs,10),userId:t.UserId,useLoadAsync:parseInt(t.UseLoadAsync,10)}}function Pt(t,e,n){return{accessToken:n?n.AccessToken:t.AccessToken,accessTokenTtl:n?n.AccessTokenTtl:"",applicationModeExtended:t.SessionStartInfoJson?JSON.parse(t.SessionStartInfoJson).ApplicationModeExtended:"UNKNOWN",buildVersion:t.BuildVersion,canary:t.Canary,feMachineId:t.FEMachineId,onenoteSyncEndpoint:t.ONOnlineSyncEndpoint,pageTarget:t.PageTarget,renderingMode:t.AddServerSideRenderingHeader,requestHeadMode:e,rootQuerySignature:t.RootQuerySignature,sessionOrigin:t.SessionOrigin?t.SessionOrigin:"UNKNOWN",url:t.WebServiceBase,userSessionId:t.SessionId,userType:t.UserType,wacCluster:t.WacCluster,wacUserAgent:t.WacUserAgent}}const It="InitialRequestEnd",Et="InitialResponseProcessStart",Wt="InitialResponseProcessEnd";var Lt;!function(t){t.GetCells="GetCells",t.RenderPage="RenderPage",t.SessionStart="SessionStart"}(Lt||(Lt={}));class Ot{dispose(){this.At?.()}shouldDisableSSR(){return this.Pt.isRemoveSsrEnabled||this.Pt.isRemoveSsrEnabledForDarkMode||this.Pt.IsBrowserSideCacheEnabled}makeGetCellsRequest(t,e){S("Making GetCells Request","BootLogs"),d.initialParaId=this.Pt.initParagraphId||0;const n=JSON.stringify(window.location.href);let i=',"SearchQuery":null,"IsNewFile":'+(this.Pt.isNewFile&&this.Pt.optimizedForNewFile).toString()+',"InitialParaId":'+d.initialParaId+',"RequestUrl":'+n+',"SkipPageHtmlInResponse":'+this.Pt.skipPageHtmlInGetCellsResponse.toString();this.Pt.sessionStartJson&&(i=i+',"SessionStartInfoJson":'+JSON.stringify(this.Pt.sessionStartJson));const o=Dt(1,i,this.Pt.requestOptions,{IsRemoveSsrEnabled:this.shouldDisableSSR(),GetCellsVersion:this.Pt.getCellsVersion,IsRunAcquireLockInitLocalCobaltInBackgroundEnabled:this.Pt.isRunAcquireLockInitLocalCobaltInBackgroundEnabled,IsGetCellsRefactorAcquireLockInfoEnabled:this.Pt.isGetCellsRefactorAcquireLockInfoEnabled,IsGetCellsRefactorSaveDocumentStreamEnabled:this.Pt.isGetCellsRefactorSaveDocumentStreamEnabled,UseNativeJsonTypes:20===this.Pt.useLoadAsync});return Tt(this.Pt.requestOptions.url+"OneNote.ashx"+(e?"?perfTag=GetCells_1&GetCellsBootstrapper=1":""),o,this.Pt,t,Ft,Lt.GetCells)}makeRenderPageRequest(t){if(this.Pt.isNewFile&&this.Pt.optimizedForNewFile)return;const e=Dt(46,"",this.Pt.requestOptions,t);Tt(this.Pt.requestOptions.url+"OneNote.ashx?IsRenderPage=1",e,this.Pt,this.It,(()=>{}),Lt.RenderPage)}makeStartSessionRequest(t,e){Tt(this.Pt.requestOptions.url+t,"",this.Pt,e,(()=>{}),Lt.SessionStart)}constructor(t,e){this.enableMetricLoggingCookieName="EnableMetricLogging",this.onGetCellsRequestCompleted=t=>{if(S("Get cells response received:"+t.status,"BootLogs"),!u.g_initialRequestCompleted){if(Mt(t.responseText,!1),!d.fastView&&!this.shouldDisableSSR()){const t=function(t){if(t&&t.Responses[0]&&t.Responses[0][1]&&t.Responses[0][1].Cells){const e=t.Responses[0][1].Cells;for(let t=0;t<e.length;t+=1){const n=e[t];if(n&&n.PageHtml)return new Rt(n.PageHtml,!!n.IsPageHtmlEditable,!!n.HasUnresolvedComments,n.NumSections)}}}(u.g_initialRequestResponseObject);t&&t.pageHtml&&this.Et&&this.Et.launchFastView(t.pageHtml,"WacBootGetCells",t.editable,!1,t.hasUnresolvedComments,t.numSections)}u.g_fastViewOpenTime=new Date}},this.onInitialResponseReady=()=>{u.g_onInitialResponseReady&&u.g_onInitialResponseReady()},this.It=t=>{const e=t.responseText;if(d.fastView)return;const n=function(t){const e=Nt(t);if(e&&e.Responses[0]&&e.Responses[0][1]&&e.Responses[0][1].Html)return e.Responses[0][1].Html}(e);n&&this.Et&&this.Et.launchFastView(n,"WacBootRenderPage")},this.Et=t,this.Pt=e,u.g_useLoadAsync=this.Pt.useLoadAsync,(window.location?.search?.match(/wdpa=1/gi)||"1"===_.getCookie(this.enableMetricLoggingCookieName))&&o.e(585).then(o.bind(o,789)).then((t=>{this.At=t.subscribeToMetricLogging(),t.subscribeToInteractivityMetricsLogging()}),(()=>{}))}}function Dt(t,e,n,i){let o=JSON.stringify(n.rootQuerySignature);o&&(o=o.substring(1,o.length-1));let s=JSON.stringify(n.pageTarget);s&&(s=s.substring(1,s.length-1));const r='{"Mode":'+n.requestHeadMode+',"srs":[[';let a=',{"FileId":"'+o+'","PageTarget":"'+s+'","OperationId":1';for(const t in i)a+=',"'+t+'":'+i[t];return r+t+a+e+"}]]}"}function Tt(t,e,n,i,o,s){let r=new XMLHttpRequest;const a={};r.onreadystatechange=()=>{if(r&&4===r.readyState){if(void 0===r.status||0===r.status)try{S(s+" response status is empty or undefined","BootLogs")}finally{return}try{i&&i(r)}finally{null!=r&&(r.onreadystatechange=()=>{},r=void 0)}}},r.open("Post",t,!0),function(t,e){const n=e.requestOptions;if(t["X-xhr"]="1",n.userSessionId&&(t["X-UserSessionId"]=n.userSessionId),n.buildVersion&&(t["X-OfficeVersion"]=n.buildVersion),t["Content-Type"]="application/json; charset=utf-8",n.canary&&(t["X-Key"]=n.canary),n.accessToken&&(t["X-AccessToken"]=n.accessToken),n.accessTokenTtl&&(t["X-AccessTokenTtl"]=n.accessTokenTtl),n.userType&&(t["X-UserType"]=n.userType),n.wacCluster&&(t["X-WacCluster"]=n.wacCluster),n.wacUserAgent&&(t["X-WacUserAgent"]=n.wacUserAgent),n.renderingMode&&(t["X-ServerSideRendering"]=n.renderingMode),n.feMachineId&&(t["X-FEMachineId"]=n.feMachineId),e.sessionStartJson&&(t["X-SessionStartDimensions"]=function(t){if(!t||"UNKNOWN"===t)return t;const e={},n=JSON.parse(t);return e.Application=n.Application,e.ApplicationVersion=n.ApplicationVersion,e.Browser=n.Browser,e.BrowserMajorVersion=n.BrowserMajorVersion,e.BrowserVersion=n.BrowserVersion,e.Host=n.Host,e.IsSynthetic=n.IsSynthetic,e.Os=n.Os,e.Ring=n.Ring,e.RoutedVia=n.RoutedVia,e.SessionOrigin=n.SessionOrigin,e.UiHost=n.UiHost,e.UserSessionApplicationMode=n.UserSessionApplicationMode,e.WACDatacenter=n.WACDatacenter,JSON.stringify(e)}(e.sessionStartJson)),e.isOneNoteAddUUIDForGetCellsEnabled){const e="10000000-1000-4000-8000-100000000000".replace(/[018]/g,(t=>(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)));u.g_getCellsUuid=e,t["X-GetCellsUUID"]=e}t["X-Requested-With"]="XMLHttpRequest",window.location.href.indexOf("wdnetcorerouting=true")>-1?t["X-NetCoreRouting"]="true":window.location.href.indexOf("wdnetcorerouting=false")>-1&&(t["X-NetCoreRouting"]="false")}(a,n);for(const t in a)r.setRequestHeader(t,a[t]);let c=e;return e||(c=""),o(),r.send(c),r}function Ft(){u.g_initialRequestInvokedTime=new Date,u.g_initialRequestMade=!0,H("InitialRequestStart")}function Mt(t,e){u.g_getCellsFromFrameRequest=e,u.g_initialRequestCompleted=!0,u.g_initialResponseTime=new Date,H(It),H(Et),j("InitialRequest","InitialRequestStart",It);const n=Nt(t);if(u.g_initialRequestResponseObject=n,n&&n.Responses&&n.Responses[0]&&n.Responses[0][1]){const t=n.Responses[0][1];u.g_acquireLockStartTime=t.AcquireLockStartTime,u.g_acquireLockEndTime=t.AcquireLockEndTime,u.g_acquireLockRequestStatus=t.AcquireLockRequestStatus,u.g_getDocumentStartTime=t.GetDocumentStartTime,u.g_getDocumentEndTime=t.GetDocumentEndTime,u.g_getDocumentRequestStatus=t.GetDocumentrequestStatus,u.g_getCellsStartTime=t.GetCellsStartTime,u.g_getCellsEndTime=t.GetCellsEndTime,u.g_getInitializeLocalCobaltStartTime=t.InitializeLocalCobaltStartTime,u.g_getInitializeLocalCobaltEndTime=t.InitializeLocalCobaltEndTime}u.g_initialResponseReadyTime=new Date,H(Wt),j("InitialResponseProcess",Et,Wt)}function Nt(t){try{return JSON.parse(t)}catch(t){d.fastBootError="JSON.parse failed: "+t.message+"\r\n"+t.stack}}function Bt(){const t=window.performance;return t&&t.timeOrigin?t.timeOrigin:t&&t.timing&&t.timing.navigationStart?t.timing.navigationStart:0}function $t(){const t=window.performance;return t&&t.now?t.now():(new Date).getDate()-Bt()}function Vt(){const t=window.performance;return t&&t.now?Bt()+t.now():(new Date).getDate()}function Ut(t){return Bt()+t}Ot.getCellsFromFrameRequest=t=>{u.g_initialRequestCompleted||(Mt(t,!0),u.g_fastViewOpenTime=new Date)};const Ht="wacPerfObserver";function jt(t,e){void 0===window[Ht]&&(window[Ht]={}),window[Ht][t]=e}function zt(t){t.disconnect(),jt("timeOrigin",Bt()),"function"==typeof window.CustomEvent&&window.dispatchEvent(new CustomEvent("WacStableInteractive",window[Ht]))}function Gt(t){const e=document.getElementById("WACFastView"),n=e.querySelector(".WACViewPanel"),i=e.querySelector(".PaginatedContentContainer"),o=e.querySelector(".PagesContainer");i&&(i.style.minHeight="0",i.style.left="-140px"),n&&(n.style.overflow="hidden");const s=document.createElement("div");return s.id="SkeletalPage",s.className=s.id,s.style.position="absolute",s.style.width="100%",s.style.height="100%",s.style.left="0px",s.style.right="0",s.style.top="19px",s.style.zIndex="1",s.appendChild(function(t){const e=document.createElement("div");e.id="SkeletalCanvas",e.className=e.id,e.style.width="auto",e.style.height="100%",e.style.overflow="hidden",e.style.position="relative",e.style.padding="96px";const n=document.getElementById("WACFastView").querySelector(".OutlineContent"),i=document.createElement("div");i.style.width="100%",i.style.height="100%",i.style.boxSizing="border-box",n&&(i.style.paddingLeft=n.style.paddingLeft,i.style.paddingRight=n.style.paddingRight,i.style.paddingTop=n.style.paddingTop);const o=[];for(let e=0;e<2;e+=1)o[e]=document.createElement("div"),o[e].style.backgroundColor=t,o[e].style.height="18px",o[e].style.marginBottom="16px";o[0].style.width="150px",o[1].style.width="220px";const s=[];for(let e=0;e<21;e+=1)s[e]=document.createElement("div"),s[e].style.backgroundColor=t,s[e].style.height="14px",s[e].style.marginBottom="6px";s[0].style.width="92%",s[1].style.width="100%",s[2].style.width="93%",s[3].style.width="80%",s[3].style.marginBottom="16px",s[4].style.width="92%",s[5].style.width="100%",s[6].style.width="55%",s[6].style.marginBottom="16px",s[7].style.width="95%",s[8].style.width="38%",s[8].style.marginBottom="26px",s[9].style.width="90%",s[10].style.width="100%",s[11].style.width="98%",s[12].style.width="100%",s[13].style.width="33%",s[13].style.marginBottom="16px",s[14].style.width="91%",s[15].style.width="90%",s[16].style.width="100%",s[17].style.width="85%",s[17].style.marginBottom="40px",s[18].style.width="92%",s[19].style.width="100%",s[20].style.width="93%",i.appendChild(o[0]);for(let t=0;t<=17;t+=1)i.appendChild(s[t]);i.appendChild(o[1]);for(let t=18;t<=19;t+=1)i.appendChild(s[t]);return e.appendChild(i),e}(t)),o&&(o.style.overflow="visible",o.appendChild(s)),{isReady:!1,element:s}}const qt="stable-interactivity",Jt="first-input",Kt="first-interaction",Xt="first-idle",Qt="visually-ready",Yt="functionally-ready",Zt="visually-perceived";function te(t){return t===Qt||t===Yt||t===Zt}function ee(t,e){for(const n in t)if(!t[n].states[e]?.final)return!1;return!0}function ne(t,e){return e&&t&&te(e)&&t.states[e]}const ie="Wac-SubComponentsInit",oe="Wac-SubComponentSetLoadState",se="Wac-AppLoadTrace",re=(t,e)=>{try{const n=new CustomEvent(t,{detail:e});self.dispatchEvent(n)}catch(t){ce(mt.k.Error,"dispatchRumShepherdEvent failed with exception:",t)}};let ae=[];function ce(t,e,n,i){const o=`[rum:${Number($t().toFixed())}]${e} ${n?JSON.stringify(n):""}`;ae.push({level:t,message:o}),i&&function(){const t={traces:[...ae]};ae=[],re(se,t)}()}function le(t){return t?{...t}:{}}function ue(t){const e=[];for(const n in t){const i=t[n];e.push({id:i.id,rootElementId:i.rootElementId,subComponents:he(i.subComponents)})}return e}function de(t){const e=[];for(const n in t){const i=t[n];e.push({id:i.id,rootElementId:i.rootElementId,subComponents:fe(i.subComponents)})}return e}function he(t){const e=[];for(const n in t){const i=t[n];i.nonReporting||e.push({id:i.id,initTime:Ut(i.initTime),optional:i.optional,unused:i.unused,nonReporting:i.nonReporting,states:me(i.states)})}return e}function fe(t){const e=[];for(const n in t){const i=t[n];i.nonReporting&&e.push({id:i.id,initTime:Ut(i.initTime),optional:i.optional,unused:i.unused,nonReporting:i.nonReporting,states:me(i.states)})}return e}function me(t){const e={};for(const n in t){const i=t[n];i?.time&&(e[n]=Ut(i.time))}return e}function pe(t,e){const n=t.subComponents;for(const t in n){const i=n[t];if(!(i.states[e]||i.unused||i.nonReporting))return!1}return!0}function ge(t){let e=Number.POSITIVE_INFINITY;for(const n in t.subComponents){const i=t.subComponents[n];e=Math.min(e,i.initTime)}return e}function be(t,e,n){if(!t||!e)return!1;const i=t.subComponents;for(const t in i)if(!we(i[t],e,n))return!1;return!0}function we(t,e,n){if(!t)return!1;const i=t.states[e];return n?t.optional&&!i?.time||i?.time&&i.promotedFromPreviousState:t.optional||i?.time&&i.promotedFromPreviousState}function ve(t,e){return e===Qt&&ne(t,Zt)}function Se(t,e){return{start:t.start,time:e??t.time,error:t.error,monitor:t.monitor,measures:le(t.measures),data:le(t.data)}}function Ce(t,e,n,i){"then"in t?t.then((t=>{i(t)})).catch((t=>{const o=`Error in invokeMonitor [${n}}]`;ce(mt.k.Error,o,t),i({start:e,time:e,monitor:"",error:`${o}: ${t}`})})):i(t)}class ye{getBooleanSetting(t,e){const n=this.Wt[t];if(!n)return e;switch(n.trim().toLowerCase()){case"true":return!0;case"false":return!1;default:return e}}getStringSetting(t,e){return this.Wt[t]||e}constructor(t){this.Wt=t??{}}}class _e{get timeout(){return this.timeoutInMs}get reason(){return this.Lt}set onCancelled(t){this.Ot=t}constructor(t){this.timeoutInMs=t,this.Lt="",this.Dt=t=>{this.Lt||(this.Lt=t?"timeout":"cancelled",this.Ot&&this.Ot())},this.cancel=()=>{this.Dt(!1)},t>0&&window.setTimeout((()=>this.Dt(!0)),t)}}function ke(t){return new _e(t??0)}class xe{get tabHideTime(){return this.Tt}get metrics(){return this.Ft}startMonitors(t,e){ce(mt.k.Verbose,"startMonitors",{appState:t});const n=(t,n)=>{if(ce(mt.k.Verbose,"onCompleteWithInputCheck",{metric:t}),n){if(!n.error){const t=this.Ft[Jt]?this.Ft[Jt].time:0,e=this.Ft[Kt]?this.Ft[Kt].time:0;t>0&&t<n.time&&(0===e||t<=e)&&(n.error="first-input"),e>0&&e<n.time&&(n.error="first-interaction")}e(t,n)}};t===Qt&&(this.monitorMetric(Jt,e),this.monitorMetric(Kt,e),this.monitorMetric(Xt,n),this.monitorMetric(qt,n,12e4))}cancelMonitors(t){if(t!==Qt)return;ce(mt.k.Info,"cancelAppStateMonitors",t);const e=t=>{this.Mt[t]?.cancel(),this.Mt[t]=void 0,this.Ft[t]=void 0};e(qt),e(Xt)}monitorMetric(t,e,n){if(ce(mt.k.Verbose,"monitorMetric",t),this.Mt[t])return void ce(mt.k.Verbose,"monitorMetric:already-running",t);const i=ke(n);this.Mt[t]=i;const o=$t();Ce((0,this.Nt.monitors[t])(o,i),o,t,(n=>{ce(mt.k.Verbose,"monitorMetric:complete",t),e(t,n)}))}constructor(t){this.Ft={},this.Mt={},this.Tt=0,this.Nt=t,function(t){let e="hidden"===document.visibilityState?0:1/0;t(e),document.addEventListener("visibilitychange",(n=>{e=Math.min(e,n.timeStamp),t(e)}),{once:!0})}((t=>this.Tt=t))}}function Re(t,e,n,i,o){o&&e.nonReporting||(t.states[n]={result:Se(i),monitoring:void 0,final:pe(t,n)})}class Ae{ProcessUnusedComponentFinal(t){for(const e in t.states){const n=e,i=t.states[n];!i.final&&pe(t,n)&&(ce(mt.k.Verbose,"processSubComponentUnused:unused-final",{component:t.id,state:n}),i.final=!0,this.Bt(n))}}addSubComponents(t){if(!(t&&t.component&&t.subComponents))return void ce(mt.k.Error,"Invalid data",t);const e=this.$t[t.component];if(!e)return void ce(mt.k.Error,"Invalid component",t);const n=e.ignoreNewSubComponents;if(function(t){for(const e in t.states)if(t.states[e].final)return!1;return!0}(e)||n){ce(mt.k.Verbose,"addSubComponents",{ignore:n,data:t});try{const i=Array.isArray(t.subComponents)?t.subComponents:[t.subComponents];for(let t=0;t<i.length;t+=1)this.Vt(e,i[t],n,!1,!1);if(t.optionalSubComponents)for(let i=0;i<t.optionalSubComponents.length;i+=1)this.Vt(e,t.optionalSubComponents[i],n,!0,!1);if(t.nonReportingSubComponents)for(let i=0;i<t.nonReportingSubComponents.length;i+=1)this.Vt(e,t.nonReportingSubComponents[i],n,!0,!0)}catch(t){ce(mt.k.Error,"addSubComponents",t)}}else ce(mt.k.Error,"Component cannot be modified",t)}setSubComponentState(t){const e=$t();if(!(t&&t.subComponent&&t.component&&t.state))return void ce(mt.k.Error,"Invalid data",t);const n=this.$t[t.component];if(!n)return void ce(mt.k.Error,"Invalid component",t);if(n.ignoredSubComponents[t.subComponent])return;n.ignoreNewSubComponents=n.ignoreNewSubComponents||!!t.ignoreNewSubComponents;const i=n.subComponents[t.subComponent];if(!i)return void ce(mt.k.Error,"Unexpected sub-component",t);if("unused"===t.state)return void this.Ut(n,i);const o=t.state;if(!te(o))return void ce(mt.k.Error,"Unknown state reported",t);if(n.states[o]?.final)return void ce(mt.k.Error,"Component state final. Can't set",t);if(i.unused||i.states[o])return void ce(mt.k.Error,"SubComponent unused or set",t);const s=t.promoteStateFrom;s?this.Ht(n,i,o,e,s):this.Ht(n,i,o,e)}get components(){return this.$t}get metrics(){return this.jt.metrics}constructor(t){this.$t={},this.zt={},this.Gt=t=>{if(this.zt[t])return!1;const e=ee(this.$t,t);return ce(mt.k.Verbose,"canAppStateMetricBeReported:metric-final:",{metric:t,isFinal:e}),e},this.qt=t=>{if(t===qt||t===Xt){const e=this.jt.metrics[t],n=ee(this.$t,Qt);return ce(mt.k.Verbose,"canMonitorMetricBeReported:si-error:",{metric:t,error:e?.error,vrStateFinal:n}),!!e&&"cancelled"!==e.error&&n}return!0},this.Jt=t=>{const e=this.zt[t],n=this.qt(t);!e&&n?this.Kt(t):ce(mt.k.Info,"reportMonitorMetricIfReady:not-ready",{metric:t,isReported:e,canMetricBeReported:n})},this.Bt=t=>{this.Gt(t)&&this.Kt(t)},this.Kt=t=>{try{const e=this.jt.metrics[t];""!==e.monitor&&void 0!==e.monitor||(e.monitor=this.Xt);const n={metric:t,timeOrigin:this.Qt,time:e.time,error:e.error||(this.jt.tabHideTime<e.time?"tab-switch":void 0),monitor:e.monitor,measures:le(e.measures),data:le(e.data),auxMetrics:[],componentsData:ue(this.$t),nonReportingComponentData:de(this.$t)},i=n.measures;if(i.tabsSwitch=this.jt.tabHideTime<e.time?this.jt.tabHideTime:0,i.start=e.start,i.reportedTime=$t(),t===qt){const t=this.jt.metrics[Qt];i[Qt]=t?t.time:0;const e=this.jt.metrics[Yt];i[Yt]=e?e.time:0}if(te(t)){for(const e in this.$t){const o=this.$t[e];if(!o)continue;const s=o.states[t].result;if(!s)continue;i[e]=s.time,n.error=n.error||s.error;const r={metric:`${t}-${e}`,time:s.time,monitor:s.monitor,error:s.error,measures:le(s.measures)};r.measures.start=s.start,r.measures.init=ge(o),n.auxMetrics.push(r)}const e=this.jt.metrics[qt];e&&e.error&&"cancelled"!==e.error&&!n.error&&(n.error="si-error")}this.Nt.appLoadMetricReportCallback&&(this.zt[t]=!0,ce(mt.k.Info,"reportMetric:reporting",t,!0),this.Nt.appLoadMetricReportCallback(n))}catch(t){ce(mt.k.Error,"reportMetric:error",t)}},this.Yt=()=>{const t={time:Vt(),allMetricsReported:(e=this.zt,!!(e[Qt]&&e[Yt]&&e[qt]&&e[Jt]&&e[Kt]&&e[Xt])),metrics:this.jt.metrics,components:ue(this.$t),timeOrigin:Bt()};var e;this.Nt.appLoadStateLoggingCallback(t)},this.Ht=(t,e,n,i,o)=>{if(ne(e,o)){const t=e.states[o];e.states[n]={time:t.time,promotedFromPreviousState:!0}}else e.states[n]={time:i,promotedFromPreviousState:!1};if(ce(mt.k.Verbose,"processSubComponentState",{component:t.id,subComponent:e.id,state:n}),!function(t,e){const n=t.subComponents;for(const t in n){const i=n[t].states[e];if(!(i?.time||n[t].optional||ve(n[t],e)))return!1}return!0}(t,n))return void ce(mt.k.Verbose,"processSubComponentState:component-not-ready",{component:t.id,state:n});const s=(t,e,n)=>{e&&(ce(mt.k.Info,"processSubComponentState:complete-appstate-metric",t),this.metrics[t]=Se(e,n),this.Bt(t))},r=(t,e)=>{e&&(ce(mt.k.Info,"processSubComponentState:complete-monitor-metric",t),this.metrics[t]=Se(e),this.Jt(t))},a=(t,e)=>{const n=function(t,e){let n=0;for(const i in t){const o=t[i].states[e]?.result?.time,s=t[i].allSubComponentsUnused;if(!o&&!s)return;o&&(n=Math.max(n,o))}return n}(this.$t,t);ce(mt.k.Verbose,"processSubComponentState:appStateTime",{time:n,state:t}),n&&(s(t,e,n),this.jt.startMonitors(t,r))};this.jt.cancelMonitors(n);const c=this.Zt.getBooleanSetting("RumShepherdNonReportingComponentsIsEnabled",!1),l=this.Zt.getBooleanSetting("fixPromotedUnusedCombinedLogicBug",!1),u=ne(e,o),d=function(t,e){if(e&&t&&t.states[e]){const n=t.states[e];return n?.result&&n?.final}return!1}(t,o);if(u){const i=t.states[o];return d?be(t,n,l)?(Re(t,e,n,i.result,c),void a(n,i.result)):l&&t.states[n]?.result?(Re(t,e,n,t.states[n].result,c),void a(n,t.states[n].result)):void 0:void(be(t,n,l)&&i.monitoring&&(ce(mt.k.Verbose,"processSubComponentState: detected promotion while previous state is monitoring, marking state to promote later.",{component:t.id,state:n,promotedFromState:o}),i.stateToPromoteWhenFinal=n))}if(t.allSubComponentsUnused){const e={start:0,time:0,monitor:""};return t.states[n]={result:Se(e),final:!0},ce(mt.k.Verbose,"processSubComponentState:setting component's state timings to 0 since all subComponents are unused",{component:t.id,state:n}),void a(n,e)}void 0!==o&&ce(mt.k.Verbose,"processSubComponentState:starting monitor although we are promoting",{component:t.id,subComponent:e.id,promotedFromState:o,state:n,isPromotingAndPromotedStateExists:u,isPreviousStateHasAFinalResult:d});const h=this.Nt.monitors[n];ce(mt.k.Verbose,"processSubComponentState:start-monitor",{state:n}),function(t,e,n,i){const o=t.states[e];if(o?.final)return;o?.monitoring&&o?.monitoring.cancel();const s=$t(),r=ke(5e3);t.states[e]={monitoring:r,final:pe(t,e)},Ce(n(s,r,t),s,e,i)}(t,n,h,(i=>{ce(mt.k.Verbose,"processSubComponentState:monitor-complete",{state:n}),!i||void 0===i?.monitor&&""===i.monitor||(this.Xt=i.monitor);const o=t.states[n].stateToPromoteWhenFinal;Re(t,e,n,i,c),o&&(ce(mt.k.Verbose,"processSubComponentState: promotion callback detected state to promote.",{component:t.id,state:n,stateToPromote:o}),Re(t,e,o,i,c)),a(n,i)}))},this.Ut=(t,e)=>{ce(mt.k.Verbose,"processSubComponentUnused",{subComponent:e.id}),e.unused=!0;const n=t.subComponents;let i=!0;for(const t in n)n[t].unused||(i=!1);i?(t.allSubComponentsUnused=!0,this.Ht(t,e,Zt,0),ce(mt.k.Verbose,"processSubComponentUnused:vp-final",{component:t.id,VISUALLY_PERCEIVED:Zt}),t.states[Zt].final=!0,this.Bt(Zt),this.Ht(t,e,Qt,0),ce(mt.k.Verbose,"processSubComponentUnused:vr-final",{component:t.id,VISUALLY_READY:Qt}),t.states[Qt].final=!0,this.Bt(Qt),this.Ht(t,e,Yt,0),ce(mt.k.Verbose,"processSubComponentUnused:fr-final",{component:t.id,FUNCTIONALLY_READY:Yt}),t.states[Yt].final=!0,this.Bt(Yt)):this.ProcessUnusedComponentFinal(t),this.Jt(qt),this.Jt(Xt)},this.Vt=(t,e,n,i,o)=>{n?t.ignoredSubComponents[e]=!0:t.subComponents[e]||(t.subComponents[e]={id:e,initTime:$t(),optional:i,unused:!1,nonReporting:o,states:{}})},ce(mt.k.Info,"initialize"),this.Qt=Number(Number(Bt()).toFixed()),this.Nt={...t},this.jt=new xe(this.Nt),this.Zt=new ye(this.Nt.appSettings);for(const e of t.components)this.$t[e.id]={id:e.id,rootElementId:e.rootElementId,ignoreNewSubComponents:!1,subComponents:{},states:{},ignoredSubComponents:{}};window.setTimeout((()=>this.Yt()),12e4)}}function Pe(t,e){return window.requestAnimationFrame?new Promise((n=>{let i;const o=(o=0)=>{cancelAnimationFrame(i),n({start:t,time:o,monitor:"rAF",error:e.reason})};e.onCancelled=o,i=requestAnimationFrame((()=>{o($t())}))})):Promise.resolve({start:t,time:0,monitor:"",error:"rAF Unsupported"})}function Ie(t,e){return new Promise((n=>{let i,o;const s=(s=0)=>{cancelAnimationFrame(i),clearTimeout(o),n({start:t,time:s,monitor:"rAF-setTimeout",error:e.reason})};e.onCancelled=()=>s(),i=requestAnimationFrame((()=>{o=window.setTimeout((()=>{s($t())}),0)}))}))}const Ee="StableInteractivityDetected";function We(t,e,n=1e3){const i=e||ke(12e3);if(!U("longtask"))return function(t,e){const n=$t();if(!window.requestAnimationFrame)return Promise.resolve({start:n,time:0,monitor:"",error:"rAF unsupported"});const i=$t();let o=0,s=i,r=0,a=0,c=i;return new Promise((i=>{let l;const u=(e=0)=>{cancelAnimationFrame(l);const s={start:n,time:e,monitor:"long-frames",error:t.reason,measures:{longTasksCount:o,longestTaskDuration:a,longTasksDuration:r}};i(s)};t.onCancelled=u;const d=t=>{let n=t-s;const i=t-c;if(c=t,i>=50&&(n=0,r+=i,o+=1,s=t,a=Math.max(a,i)),n>=e)return u(s),void Le();l=window.requestAnimationFrame(d)};l=window.requestAnimationFrame(d)}))}(i,n);const o=performance.now();let s=0,r=o,a=0,c=0;return new Promise((e=>{let o;const l=()=>{clearTimeout(o),u&&u.disconnect();const n=$t()-t,l={start:t,time:r,monitor:"longtask-api",error:i.reason,measures:{longTasksDuration:a,longTasksCount:s,longestTaskDuration:c,monitoredTime:n}};e(l)};i.onCancelled=l;const u=new PerformanceObserver((function(t){t.getEntries().forEach((t=>{s+=1,a+=t.duration;const e=t.startTime+t.duration;r=Math.max(e,r),c=Math.max(c,t.duration)}))}));u.observe({entryTypes:["longtask"]});const d=()=>{const t=performance.now()-r;if(t>=n)l(),Le();else{const e=n-t;o=window.setTimeout(d,e)}};o=window.setTimeout(d,n)}))}function Le(){try{self.dispatchEvent(new CustomEvent(Ee))}catch(t){ce(mt.k.Error,`${Ee} failed with exception: ${t}`)}}function Oe(t,e){return U("first-input")?new Promise((n=>{let i;const o=(e,o,s)=>{i&&i.disconnect(),n({start:t,time:e,monitor:"first-input-api",error:s,measures:{fid:o}})};try{e.onCancelled=()=>o(0,0,e.reason);const t=t=>{const e=t.processingStart,n=e-t.startTime;o(e,n)};i=new PerformanceObserver((e=>{e.getEntries().forEach((e=>t(e)))})),i.observe({type:"first-input",buffered:!0})}catch(t){o(0,0,"exception")}})):Promise.resolve({start:t,time:0,monitor:"",error:"FID unsupported"})}function De(t,e){const n=["click","mousedown","keydown","touchstart","pointerdown","wheel","select","contextmenu","scroll"],i={passive:!0,capture:!0},o=Vt();return new Promise((s=>{const r=(n,i,o)=>{c(removeEventListener);const r={start:t,time:n,monitor:"first-interaction",error:e.reason,data:{eventName:i},measures:{delay:o}};s(r)};e.onCancelled=()=>r(0,"",0);const a=t=>{if(t.cancelable){const e=Vt(),n=t.timeStamp>1e12;let i=(n?Vt():performance.now())-t.timeStamp;(i<0||i>e-o)&&(i=0),r(n?t.timeStamp-Bt():t.timeStamp,t.type,i)}},c=t=>{n.forEach((function(e){t(e,a,i)}))};c(addEventListener)}))}function Te(t,e){return window.requestIdleCallback?new Promise((n=>{let i;const o=(e,o)=>{window.cancelIdleCallback(i),n({start:t,time:e,monitor:"first-idle",error:o})};try{i=window.requestIdleCallback((t=>o($t(),t.didTimeout?"timeout":"")),{timeout:e.timeout}),e.onCancelled=()=>o(0,e.reason)}catch(t){o(0,"exception")}})):Promise.resolve({start:t,time:0,monitor:"",error:"requestIdleCallback unsupported"})}let Fe=0;const Me=t=>{const e=`report ${t.metric}:${t.time}ms`;ce(mt.k.Info,e,t);const n=new CustomEvent("Wac-AppLoadMetricReport",{detail:t});self.dispatchEvent(n)},Ne=t=>{ce(mt.k.Info,`reporting the application load state at epoch time: ${t.time}; with the status of all metrics reported as ${t.allMetricsReported}`,t);const e=new CustomEvent("Wac-AppLoadStateReport",{detail:t});self.dispatchEvent(e)},Be=(t,e,n)=>{if(n){const i=`vr-${n.id}-${Fe}`;return Fe+=1,function(t,e,n,i){let o=i?function(t,e,n,i){if(!U("element"))return;const o="testimg-"+n,s=function(t){const e=document.createElement("img");if(t){if(!("elementTiming"in e))return;e.elementTiming=t}return e.style.position="absolute",e.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",e.ariaHidden="true",e}(o);if(!s)return;const r=i??document.documentElement;return new Promise((n=>{const i=(e=0,i)=>{a&&a.disconnect(),n({start:t,time:e,monitor:"image-paint-api",error:i})},a=new PerformanceObserver((t=>{const e=t.getEntries();for(const t of e){const e=t;if(e.identifier===o){try{s.hidden=!0,r.removeChild(s)}catch(t){ce(mt.k.Error,"measureImagePaintTime",t)}return void i(e.renderTime)}}}));e.onCancelled=()=>i(0,e.reason),a.observe({type:"element",buffered:!0}),r.appendChild(s)}))}(t,e,n,i):void 0;return o||(o=Pe(t,e)),o}(t,e,i,document.documentElement??void 0)}return Pe(t,e)};const $e="header";var Ve=o(166);let Ue,He,je,ze,Ge;function qe(){Ue&&!He&&ze&&(Ue.launchFastView('<div class="Ltr SingleOutlineLayout WACViewPanel CssCenteredSection" style="--pageBackgroundSolidFill:#ffffff; --pageEndMarkerColor:WindowText;"><div class="PageContentOrigin"><div class="PageContentContainer" id="PageContentContainer"><div class="PaginatedContentContainer" style="width: 816px; margin-left: auto; margin-right: auto;"><div class="PaginatedContentContainerDisplayWrapper" style="width: 816px;"><div class="PagesContainer" id="PagesContainer"><div class="Page" aria-label="Page 1" style="width: 816px; height: 1056px; background-color: var(--pageBackgroundSolidFill); z-index: 1;"></div></div></div></div></div></div></div>',"skeletalUX")&&y.addComponentOutsideSkeletalContainer(Gt(y.getSkeletalComponentColor(He,je))),y.addShimmerToElement("SkeletalCanvas"))}function Je(t,e){if(!e)return;"true"===t.WacPerfObserverEntriesIsEnabled&&(V()&&-1!==PerformanceObserver.supportedEntryTypes.indexOf("paint")&&new PerformanceObserver((t=>{t.getEntries().forEach((t=>{"first-paint"===t.name?jt("firstPaint",t.startTime):"first-contentful-paint"===t.name&&jt("firstContentfulPaint",t.startTime)}))})).observe({type:"paint",buffered:!0}),V()&&-1!==PerformanceObserver.supportedEntryTypes.indexOf("largest-contentful-paint")&&new PerformanceObserver((t=>{const e=t.getEntries();jt("largestContentfulPaint",e[e.length-1].startTime)})).observe({type:"largest-contentful-paint",buffered:!0}),function(){if(!V()||-1===PerformanceObserver.supportedEntryTypes.indexOf("element"))return;const t=new PerformanceObserver((e=>{e.getEntries().forEach((t=>{jt(`elementPaint_${t.id}`,t.startTime)})),t.observe({type:"element",buffered:!0})}))}(),window.addEventListener("WacAppInteractive",(()=>{!function(t=[5e3],e=12e4){if(!V()||-1===PerformanceObserver.supportedEntryTypes.indexOf("longtask")||-1===PerformanceObserver.supportedEntryTypes.indexOf("first-input")||0===t.length)return;const n=performance.now();let i,o,s=0,r=n,a=0,c=0;const l=new PerformanceObserver((function(t){t.getEntries().forEach((t=>{if("longtask"===t.entryType){s+=1,a+=t.duration;const e=t.startTime+t.duration;r=e>r?e:r}else"first-input"===t.entryType&&(i=t.processingStart,o=i-t.startTime)}))}));l.observe({entryTypes:["longtask","first-input"]});const u=function(){const d=performance.now(),h=d-r;if(o)jt("firstInputProcessingStart",i),jt("FID",o),zt(l);else{for(;c<t.length;c+=1){const e=t[c];if(!(h>=e-10))break;jt(`TTSI_${e}`,r),jt(`longTaskCount_${e}`,s),jt(`totalLongTasksDuration_${e}`,a)}const i=d-n;if(c<t.length&&i<e){const e=t[c]-h;setTimeout(u,e)}else zt(l)}};t.sort(((t,e)=>t-e)),setTimeout(u,t[0])}([500,1e3,2e3,3e3,5e3])})));const n="true"===t.HideHeaderEmbedded;if("true"===t.RumShepherdIsEnabled){const e=[{id:"ribbon",rootElementId:"WACRibbonPanel"},{id:"canvas"}];"true"===t.UseCopilotTTVRComponent&&e.push({id:"copilot"}),n||e.push({id:$e,rootElementId:"AppHeaderPanel"}),function(t,e){const n=new Ae({appLoadMetricReportCallback:Me,appLoadStateLoggingCallback:Ne,appSettings:e,monitors:{"visually-ready":Be,"visually-perceived":Be,"functionally-ready":Ie,"stable-interactivity":We,"first-input":Oe,"first-interaction":De,"first-idle":Te},components:t});window.addEventListener(ie,(t=>{const e=t.detail;n.addSubComponents(e)})),window.addEventListener(oe,(t=>{const e=t.detail;n.setSubComponentState(e)}))}(e,function(t){return{RumShepherdRemoteTelemetryLoggingIsEnabled:t.RumShepherdRemoteTelemetryLoggingIsEnabled,RumShepherdStagePromotionIsEnabled:t.RumShepherdStagePromotionIsEnabled,RemoteTelemetryUrl:t.RemoteTelemetryUrl,SessionId:t.SessionId}}(t))}let i="true"===t.IsRegionComposerEnabled;if(i){const t=Ve;t.initializeWindowUtil(i),i=t.shouldUseRegionComposer()}_.ensureCookieCompliance("true"===t.MSCCEnabled,t.MSCCCookies);const o=At(t,2,!0);Ue=new kt("true"!==t.BootReadOnlyUx,!0,!0,!1,t,i);const s=new Ot(Ue,o),r=s.makeGetCellsRequest((t=>{s.onGetCellsRequestCompleted(t),s.onInitialResponseReady()}),!0);o.getCachedSSR&&!s.shouldDisableSSR()&&s.makeRenderPageRequest({}),"true"===t.ShouldLogWordBootServerKpis&&S("{'k':[{'e': 4,'n':'BBIGC'}]}","Kpi");const a=("true"===t.WordSkeletalRibbonIsEnabled||"earlydismiss"===t.WordIsSkeletalRibbonOn||"latedismiss"===t.WordIsSkeletalRibbonOn)&&"true"!==t.StaticRibbonIsEnabled,c="true"===t.WordIsSkeletalDeepLinkOn&&"true"===t.IsDeepLinkScenario,l="true"===t.NewSkeletalUXExperienceEnabled,u="true"===t.WordIsSkeletalTaskPaneOn&&yt(t);if((a||c||l||u)&&y.initialize(c,l),He=kt.isDarkModePreferenceOn(t),ze="false"===kt.userHasMLRPreference(t),l)y.addComponent({isReady:!1,element:document.getElementById("SkeletalRibbon")}),y.addComponentOutsideSkeletalContainer({isReady:!1,element:document.getElementById("SkeletalPage")});else if(a&&!kt.isReactMultilineRibbonVisible(t)&&"false"!==_.getCookie("WordIsSimplifiedRibbonOn")){const e="true"===t.Fluent2StyleIsEnabled;y.addComponent(function(t,e,n,i){const o=["40px","60px","60px","60px","60px","55px","90px","80px","100px","10%","17%","21%","21%","6%","6%"],s=window.ShouldHideBottomBarAtBoot,r=document.createElement("div");r.id="SkeletalRibbon",r.className=r.id,r.style.marginTop=n?"0":"48px";const a=document.createElement("div");a.id="ribbonContent",a.className=a.id,a.style.backgroundColor=e,a.style.height=s?"38px":"76px",a.style.transition="opacity 0.1s",a.style.borderBottom="none",a.style.width="100%",a.style.minWidth="640px",a.setAttribute("unselectable","on");const c=document.createElement("div");c.id="topbar",c.className="topbar",c.style.height="38px",c.style.width="100%",c.style.display="flex",c.style.alignItems="center",c.style.justifyContent="space-between";const l=document.createElement("div");l.style.height="16px",l.style.display="flex",l.style.justifyContent="flex-start";const u=[];for(let e=0;e<=14;e+=1)u[e]=document.createElement("div"),u[e].style.backgroundColor=t,u[e].style.borderRadius="2px",u[e].style.height="100%",u[e].style.marginLeft="8px",u[e].style.marginRight="8px",u[e].style.outline="transparent",u[e].style.border="1px solid transparent",u[e].style.width=o[e];const d=document.createElement("div");d.style.height="24px",d.style.display="flex";const h=[];for(let e=0;e<4;e+=1)h[e]=document.createElement("div"),h[e].style.width="24px",h[e].style.borderRadius="50%",h[e].style.backgroundColor=t,h[e].style.marginLeft="4px",h[e].style.marginRight="4px",h[e].style.outline="transparent",h[e].style.border="1px solid transparent",d.appendChild(h[e]);d.appendChild(u[7]),d.appendChild(u[8]);const f=document.createElement("div");f.id="bottombar",f.className="bottombar",f.style.height="38px",f.style.width="100%",f.style.display="flex",f.style.alignItems="center",i&&Object.keys(i).forEach((t=>{f.style.setProperty(t,i[t])}));const m=document.createElement("div");m.style.height="22px",m.style.display="flex",m.style.width="100%";for(let t=0;t<=6;t+=1)l.appendChild(u[t]);for(let t=9;t<=14;t+=1)m.appendChild(u[t]);const p=[window.matchMedia("(max-width: 700px)"),window.matchMedia("(max-width: 810px)"),window.matchMedia("(max-width: 1116px)")];g();for(let t=0;t<p.length;t+=1)p[t].addListener(g);function g(){p[0].matches?(u[7].style.width="32px",u[8].style.width="32px",u[6].style.display="none",u[5].style.display="none"):p[1].matches?(u[7].style.width="32px",u[8].style.width="32px",u[6].style.display="none"):p[2].matches&&(u[7].style.width="32px",u[8].style.width="32px")}const b=document.createElement("div");return b.id="highContrastCover",b.className=b.id,b.style.height="4px",b.style.backgroundColor="rgba(0, 0, 0, 0)",c.appendChild(l),c.appendChild(d),f.appendChild(m),a.appendChild(c),s||a.appendChild(f),r.appendChild(a),r.appendChild(b),{isReady:!1,element:r,onRemoval:function(){for(let t=0;t<p.length;t+=1)p[t].removeListener(g)}}}(y.getSkeletalComponentColor(He,e),y.getSkeletalBackgroundColor(He,e),n,e?{"background-color":He?"#292929":"#FFFFFF","border-radius":"8px",margin:"0 8px",width:"calc(100% - 16px)"}:void 0))}if(u){let e=0;const i=parseFloat(t.DefaultCopilotPaneWidthPercent);isNaN(i)||(e=i);const o="true"===t.HideCopilotTaskPaneHeader;y.addComponent(function(t,e,n,i,o,s,r,a,c,l){const u=36+(o?0:48)+(s?0:r?40:100)+1,d=_t(a,c),h=document.createElement("div");h.setAttribute("id","SkeletalTaskPane"),h.style.width=d+"px",h.style.height=`calc(100% - ${u}px)`,h.style.top=`${u}px`,h.style.backgroundColor=e,h.style.marginBottom="12px",h.style.position="absolute",l?(h.style.left="0",h.style.borderRight=`solid 1px ${t}`):(h.style.right="0",h.style.borderLeft=`solid 1px ${t}`);const f=document.createElement("div");f.setAttribute("id","copilotChatPaneInnerElement"),f.style.height="100%",f.style.width="100%",f.style.display="flex",f.style.border=`solid 1px ${t}`,f.style.borderRadius="4px",l?(f.style.alignContent="right",f.style.justifyContent="right"):(f.style.alignContent="left",f.style.justifyContent="left"),f.style.background="solid",f.style.paddingTop="20px",f.style.paddingBottom="20px",f.style.display="flex",f.style.flexWrap="wrap";const m=`\n  background: linear-gradient(to ${l?"left":"right"},\n    ${n} 0%,\n    ${i} 50%,\n    ${n} 100%\n  );\nheight: 16px;     background-size: 300% 100%;     background-position-x: 100%;     background-position-y: 50%;    margin-${l?"right":"left"}: 12px;     animation: copilotPlaceholderAnimation 3s infinite linear;     display: block;`,p=document.styleSheets[0];p.insertRule("\n      @keyframes copilotPlaceholderAnimation {\n      0% {\n        background-position-x: 300%;\n      }\n      100% {\n        background-position-x: 0%;\n      }\n    }\n    ",p.cssRules.length);for(let t=1;t<=16;t++){const e=document.createElement("div");e.setAttribute("id","placeholderChatPaneElement"+t);let n="width: 90%;";t%4==0&&(n="width: 50%; margin-bottom: 12px;"),e.setAttribute("style",m+n),f.appendChild(e)}return h.appendChild(f),{isReady:!1,element:h}}(y.getSkeletalComponentColor(He,je),y.getSkeletalBackgroundColor(He,je),y.getPlaceholderChatPaneGrandientColor1(He),y.getPlaceholderChatPaneGrandientColor2(He),n,window.ShouldHideBottomBarAtBoot,!kt.isReactMultilineRibbonVisible(t),e,o,0==="true".localeCompare(t.Rtl,void 0,{sensitivity:"base"})))}return(a||c||l||u)&&y.launchExperience(void 0,void 0,l),r}class Ke{static createSuccess(){return new Ke(!0)}static createFailure(t,e){return new Ke(!1,t,e)}constructor(t,e,n){this.success=t,this.errorCode=e,this.extraErrorInfo=n}}class Xe{static getWindow(){return window}launchFastView(t,e,n=!1,i=1,s=""){Xe.getWindow().g_liveBooksAppConstructed&&this.log("App constructed before launching FastView"),d.fastView&&d.fastView.isOpen()&&this.log("FastView was already opened");let r="true"===this.instantAppSettings.IsRegionComposerEnabled;r&&(r=o(166).shouldUseRegionComposer());let a=t=>{};a=t=>{vt.showToast(t,s)};const c=new kt(!0,!0,!0,!1,this.instantAppSettings,r).launchFastView(t,"WordEditorInstantApp",e,!1,n,i,a);this.log(y.skeletalBootLoggingData());const l="true"===this.instantAppSettings.WordIsSkeletalDeepLinkOn&&"true"===this.instantAppSettings.IsDeepLinkScenario,u=kt.isDarkModePreferenceOn(this.instantAppSettings),h="true"===this.instantAppSettings.Fluent2StyleIsEnabled;if(l&&c)return y.addComponentOutsideSkeletalContainer(Gt(y.getSkeletalComponentColor(u,h))),void y.addShimmerToElement("SkeletalCanvas");"true"===this.instantAppSettings.SkeletalParagraphIsEnabled&&c&&this.addSkeletalParagraph(u,h)}trackOfficeServerDiagnostics(t){this.officeFrameDocumentFlushTime=Date.now(),this.serverDiagnostics=t}sendAppFailedMessage(t){this.sendPostMessageToParentWindow(Xe.toJsApiAppFailed,{Error:{errorType:t}},"*")}signalReady(){window.addEventListener("message",(t=>{this.receivePostMessage(t)}),!1),this.sendReadyMessage();let t=Number(this.instantAppSettings.WopiPendingSessionMessageTimeoutInMs);t||(t=1e4),window.setTimeout((()=>this.timeoutWopiPendingSessionMessage()),t)}startWacBoot(t){this.sendBeacon("WordEditorInstantApp.StartWacBoot","BootLogs"),this.shouldLogWordBootServerKpis&&this.isTwoStepCreateNew&&this.logKPI(!0,Xe.bBNSW,"WordEditorInstantApp.StartWacBoot");const e=t||this.instantAppSettings;this.getCellsConnection=Je(e,!0)}displayCacheViewBeforeCFI(){const t=this.instantAppSettings.browserCacheIdV2,e=this.instantAppSettings.DocumentCacheItemSchemaVersion;if(void 0===t||void 0===e)return;const n=new St,i=new at(n,t,e,!0,kt.isDarkModePreferenceOn(this.instantAppSettings),(()=>!0),"Loading...");rt.getAndLoadDocumentCache(i,!0)}abortGetCellsConnection(){this.getCellsConnection&&this.getCellsConnection.abort()}getCellsFromFrameRequest(t){Ot.getCellsFromFrameRequest(t),this.abortGetCellsConnection()}addSkeletalParagraph(t,e){try{const n=document.getElementById("WACFastView"),i=n.querySelectorAll(".Paragraph").length;if(20!==i&&60!==i)return!1;const o=n.querySelector(".Outline");if(o){const i=function(t,e){const n=document.createElement("div");n.id="SkeletalParagraph",n.style.width="100%",n.style.overflow="hidden",n.style.position="relative";const i=document.createElement("div");i.style.width="100%",i.style.boxSizing="border-box";const o=t.querySelectorAll(".OutlineElement");-1!==o[o.length-1].className.toLowerCase().indexOf("rtl")&&(i.style.direction="rtl");const s=t.querySelector(".OutlineContent");s&&(i.style.paddingLeft=s.style.paddingLeft,i.style.paddingRight=s.style.paddingRight);const r=["92%","100%","93%","80%"];for(let t=0;t<r.length;t+=1){const n=document.createElement("div");n.style.backgroundColor=e,n.style.width=r[t],n.style.height="14px",n.style.marginBottom="6px",i.appendChild(n)}return n.appendChild(i),n}(n,y.getSkeletalComponentColor(t,e));o.appendChild(i),y.addShimmerToElement(i.id)}}catch(t){return this.log("failed to add skeletal paragraph: "+t.message+"\r\n"+t.stack),!1}return!0}sendPostMessageToParentWindow(t,e,n){const i={MessageId:t,SendTime:Date.now(),Values:e};let o=this.postMessageOrigin;n&&(o=n),window.parent.postMessage(JSON.stringify(i),o),this.log(`Sent ${t}`)}receivePostMessage(t){if(t.origin!==this.postMessageOrigin)return;let e;try{e=JSON.parse(t.data)}catch(t){return}switch(e.MessageId){case Xe.fromJsApiInitReadyAck:this.log("WacInitialize_Ready_Ack received"),this.wacInitializeReadyAckReceived=!0;break;case Xe.fromJsApiPendingSessionFail:if(this.log("WopiPendingSession_Fail received"),this.wopiPendingSessionCompleteReceived)return void this.log("WopiPendingSession_Fail received after a Complete/Fail was already received previously.");this.wopiPendingSessionCompleteReceived=!0,this.wopiStartSessionCompleteReceived=!0,this.initializeAppOnFailure(Xe.bBNWI,"WopiPendingSession_Fail");break;case Xe.fromJsApiPendingSessionComplete:this.log("WopiPendingSession_Complete received"),this.shouldLogWordBootServerKpis&&this.isTwoStepCreateNew&&this.logKPI(!0,Xe.bBNWI,"WopiPendingSession_Complete"),this.sendPostMessageToParentWindow(Xe.toJsApiSessionCompleteAck,{}),this.wopiPendingSessionCompleteReceived&&this.log("WopiPendingSession_Complete received after a Complete/Fail was already received previously."),this.wopiPendingSessionCompleteReceived=!0;const t=e.Values.WopiDetails;this.instantBootPltDiagnostics=e.Values.Diagnostics||{},this.makeStartSessionRequest(t),this.beginStartSessionTimeout(!0);break;case Xe.fromJsApiStartSessionComplete:if(this.log("WopiStartSession_Complete received"),this.shouldLogWordBootServerKpis&&this.isTwoStepCreateNew&&this.logKPI(!0,Xe.bBNSC,"WopiStartSession_Complete"),this.sendPostMessageToParentWindow(Xe.toJsApiSessionCompleteAck,{}),this.wopiStartSessionCompleteReceived)return void this.log("WopiStartSession_Complete received after a Complete/Fail was already received previously.");if(!this.acceptStartSessionComplete)return void this.log("WopiStartSession_Complete rejected");if(!e.Values.StartSessionResponse)return void this.log("WopiStartSession_Complete invalid content");this.wopiStartSessionCompleteReceived=!0,this.wopiPendingSessionCompleteReceived||(this.wopiPendingSessionCompleteReceived=!0);const n=e.Values.StartSessionResponse;this.instantBootPltDiagnostics=e.Values.Diagnostics||{},this.processStartSessionResponse(!1,n.RequestStatus,n.ResponseText);break;case Xe.fromJsApiPendingAppCompleteReceived:this.log("WopiPendingApplicationComplete_Received received on wac frame"),this.shouldLogWordBootServerKpis&&this.isTwoStepCreateNew&&this.logKPI(!0,Xe.bBNWI,"WopiPendingApplicationComplete_Received"),this.wopiPendingSessionCompleteReceived||(this.wopiPendingSessionCompleteReceived=!0),this.beginStartSessionTimeout(!1)}}beginStartSessionTimeout(t){let e=Number(this.instantAppSettings.WopiStartSessionTimeoutInMs);e||(e=1e4),t?(this.wopiStartSessionSentFromWacFrame=!0,window.setTimeout((()=>this.timeoutWopiStartSessionFromWacFrameMessage()),e)):window.setTimeout((()=>this.timeoutWopiStartSessionFromJsApiMessage()),e)}sendReadyMessage(){this.sendPostMessageToParentWindow(Xe.toJsApiInitReady,{CanAcceptStartSessionComplete:this.acceptStartSessionComplete,Diagnostics:{officeSessionId:this.instantAppSettings.SessionId}}),window.setTimeout((()=>this.timeoutWacInitializeReadyAckMessage()),Xe.wacInitializeReadyAckTimeoutInMs)}timeoutWacInitializeReadyAckMessage(){this.wacInitializeReadyAckReceived||this.wopiPendingSessionCompleteReceived||(this.wacInitializeReadyRetryCount+=1,this.wacInitializeReadyRetryCount<Xe.wacInitializeReadyMaxRetries?(this.sendReadyMessage(),this.log(`WacInitializeReadyAckTimeout. [RetriesRemain:${Xe.wacInitializeReadyMaxRetries-this.wacInitializeReadyRetryCount}]`)):this.log("WacInitializeReadyAckTimeout. No retries remain"))}timeoutWopiPendingSessionMessage(){this.wopiPendingSessionCompleteReceived||this.initializeAppOnFailure(Xe.bBNWI,"WopiPendingSession_Timeout")}timeoutWopiStartSessionFromJsApiMessage(){this.wopiStartSessionCompleteReceived||this.wopiStartSessionSentFromWacFrame||this.initializeAppOnFailure(Xe.bBNSC,"StartSession_Fail","Timeout_FromJsApi")}timeoutWopiStartSessionFromWacFrameMessage(){this.wopiStartSessionCompleteReceived||this.initializeAppOnFailure(Xe.bBNSC,"StartSession_Fail","Timeout_FromWacFrame")}makeStartSessionRequest(t){const e=At(this.instantAppSettings,0,!0,t),n=new Ot(null,e);let i=`WOPIsrc=${encodeURIComponent(t.WopiSrc)}`;window.location.search&&(i+=`&${window.location.search.substr(1)}`),"true"===this.instantAppSettings.FileGetUrlPresent&&(i+="&fileGetUrlPresent=1"),this.instantBootPltDiagnostics.startSessionStartTime=Date.now(),n.makeStartSessionRequest(`WordEditorStartSession.ashx?${i}`,(t=>this.processStartSessionResponse(!0,t.status,t.responseText)))}getAppSettingsFromResponse(t){try{return{success:!0,appSettings:JSON.parse(t)}}catch(t){return{success:!1,errorInfo:t.message+"\r\n"+t.stack}}}processStartSessionResponse(t,e,n){const i=Date.now();if(this.wopiStartSessionCompleteReceived=!0,200!==e)return void this.initializeAppOnFailure(Xe.bBNSC,"StartSession_Fail",`Status ${e}`);const o=this.getAppSettingsFromResponse(n);o.success?(function(t){if(t&&t.UrlToRedirect){const e=new URL(t.UrlToRedirect);window.top&&window.top.location.replace(e.toString())}}(o.appSettings),this.instantBootPltDiagnostics.isStartSessionFromWac=t,t&&(this.instantBootPltDiagnostics.startSessionCompleteTime=i),this.instantBootPltDiagnostics.appSettingsFetchedTime=Date.now(),Ge=o.appSettings,Xe.instantAppSettingsToPreserve.forEach((t=>{Ge&&t in this.instantAppSettings&&(Ge[t]=this.instantAppSettings[t])})),Xe.shipFrom1JSSettings.forEach((t=>{Ge&&(t in this.instantAppSettings?Ge[t]=this.instantAppSettings[t]:delete Ge[t])})),Xe.getWindow().g_appSettings=Ge,Xe.getWindow().g_appSettingsDownloaded=!0,this.initializeApp(Ke.createSuccess())):this.initializeAppOnFailure(Xe.bBNSC,"StartSession_AppSettingsParseError",o.errorInfo)}initializeAppOnFailure(t,e,n){this.shouldLogWordBootServerKpis&&this.isTwoStepCreateNew&&this.logKPI(!1,t,e,n),Ge=this.instantAppSettings,Xe.getWindow().g_appSettings=Ge,Xe.getWindow().g_appSettingsDownloaded=!0,this.initializeApp(Ke.createFailure(e,n))}initializeApp(t){t.success&&Ge?this.startWacBoot(Ge):(this.sendBeacon("WordEditorInstantAppBootError",{errorCode:t.errorCode,extraErrorInfo:t.extraErrorInfo}),Ge&&t.errorCode&&(Ge.InstantBoot_FailureCode=t.errorCode),t.errorCode&&t.extraErrorInfo&&Ge&&(Ge[t.errorCode]=t.extraErrorInfo)),this.sendBeacon("WordEditorInstantAppLogs",this.logs),Xe.getWindow().g_livebooksJsDownloaded&&(Xe.getWindow().Sys.Application.get_isInitialized()?Xe.getWindow().g_liveBooksAppConstructed||pageInit():(Xe.getWindow().Sys.Application.add_init(pageInit),Xe.getWindow().Sys.Application.initialize()))}log(t){this.logs.push({time:Date.now(),message:t})}sendBeacon(t,e){Xe.getWindow()._bB&&Xe.getWindow()._bB.sendBeacon(t,e)}logKPI(t,e,n,i=""){const o=t?3:0;let s;s=t?{k:[{e:o,n:e,p:{Status:n,ExtraInfo:i}}]}:{k:[{e:o,n:e,k:{n:i&&i.length>0?`${n}_${i}`:n},p:{ErrorLevel:"5"}}]},this.sendBeacon(JSON.stringify(s),"Kpi")}constructor(t){this.wacInitializeReadyRetryCount=0,this.wacInitializeReadyAckReceived=!1,this.wopiStartSessionCompleteReceived=!1,this.wopiPendingSessionCompleteReceived=!1,this.wopiStartSessionSentFromWacFrame=!1,this.instantBootPltDiagnostics={},this.instantAppSettings=t,this.isTwoStepCreateNew="true"===t.IsTwoStepCreateNew,this.shouldLogWordBootServerKpis="true"===t.ShouldLogWordBootServerKpis,this.logs=[],this.postMessageOrigin=this.instantAppSettings.PostMessageOrigin,this.acceptStartSessionComplete="true"===this.instantAppSettings.AcceptStartSessionComplete}}Xe.fromJsApiInitReadyAck="WacInitialize_Ready_Ack",Xe.fromJsApiPendingSessionComplete="WopiPendingSession_Complete",Xe.fromJsApiPendingSessionFail="WopiPendingSession_Fail",Xe.fromJsApiPendingAppCompleteReceived="WopiPendingApplicationComplete_Received",Xe.fromJsApiStartSessionComplete="WopiStartSession_Complete",Xe.toJsApiInitReady="WacInitialize_Ready",Xe.toJsApiAppFailed="Wac_AppFailed",Xe.toJsApiSessionCompleteAck="WopiSession_Complete_Ack",Xe.bBNSC="BBNSC",Xe.bBNWI="BBNWI",Xe.bBNSW="BBNSW",Xe.wacInitializeReadyMaxRetries=3,Xe.wacInitializeReadyAckTimeoutInMs=1e3,Xe.instantAppSettingsToPreserve=["MSCCCookies","MSCCEnabled","MSCCMarkup","RibbonImageBase","SharedStaticContentHost","Slice1Name","StaticContentHost","WacRootDomain","WacBootNewJSIsEnabled","jQueryName","signalRName","CollabSliceName","DarkModeIsOn","BuildVersion"],Xe.shipFrom1JSSettings=["HashedResourceClientManifestShippingFrom1JS","HashedStaticContentHostShippingFrom1JS","VersionedStaticContentHostShippingFrom1JS"];const Qe=function(t){r||(r=new e({container:t,layoutCollection:{Landscape:{Default:[{id:"KeyboardRegion"}]},Portrait:{Default:[{id:"KeyboardRegion"}],Small:[{id:"KeyboardRegion"}]},DP:{Default:[{id:"FarPane"},{id:"KeyboardRegion"}]},DL:{Default:[{id:"KeyboardRegion"}]}}}))}}(),wacBoot=s}();
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/wacBoot.min.js.map/cc1e93ad994b571d638bc9c764d88f03/wacBoot.min.js.map